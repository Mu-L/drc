(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-018381ae"],{"06c5":function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));a("a630"),a("fb6a"),a("b0c0"),a("d3b7"),a("ac1f"),a("00b4"),a("25f0"),a("3ca3");var o=a("6b75");function n(e,t){if(e){if("string"==typeof e)return Object(o["a"])(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?Object(o["a"])(e,t):void 0}}},1043:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e._self._c;return t("base-component",{attrs:{isFather:e.isFather,subMenuName:["1"],fatherMenu:e.fatherMenu}},[t("Breadcrumb",{style:{margin:"15px 0 15px 185px",position:"fixed"}},[t("BreadcrumbItem",{attrs:{to:"/home"}},[e._v("首页")]),t("BreadcrumbItem",{attrs:{to:"/fullDataConsistencyCluster"}},[e._v("校验集群")]),t("BreadcrumbItem",[e._v("校验表配置")])],1),t("Content",{staticClass:"content",style:{padding:"10px",background:"#fff",margin:"50px 0 1px 185px",zIndex:"1"}},[t("div",{staticStyle:{padding:"1px 1px"}},[t("div",{staticClass:"ivu-list-item-meta-title"},[t("p",[e._v("DRC集群："+e._s(e.$route.query.clusterA)+"(集群A)---"+e._s(e.$route.query.clusterB)+"(集群B)")])]),t("Table",{staticStyle:{"margin-top":"20px"},attrs:{stripe:"",columns:e.columns,data:e.dataWithPage,size:"small"}}),t("div",{staticStyle:{"text-align":"center",margin:"16px 0"}},[t("Page",{attrs:{total:e.records.length,current:e.current,"show-sizer":"","show-elevator":"",placement:"top"},on:{"update:current":function(t){e.current=t},"on-page-size-change":e.handleChangeSize}})],1)],1),t("Modal",{attrs:{width:"900px",title:"一致性校验确认"},on:{"on-ok":e.okCheckConsistency,"on-cancel":e.cancelCheckConsistency},model:{value:this.confirmCheckModal,callback:function(t){e.$set(this,"confirmCheckModal",t)},expression:"this.confirmCheckModal"}},[t("Form",{attrs:{"label-width":200}},[t("FormItem",{attrs:{label:"库名"}},[t("Input",{staticStyle:{width:"500px"},attrs:{readonly:""},model:{value:this.chooseTableConfig.schema,callback:function(t){e.$set(this.chooseTableConfig,"schema",t)},expression:"this.chooseTableConfig.schema"}})],1),t("FormItem",{attrs:{label:"表名"}},[t("Input",{staticStyle:{width:"500px"},attrs:{readonly:""},model:{value:this.chooseTableConfig.table,callback:function(t){e.$set(this.chooseTableConfig,"table",t)},expression:"this.chooseTableConfig.table"}})],1),t("FormItem",{attrs:{label:"key"}},[t("Input",{staticStyle:{width:"500px"},attrs:{readonly:""},model:{value:this.chooseTableConfig.key,callback:function(t){e.$set(this.chooseTableConfig,"key",t)},expression:"this.chooseTableConfig.key"}})],1),t("FormItem",{attrs:{label:"onUpdate"}},[t("Input",{staticStyle:{width:"500px"},attrs:{readonly:""},model:{value:this.chooseTableConfig.onUpdate,callback:function(t){e.$set(this.chooseTableConfig,"onUpdate",t)},expression:"this.chooseTableConfig.onUpdate"}})],1),t("FormItem",{attrs:{label:"startTimestamp"}},[t("Input",{staticStyle:{width:"500px"},attrs:{readonly:""},model:{value:this.chooseTableConfig.startTimestamp,callback:function(t){e.$set(this.chooseTableConfig,"startTimestamp",t)},expression:"this.chooseTableConfig.startTimestamp"}})],1),t("FormItem",{attrs:{label:"endTimeStamp"}},[t("Input",{staticStyle:{width:"500px"},attrs:{readonly:""},model:{value:this.chooseTableConfig.endTimeStamp,callback:function(t){e.$set(this.chooseTableConfig,"endTimeStamp",t)},expression:"this.chooseTableConfig.endTimeStamp"}})],1)],1)],1),t("Modal",{attrs:{width:"900px",title:"执行结果"},on:{"on-ok":e.okExecuteModal,"on-cancel":e.okExecuteModal},model:{value:this.executeModal,callback:function(t){e.$set(this,"executeModal",t)},expression:"this.executeModal"}},[t("Form",[t("FormItem",{attrs:{label:"执行结果"}},[t("Alert",{attrs:{type:this.executeStatus,"show-icon":""}},[e._v(e._s(this.executeMsg))])],1)],1)],1)],1)],1)},n=[],i=a("2909"),s=(a("14d9"),a("fb6a"),a("e66c")),r={name:"fullDataConsistencyCheck",data:function(){var e=this;return{isFather:!0,fatherMenu:"/fullDataConsistencyCluster",executeStatus:"",executeMsg:"",executeModal:!1,confirmCheckModal:!1,chooseTableConfig:{tableId:"",schema:"",table:"",key:"",onUpdate:"",startTimestamp:"",endTimeStamp:""},total:0,current:1,size:10,records:[],startTime:[],endTime:[],columns:[{title:"库名",key:"monitorSchemaName",resizable:!0},{title:"表名",key:"monitorTableName",resizable:!0},{title:"开始时间",align:"center",resizable:!0,render:function(t,a){return t("DatePicker",{props:{type:"datetime",format:"yyyy-MM-dd HH:mm",transfer:!0,placeholder:"start time"},on:{"on-change":function(t){e.startTime[a.index+(e.current-1)*e.size]=t}}})}},{title:"结束时间",align:"center",resizable:!0,render:function(t,a){return t("DatePicker",{props:{type:"datetime",format:"yyyy-MM-dd HH:mm",transfer:!0,placeholder:"end time"},on:{"on-change":function(t){e.endTime[a.index+(e.current-1)*e.size]=t}}})}},{title:"操作",align:"center",resizable:!0,render:function(t,a){return t("div",[t("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.confirmModalCheck(a)}}},"执行")])}},{title:"校验状态",align:"center",render:function(e,t){var a=t.row,o=0===a.fullDataCheckStatus?"error":1===a.fullDataCheckStatus?"warning":2===a.fullDataCheckStatus?"success":"warning",n=0===a.fullDataCheckStatus?"未校验":1===a.fullDataCheckStatus?"校验中":2===a.fullDataCheckStatus?"已校验":"校验失败";return e("Tag",{props:{color:o}},n)}},{title:"最近校验时间",align:"center",render:function(e,t){return e("div",null==t.row.fullDataCheckLasttime?"":Object(s["a"])(new Date(t.row.fullDataCheckLasttime),"yyyy-MM-dd hh:mm:ss"))}},{title:"最近校验结果",align:"center",render:function(t,a){return t("div",[t("Button",{props:{type:"info",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.showCheckResult(a.row)}}},"查看")])}}]}},methods:{getConfiguredTables:function(){var e=this;this.axios.get("/api/drc/v1/monitor/consistency/data/"+this.$route.query.clusterA+"/"+this.$route.query.clusterB).then((function(t){e.records=t.data.data,console.log(t.data.data)}))},handleChangeSize:function(e){var t=this;this.size=e,this.$nextTick((function(){t.getData()}))},confirmModalCheck:function(e){this.chooseTableConfig.tableId=e.row.id,this.chooseTableConfig.schema=e.row.monitorSchemaName,this.chooseTableConfig.table=e.row.monitorTableName,this.chooseTableConfig.key=e.row.monitorTableKey,this.chooseTableConfig.onUpdate=e.row.monitorTableOnUpdate,this.chooseTableConfig.startTimestamp=this.startTime[e.index+(this.current-1)*this.size],this.chooseTableConfig.endTimeStamp=this.endTime[e.index+(this.current-1)*this.size],this.confirmCheckModal=!0},okCheckConsistency:function(){this.checkDataConsistency(),this.confirmCheckModal=!1},cancelCheckConsistency:function(){this.confirmCheckModal=!1},checkDataConsistency:function(){var e=this;this.axios.post("/api/drc/v1/monitor/consistency/data/full/"+this.$route.query.clusterA+"/"+this.$route.query.clusterB,{tableId:this.chooseTableConfig.tableId,schema:this.chooseTableConfig.schema,table:this.chooseTableConfig.table,key:this.chooseTableConfig.key,onUpdate:this.chooseTableConfig.onUpdate,startTimestamp:this.chooseTableConfig.startTimestamp,endTimeStamp:this.chooseTableConfig.endTimeStamp,mhaAName:this.$route.query.clusterA,mhaBName:this.$route.query.clusterB}).then((function(t){console.log("add result"),console.log(t.data),0===t.data.status?(e.executeStatus="success",e.executeMsg=t.data.message):(e.executeStatus="error",e.executeMsg=t.data.data),e.executeModal=!0}))},okExecuteModal:function(){this.executeModal=!1,this.confirmCheckModal=!1},showCheckResult:function(e){this.$router.push({name:"fullDataConsistencyResult",query:{dbName:e.monitorSchemaName,tableName:e.monitorTableName,mhaA:this.$route.query.clusterA,mhaB:this.$route.query.clusterB,key:e.monitorTableKey,checkTime:Object(s["a"])(new Date(e.fullDataCheckLasttime),"yyyy-MM-dd hh:mm:ss")}})}},computed:{dataWithPage:function(){var e=this.records,t=this.current*this.size-this.size,a=t+this.size;return Object(i["a"])(e).slice(t,a)}},created:function(){this.getConfiguredTables()}},c=r,l=a("2877"),u=Object(l["a"])(c,o,n,!1,null,"ddb6d8ee",null);t["default"]=u.exports},2909:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var o=a("6b75");function n(e){if(Array.isArray(e))return Object(o["a"])(e)}a("a4d3"),a("e01a"),a("d28b"),a("a630"),a("d3b7"),a("3ca3"),a("ddb0");function i(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}var s=a("06c5");a("d9e2");function r(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(e){return n(e)||i(e)||Object(s["a"])(e)||r()}},"4df4":function(e,t,a){"use strict";var o=a("0366"),n=a("c65b"),i=a("7b0b"),s=a("9bdd"),r=a("e95a"),c=a("68ee"),l=a("07fa"),u=a("8418"),h=a("9a1f"),d=a("35a1"),m=Array;e.exports=function(e){var t=i(e),a=c(this),f=arguments.length,b=f>1?arguments[1]:void 0,p=void 0!==b;p&&(b=o(b,f>2?arguments[2]:void 0));var y,g,C,T,k,x,v=d(t),w=0;if(!v||this===m&&r(v))for(y=l(t),g=a?new this(y):m(y);y>w;w++)x=p?b(t[w],w):t[w],u(g,w,x);else for(g=a?new this:[],T=h(t,v),k=T.next;!(C=n(k,T)).done;w++)x=p?s(T,b,[C.value,w],!0):C.value,u(g,w,x);return g.length=w,g}},"6b75":function(e,t,a){"use strict";function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,o=Array(t);a<t;a++)o[a]=e[a];return o}a.d(t,"a",(function(){return o}))},"9bdd":function(e,t,a){"use strict";var o=a("825a"),n=a("2a62");e.exports=function(e,t,a,i){try{return i?t(o(a)[0],a[1]):t(a)}catch(s){n(e,"throw",s)}}},a630:function(e,t,a){"use strict";var o=a("23e7"),n=a("4df4"),i=a("1c7e"),s=!i((function(e){Array.from(e)}));o({target:"Array",stat:!0,forced:s},{from:n})}}]);
//# sourceMappingURL=chunk-018381ae.d7306a96.js.map