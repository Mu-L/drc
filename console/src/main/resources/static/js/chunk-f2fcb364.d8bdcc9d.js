(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f2fcb364","chunk-39ef8bd8","chunk-1ca594d7"],{"057f":function(t,e,r){var o=r("fc6a"),a=r("241c").f,n={}.toString,i="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],s=function(t){try{return a(t)}catch(e){return i.slice()}};t.exports.f=function(t){return i&&"[object Window]"==n.call(t)?s(t):a(o(t))}},"06c5":function(t,e,r){"use strict";r.d(e,"a",(function(){return a}));r("a630"),r("fb6a"),r("b0c0"),r("d3b7"),r("ac1f"),r("25f0"),r("3ca3");var o=r("6b75");function a(t,e){if(t){if("string"==typeof t)return Object(o["a"])(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Object(o["a"])(t,e):void 0}}},"159b":function(t,e,r){var o=r("da84"),a=r("fdbc"),n=r("17c2"),i=r("9112");for(var s in a){var l=o[s],c=l&&l.prototype;if(c&&c.forEach!==n)try{i(c,"forEach",n)}catch(d){c.forEach=n}}},"17c2":function(t,e,r){"use strict";var o=r("b727").forEach,a=r("a640"),n=r("ae40"),i=a("forEach"),s=n("forEach");t.exports=i&&s?[].forEach:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}},"25f0":function(t,e,r){"use strict";var o=r("6eeb"),a=r("825a"),n=r("d039"),i=r("ad6d"),s="toString",l=RegExp.prototype,c=l[s],d=n((function(){return"/a/b"!=c.call({source:"a",flags:"b"})})),u=c.name!=s;(d||u)&&o(RegExp.prototype,s,(function(){var t=a(this),e=String(t.source),r=t.flags,o=String(void 0===r&&t instanceof RegExp&&!("flags"in l)?i.call(t):r);return"/"+e+"/"+o}),{unsafe:!0})},"27bb":function(t,e,r){},2909:function(t,e,r){"use strict";r.d(e,"a",(function(){return l}));var o=r("6b75");function a(t){if(Array.isArray(t))return Object(o["a"])(t)}r("a4d3"),r("e01a"),r("d28b"),r("a630"),r("e260"),r("d3b7"),r("3ca3"),r("ddb0");function n(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}var i=r("06c5");function s(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function l(t){return a(t)||n(t)||Object(i["a"])(t)||s()}},"4df4":function(t,e,r){"use strict";var o=r("0366"),a=r("7b0b"),n=r("9bdd"),i=r("e95a"),s=r("50c4"),l=r("8418"),c=r("35a1");t.exports=function(t){var e,r,d,u,f,g,p=a(t),h="function"==typeof this?this:Array,v=arguments.length,b=v>1?arguments[1]:void 0,x=void 0!==b,y=c(p),m=0;if(x&&(b=o(b,v>2?arguments[2]:void 0,2)),void 0==y||h==Array&&i(y))for(e=s(p.length),r=new h(e);e>m;m++)g=x?b(p[m],m):p[m],l(r,m,g);else for(u=y.call(p),f=u.next,r=new h;!(d=f.call(u)).done;m++)g=x?n(u,b,[d.value,m],!0):d.value,l(r,m,g);return r.length=m,r}},"6b75":function(t,e,r){"use strict";function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,o=Array(e);r<e;r++)o[r]=t[r];return o}r.d(e,"a",(function(){return o}))},7358:function(t,e,r){"use strict";r("d2da")},"746f":function(t,e,r){var o=r("428f"),a=r("5135"),n=r("e538"),i=r("9bf2").f;t.exports=function(t){var e=o.Symbol||(o.Symbol={});a(e,t)||i(e,t,{value:n.f(t)})}},"7ab6":function(t,e,r){"use strict";r("27bb")},8418:function(t,e,r){"use strict";var o=r("c04e"),a=r("9bf2"),n=r("5c6c");t.exports=function(t,e,r){var i=o(e);i in t?a.f(t,i,n(0,r)):t[i]=r}},9263:function(t,e,r){"use strict";var o=r("ad6d"),a=r("9f7f"),n=RegExp.prototype.exec,i=String.prototype.replace,s=n,l=function(){var t=/a/,e=/b*/g;return n.call(t,"a"),n.call(e,"a"),0!==t.lastIndex||0!==e.lastIndex}(),c=a.UNSUPPORTED_Y||a.BROKEN_CARET,d=void 0!==/()??/.exec("")[1],u=l||d||c;u&&(s=function(t){var e,r,a,s,u=this,f=c&&u.sticky,g=o.call(u),p=u.source,h=0,v=t;return f&&(g=g.replace("y",""),-1===g.indexOf("g")&&(g+="g"),v=String(t).slice(u.lastIndex),u.lastIndex>0&&(!u.multiline||u.multiline&&"\n"!==t[u.lastIndex-1])&&(p="(?: "+p+")",v=" "+v,h++),r=new RegExp("^(?:"+p+")",g)),d&&(r=new RegExp("^"+p+"$(?!\\s)",g)),l&&(e=u.lastIndex),a=n.call(f?r:u,v),f?a?(a.input=a.input.slice(h),a[0]=a[0].slice(h),a.index=u.lastIndex,u.lastIndex+=a[0].length):u.lastIndex=0:l&&a&&(u.lastIndex=u.global?a.index+a[0].length:e),d&&a&&a.length>1&&i.call(a[0],r,(function(){for(s=1;s<arguments.length-2;s++)void 0===arguments[s]&&(a[s]=void 0)})),a}),t.exports=s},"9f7f":function(t,e,r){"use strict";var o=r("d039");function a(t,e){return RegExp(t,e)}e.UNSUPPORTED_Y=o((function(){var t=a("a","y");return t.lastIndex=2,null!=t.exec("abcd")})),e.BROKEN_CARET=o((function(){var t=a("^r","gy");return t.lastIndex=2,null!=t.exec("str")}))},a15b:function(t,e,r){"use strict";var o=r("23e7"),a=r("44ad"),n=r("fc6a"),i=r("a640"),s=[].join,l=a!=Object,c=i("join",",");o({target:"Array",proto:!0,forced:l||!c},{join:function(t){return s.call(n(this),void 0===t?",":t)}})},a4d3:function(t,e,r){"use strict";var o=r("23e7"),a=r("da84"),n=r("d066"),i=r("c430"),s=r("83ab"),l=r("4930"),c=r("fdbf"),d=r("d039"),u=r("5135"),f=r("e8b5"),g=r("861d"),p=r("825a"),h=r("7b0b"),v=r("fc6a"),b=r("c04e"),x=r("5c6c"),y=r("7c73"),m=r("df75"),L=r("241c"),S=r("057f"),w=r("7418"),R=r("06cf"),q=r("9bf2"),T=r("d1e7"),I=r("9112"),E=r("6eeb"),_=r("5692"),O=r("f772"),D=r("d012"),k=r("90e3"),j=r("b622"),C=r("e538"),$=r("746f"),z=r("d44e"),A=r("69f3"),M=r("b727").forEach,N=O("hidden"),P="Symbol",B="prototype",Q=j("toPrimitive"),U=A.set,H=A.getterFor(P),W=Object[B],F=a.Symbol,J=n("JSON","stringify"),V=R.f,K=q.f,Y=S.f,G=T.f,X=_("symbols"),Z=_("op-symbols"),tt=_("string-to-symbol-registry"),et=_("symbol-to-string-registry"),rt=_("wks"),ot=a.QObject,at=!ot||!ot[B]||!ot[B].findChild,nt=s&&d((function(){return 7!=y(K({},"a",{get:function(){return K(this,"a",{value:7}).a}})).a}))?function(t,e,r){var o=V(W,e);o&&delete W[e],K(t,e,r),o&&t!==W&&K(W,e,o)}:K,it=function(t,e){var r=X[t]=y(F[B]);return U(r,{type:P,tag:t,description:e}),s||(r.description=e),r},st=c?function(t){return"symbol"==typeof t}:function(t){return Object(t)instanceof F},lt=function(t,e,r){t===W&&lt(Z,e,r),p(t);var o=b(e,!0);return p(r),u(X,o)?(r.enumerable?(u(t,N)&&t[N][o]&&(t[N][o]=!1),r=y(r,{enumerable:x(0,!1)})):(u(t,N)||K(t,N,x(1,{})),t[N][o]=!0),nt(t,o,r)):K(t,o,r)},ct=function(t,e){p(t);var r=v(e),o=m(r).concat(pt(r));return M(o,(function(e){s&&!ut.call(r,e)||lt(t,e,r[e])})),t},dt=function(t,e){return void 0===e?y(t):ct(y(t),e)},ut=function(t){var e=b(t,!0),r=G.call(this,e);return!(this===W&&u(X,e)&&!u(Z,e))&&(!(r||!u(this,e)||!u(X,e)||u(this,N)&&this[N][e])||r)},ft=function(t,e){var r=v(t),o=b(e,!0);if(r!==W||!u(X,o)||u(Z,o)){var a=V(r,o);return!a||!u(X,o)||u(r,N)&&r[N][o]||(a.enumerable=!0),a}},gt=function(t){var e=Y(v(t)),r=[];return M(e,(function(t){u(X,t)||u(D,t)||r.push(t)})),r},pt=function(t){var e=t===W,r=Y(e?Z:v(t)),o=[];return M(r,(function(t){!u(X,t)||e&&!u(W,t)||o.push(X[t])})),o};if(l||(F=function(){if(this instanceof F)throw TypeError("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,e=k(t),r=function(t){this===W&&r.call(Z,t),u(this,N)&&u(this[N],e)&&(this[N][e]=!1),nt(this,e,x(1,t))};return s&&at&&nt(W,e,{configurable:!0,set:r}),it(e,t)},E(F[B],"toString",(function(){return H(this).tag})),E(F,"withoutSetter",(function(t){return it(k(t),t)})),T.f=ut,q.f=lt,R.f=ft,L.f=S.f=gt,w.f=pt,C.f=function(t){return it(j(t),t)},s&&(K(F[B],"description",{configurable:!0,get:function(){return H(this).description}}),i||E(W,"propertyIsEnumerable",ut,{unsafe:!0}))),o({global:!0,wrap:!0,forced:!l,sham:!l},{Symbol:F}),M(m(rt),(function(t){$(t)})),o({target:P,stat:!0,forced:!l},{for:function(t){var e=String(t);if(u(tt,e))return tt[e];var r=F(e);return tt[e]=r,et[r]=e,r},keyFor:function(t){if(!st(t))throw TypeError(t+" is not a symbol");if(u(et,t))return et[t]},useSetter:function(){at=!0},useSimple:function(){at=!1}}),o({target:"Object",stat:!0,forced:!l,sham:!s},{create:dt,defineProperty:lt,defineProperties:ct,getOwnPropertyDescriptor:ft}),o({target:"Object",stat:!0,forced:!l},{getOwnPropertyNames:gt,getOwnPropertySymbols:pt}),o({target:"Object",stat:!0,forced:d((function(){w.f(1)}))},{getOwnPropertySymbols:function(t){return w.f(h(t))}}),J){var ht=!l||d((function(){var t=F();return"[null]"!=J([t])||"{}"!=J({a:t})||"{}"!=J(Object(t))}));o({target:"JSON",stat:!0,forced:ht},{stringify:function(t,e,r){var o,a=[t],n=1;while(arguments.length>n)a.push(arguments[n++]);if(o=e,(g(e)||void 0!==t)&&!st(t))return f(e)||(e=function(t,e){if("function"==typeof o&&(e=o.call(this,t,e)),!st(e))return e}),a[1]=e,J.apply(null,a)}})}F[B][Q]||I(F[B],Q,F[B].valueOf),z(F,P),D[N]=!0},a630:function(t,e,r){var o=r("23e7"),a=r("4df4"),n=r("1c7e"),i=!n((function(t){Array.from(t)}));o({target:"Array",stat:!0,forced:i},{from:a})},a640:function(t,e,r){"use strict";var o=r("d039");t.exports=function(t,e){var r=[][t];return!!r&&o((function(){r.call(null,e||function(){throw 1},1)}))}},ac1f:function(t,e,r){"use strict";var o=r("23e7"),a=r("9263");o({target:"RegExp",proto:!0,forced:/./.exec!==a},{exec:a})},ad6d:function(t,e,r){"use strict";var o=r("825a");t.exports=function(){var t=o(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},b0c0:function(t,e,r){var o=r("83ab"),a=r("9bf2").f,n=Function.prototype,i=n.toString,s=/^\s*function ([^ (]*)/,l="name";o&&!(l in n)&&a(n,l,{configurable:!0,get:function(){try{return i.call(this).match(s)[1]}catch(t){return""}}})},d28b:function(t,e,r){var o=r("746f");o("iterator")},d2da:function(t,e,r){},d7e3:function(t,e,r){"use strict";r.r(e);var o=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("codemirror",{attrs:{options:t.options},model:{value:t.rowData,callback:function(e){t.rowData=e},expression:"rowData"}})],1)},a=[],n=r("8f94"),i=(r("0f7c"),r("ffda"),{name:"conflictRowsLogDetail",props:{rowData:String},components:{codemirror:n["codemirror"]},data:function(){return{options:{value:"",mode:"text/x-mysql",theme:"ambiance",lineWrapping:!0,height:100,readOnly:!0,lineNumbers:!0}}}}),s=i,l=(r("7358"),r("2877")),c=Object(l["a"])(s,o,a,!1,null,null,null);e["default"]=c.exports},e01a:function(t,e,r){"use strict";var o=r("23e7"),a=r("83ab"),n=r("da84"),i=r("5135"),s=r("861d"),l=r("9bf2").f,c=r("e893"),d=n.Symbol;if(a&&"function"==typeof d&&(!("description"in d.prototype)||void 0!==d().description)){var u={},f=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),e=this instanceof f?new d(t):void 0===t?d():d(t);return""===t&&(u[e]=!0),e};c(f,d);var g=f.prototype=d.prototype;g.constructor=f;var p=g.toString,h="Symbol(test)"==String(d("test")),v=/^Symbol\((.*)\)[^)]+$/;l(g,"description",{configurable:!0,get:function(){var t=s(this)?this.valueOf():this,e=p.call(t);if(i(u,t))return"";var r=h?e.slice(7,-1):e.replace(v,"$1");return""===r?void 0:r}}),o({global:!0,forced:!0},{Symbol:f})}},e538:function(t,e,r){var o=r("b622");e.f=o},ece4:function(t,e,r){"use strict";r.r(e);var o=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("base-component",{attrs:{isFather:t.isFather,subMenuName:["1"],fatherMenu:t.fatherMenu}},[r("Breadcrumb",{style:{margin:"15px 0 15px 185px",position:"fixed"}},[r("BreadcrumbItem",{attrs:{to:"/conflictLog"}},[t._v("冲突行")]),r("BreadcrumbItem",{attrs:{to:"/conflictApproval"}},[t._v("冲突审批")]),r("BreadcrumbItem",[t._v("冲突详情")])],1),r("Content",{staticClass:"content",style:{padding:"10px",background:"#fff",margin:"50px 0 1px 185px",zIndex:"1"}},[r("div",{style:{padding:"1px 1px",height:"100%"}},[r("Card",[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(" 自动冲突处理结果 ")]),"0"===t.queryType?r("div",{staticClass:"ivu-list-item-meta-title"},[t._v("事务提交结果： "),r("Button",{attrs:{loading:t.logTableLoading,size:"small",type:0==t.trxLog.trxResult?"success":"error"}},[t._v(" "+t._s(t.trxLog.trxResultStr)+" ")])],1):t._e(),r("div",{staticClass:"ivu-list-item-meta-title"},[t._v("所有机房当前冲突行记录： "),r("Tooltip",{attrs:{content:"数据一致性比对忽略字段过滤的列"}},[r("Button",{attrs:{loading:t.recordLoading,size:"small",type:1==t.trxLog.recordEqual?"success":"warning"},on:{click:t.getRecords}},[t._v(t._s(t.trxLog.diffStr))])],1)],1),r("Divider"),r("div",{staticClass:"ivu-list-item-meta-title"},[t._v("源机房("+t._s(t.trxLog.srcRegion)+")")]),t._l(t.srcRecords,(function(e,o){return r("Card",{key:o},[r("div",{staticClass:"ivu-list-item-meta-title"},[t._v("表名："+t._s(e.tableName)+" "),r("Tooltip",{attrs:{content:1==e.doubleSync?"双向同步":"单向同步"}},[r("Button",{attrs:{size:"small",type:1==e.doubleSync?"success":"primary"}},[t._v(" "+t._s(1==e.doubleSync?"双向同步":"单向同步")+" ")])],1)],1),r("Table",{attrs:{size:"small",columns:e.columns,data:e.records,border:""}})],1)})),r("Divider"),r("div",{staticClass:"ivu-list-item-meta-title"},[t._v("目标机房("+t._s(t.trxLog.dstRegion)+")")]),t._l(t.dstRecords,(function(e,o){return r("Card",{key:o},[r("div",{staticClass:"ivu-list-item-meta-title"},[t._v("表名："+t._s(e.tableName)+" "),r("Tooltip",{attrs:{content:1==e.doubleSync?"双向同步":"单向同步"}},[r("Button",{attrs:{size:"small",type:1==e.doubleSync?"success":"primary"}},[t._v(" "+t._s(1==e.doubleSync?"双向同步":"单向同步")+" ")])],1)],1),r("Table",{attrs:{size:"small",columns:e.columns,data:e.records,border:""}})],1)}))],2),r("Divider"),r("Card",[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(" DRC冲突处理流程 ")]),r("Table",{ref:"multipleTable",attrs:{stripe:"",loading:t.logTableLoading,columns:t.trxLog.columns,data:t.dataWithPage},on:{"on-selection-change":t.changeSelection}}),r("div",[r("Page",{attrs:{transfer:!0,total:t.trxLog.tableData.length,current:t.trxLog.current,"page-size-opts":t.trxLog.pageSizeOpts,"page-size":this.trxLog.size,"show-total":"","show-sizer":"","show-elevator":""},on:{"update:current":function(e){return t.$set(t.trxLog,"current",e)},"on-page-size-change":t.handleChangeSize}})],1)],1),r("Divider"),r("Card",[r("p",{attrs:{slot:"title"},slot:"title"},[t._v(" 选择冲突行自动冲突处理 ")]),r("p",[t._v("写入region")]),r("Row",{attrs:{gutter:10}},[r("Col",{attrs:{span:"3"}},[r("Select",{attrs:{filterable:"",clearable:"",placeholder:"选择写入region"},model:{value:t.writeSide,callback:function(e){t.writeSide=e},expression:"writeSide"}},t._l(t.regionOpt,(function(e){return r("Option",{key:e.key,attrs:{value:e.key}},[t._v(t._s(e.val))])})),1)],1),r("Col",{attrs:{span:"4"}},["2"!==t.queryType?r("Button",{attrs:{loading:t.sqlLoading,size:"middle",type:"success"},on:{click:t.generateHandleSql}},[t._v("生成SQL")]):t._e()],1),r("Col",{attrs:{span:"4"}},["2"===t.queryType?r("a",{attrs:{target:"_blank",href:this.approvalDetailUrl}},[t._v("审批链接")]):t._e()])],1),r("br"),r("div",{attrs:{loading:t.sqlLoading}},[r("codemirror",{attrs:{options:t.options},model:{value:t.handleSql,callback:function(e){t.handleSql=e},expression:"handleSql"}})],1),r("br"),"2"!==t.queryType?r("Button",{attrs:{loading:t.approvalLoading,size:"middle",type:"primary"},on:{click:t.generateApproval}},[t._v("提交审批")]):t._e(),t.showExecute?r("Button",{attrs:{disabled:"true"===t.disabled,loading:t.executeLoading,size:"middle",type:"primary"},on:{click:t.executeApproval}},[t._v("执行SQL")]):t._e()],1),r("Divider")],1)])],1)},a=[],n=r("2909"),i=(r("a15b"),r("fb6a"),r("d3b7"),r("159b"),r("d7e3")),s=r("8f94"),l=(r("0f7c"),r("ffda"),{name:"conflictLogDetail",props:{rowData:String},components:{codemirror:s["codemirror"]},data:function(){return{disabled:"",executeLoading:!1,showExecute:!1,approvalDetailUrl:"",approvalLoading:!1,handleSql:"",handleSqlList:[],showHandleSql:!1,multiData:[],sqlLoading:!1,writeSide:0,regionOpt:[],queryType:0,byRowLogIds:!1,rowLogIds:[],conflictTrxLogId:0,recordLoading:!1,logTableLoading:!1,approvalId:0,srcRecords:[],dstRecords:[],srcTable:{data:[],columns:[]},dstTable:{data:[],columns:[]},trxLog:{srcRegion:"",dstRegion:"",trxResult:null,trxResultStr:"",hasDiff:null,recordEqual:null,diffStr:"",tableData:[],columns:[{type:"selection",width:40,align:"center"},{type:"expand",width:40,render:function(t,e){var r=e.row;return t(i["default"],{props:{rowData:"/*原始SQL*/\n"+r.rawSql+"\n/*原始SQL处理结果: "+r.rawSqlResult+"*/\n\n/*冲突时行记录*/\n"+r.dstRowRecord+"\n\n/*冲突处理SQL*/\n"+r.handleSql+"\n/*冲突处理SQL处理结果: "+r.handleSqlResult+"*/"}})}},{title:"执行顺序",key:"rowId",width:100},{title:"表名",key:"tableName",width:250,tooltip:!0,render:function(t,e){var r=e.row,o=r.dbName+"."+r.tableName;return t("div",o)}},{title:"原始sql",key:"rawSql",tooltip:!0},{title:"处理结果",key:"rowResult",width:120,align:"center",render:function(t,e){var r=e.row,o=0===r.rowResult?"blue":"volcano",a=0===r.rowResult?"commit":"rollback";return t("Tag",{props:{color:o}},a)}}],total:0,current:1,size:10,pageSizeOpts:[10,20,50,100]},options:{value:"",mode:"text/x-mysql",theme:"ambiance",lineWrapping:!0,height:100,readOnly:!0,lineNumbers:!0}}},methods:{executeApproval:function(){var t=this;this.executeLoading=!0,this.axios.post("/api/drc/v2/log/approval/execute?approvalId="+this.approvalId).then((function(e){1===e.data.status?t.$Message.error("SQL执行失败! "+e.data.message):(t.$Message.success("SQL执行成功!"),t.disabled="true",t.getRecords())})).finally((function(){t.executeLoading=!1}))},getHandleSql:function(){var t=this;this.axios.get("/api/drc/v2/log/approval/detail?approvalId="+this.approvalId).then((function(e){if(1===e.data.status)t.$Message.error("查询冲突自动处理SQL失败!");else{var r=e.data;t.handleSqlList=r.data;var o=[];r.data.forEach((function(t){return o.push(t.autoHandleSql)})),t.handleSql=o.join("\n")}})).finally((function(){t.logTableLoading=!1}))},generateApproval:function(){var t=this;if(0!==this.handleSqlList.length){this.approvalLoading=!0;var e=[];this.handleSqlList.forEach((function(t){var r={rowLogId:t.rowLogId,handleSql:t.autoHandleSql};e.push(r)})),this.axios.post("/api/drc/v2/log/approval/create",{writeSide:this.writeSide,handleSqlDtos:e}).then((function(e){1===e.data.status?t.$Message.error("提交审批单失败！"):t.$Message.success("提交审批单成功")})).finally((function(){t.approvalLoading=!1}))}else this.$Message.warning("未生成SQL！")},generateHandleSql:function(){var t=this,e=this.multiData;if(void 0!==e&&null!==e&&0!==e.length){var r=[];e.forEach((function(t){return r.push(t.rowLogId)})),this.sqlLoading=!0,this.handleSql="",this.axios.post("/api/drc/v2/log/conflict/rows/handleSql",{writeSide:this.writeSide,rowLogIds:r}).then((function(e){var r=e.data;if(0===r.status){t.handleSqlList=r.data;var o=[];r.data.forEach((function(t){return o.push(t.autoHandleSql)})),t.handleSql=o.join("\n")}else t.$Message.error("自动生成SQL失败: "+r.message)})).finally((function(){t.sqlLoading=!1}))}else this.$Message.warning("请勾选！")},handleSpan:function(t){t.row,t.column,t.rowIndex;var e=t.columnIndex;if(0===e)return[0,0]},handleChangeSize:function(t){this.trxLog.size=t},getTrxLogDetail:function(){var t=this;this.logTableLoading=!0,this.axios.get("/api/drc/v2/log/conflict/detail?conflictTrxLogId="+this.conflictTrxLogId).then((function(e){if(1===e.data.status)t.$Message.error("查询冲突详情失败!");else{var r=e.data.data;t.trxLog.srcRegion=r.srcRegion,t.trxLog.dstRegion=r.dstRegion,t.trxLog.trxResult=r.trxResult,t.trxLog.trxResultStr=0===r.trxResult?"commit":"rollback",t.trxLog.tableData=r.rowsLogDetailViews,t.regionOpt=[{key:0,val:t.trxLog.dstRegion},{key:1,val:t.trxLog.srcRegion}]}})).finally((function(){t.logTableLoading=!1}))},getTrxLogDetail1:function(){var t=this;this.logTableLoading=!0,this.axios.get("/api/drc/v2/log/conflict/rows/detail?conflictRowLogIds="+this.rowLogIds).then((function(e){if(1===e.data.status)t.$Message.error("查询冲突详情失败!");else{var r=e.data.data;t.trxLog.srcRegion=r.srcRegion,t.trxLog.dstRegion=r.dstRegion,t.trxLog.trxResult=r.trxResult,t.trxLog.trxResultStr=0===r.trxResult?"commit":"rollback",t.trxLog.tableData=r.rowsLogDetailViews,t.regionOpt=[{key:0,val:t.trxLog.dstRegion},{key:1,val:t.trxLog.srcRegion}]}})).finally((function(){t.logTableLoading=!1}))},getTrxLogDetail2:function(){var t=this;this.logTableLoading=!0,this.axios.get("/api/drc/v2/log/approval/rows/detail?approvalId="+this.approvalId).then((function(e){if(1===e.data.status)t.$Message.error("查询冲突详情失败!");else{var r=e.data.data;t.trxLog.srcRegion=r.srcRegion,t.trxLog.dstRegion=r.dstRegion,t.trxLog.trxResult=r.trxResult,t.trxLog.trxResultStr=0===r.trxResult?"commit":"rollback",t.trxLog.tableData=r.rowsLogDetailViews,t.regionOpt=[{key:0,val:t.trxLog.dstRegion},{key:1,val:t.trxLog.srcRegion}]}})).finally((function(){t.logTableLoading=!1}))},getWriteSide:function(){var t=this;this.axios.get("/api/drc/v2/log/approval/writeSide?approvalId="+this.approvalId).then((function(e){1===e.data.status?t.$Message.error("查询写入region失败!"):t.writeSide=e.data.data}))},getTrxRecords:function(){var t=this;this.recordLoading=!0,this.axios.get("/api/drc/v2/log/conflict/records?conflictTrxLogId="+this.conflictTrxLogId+"&columnSize=12").then((function(e){if(1===e.data.status)t.trxLog.diffStr="数据比对失败";else{var r=e.data.data;t.trxLog.recordEqual=r.recordIsEqual,t.trxLog.diffStr=r.recordIsEqual?"数据一致":"数据不一致",t.srcRecords=r.srcRecords,t.dstRecords=r.dstRecords}})).finally((function(){t.recordLoading=!1}))},getTrxRecords1:function(){var t=this;this.recordLoading=!0,this.axios.get("/api/drc/v2/log/conflict/rows/records?conflictRowLogIds="+this.rowLogIds).then((function(e){if(1===e.data.status)t.trxLog.diffStr="数据比对失败";else{var r=e.data.data;t.trxLog.recordEqual=r.recordIsEqual,t.trxLog.diffStr=r.recordIsEqual?"数据一致":"数据不一致",t.srcRecords=r.srcRecords,t.dstRecords=r.dstRecords}})).finally((function(){t.recordLoading=!1}))},getTrxRecords2:function(){var t=this;this.recordLoading=!0,this.axios.get("/api/drc/v2/log/approval/rows/records?approvalId="+this.approvalId).then((function(e){if(1===e.data.status)t.trxLog.diffStr="数据比对失败";else{var r=e.data.data;t.trxLog.recordEqual=r.recordIsEqual,t.trxLog.diffStr=r.recordIsEqual?"数据一致":"数据不一致",t.srcRecords=r.srcRecords,t.dstRecords=r.dstRecords}})).finally((function(){t.recordLoading=!1}))},getRecords:function(){"0"===this.queryType?this.getTrxRecords():"1"===this.queryType?this.getTrxRecords1():"2"===this.queryType&&this.getTrxRecords2()},changeSelection:function(t){this.multiData=t}},computed:{dataWithPage:function(){var t=this.trxLog.tableData,e=this.trxLog.current*this.trxLog.size-this.trxLog.size,r=e+this.trxLog.size;return Object(n["a"])(t).slice(e,r)}},created:function(){this.conflictTrxLogId=this.$route.query.conflictTrxLogId,this.queryType=this.$route.query.queryType,this.approvalDetailUrl=this.$route.query.approvalDetailUrl,this.rowLogIds=this.$route.query.rowLogIds,this.approvalId=this.$route.query.approvalId,"0"===this.queryType?(this.getTrxLogDetail(),this.getTrxRecords()):"1"===this.queryType?(this.getTrxLogDetail1(),this.getTrxRecords1()):"2"===this.queryType&&(this.showExecute=this.$route.query.showExecute,this.disabled=this.$route.query.disabled,this.getWriteSide(),this.getTrxLogDetail2(),this.getTrxRecords2(),this.getHandleSql())}}),c=l,d=(r("7ab6"),r("2877")),u=Object(d["a"])(c,o,a,!1,null,null,null);e["default"]=u.exports},fb6a:function(t,e,r){"use strict";var o=r("23e7"),a=r("861d"),n=r("e8b5"),i=r("23cb"),s=r("50c4"),l=r("fc6a"),c=r("8418"),d=r("b622"),u=r("1dde"),f=r("ae40"),g=u("slice"),p=f("slice",{ACCESSORS:!0,0:0,1:2}),h=d("species"),v=[].slice,b=Math.max;o({target:"Array",proto:!0,forced:!g||!p},{slice:function(t,e){var r,o,d,u=l(this),f=s(u.length),g=i(t,f),p=i(void 0===e?f:e,f);if(n(u)&&(r=u.constructor,"function"!=typeof r||r!==Array&&!n(r.prototype)?a(r)&&(r=r[h],null===r&&(r=void 0)):r=void 0,r===Array||void 0===r))return v.call(u,g,p);for(o=new(void 0===r?Array:r)(b(p-g,0)),d=0;g<p;g++,d++)g in u&&c(o,d,u[g]);return o.length=d,o}})}}]);
//# sourceMappingURL=chunk-f2fcb364.d8bdcc9d.js.map