(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3af28c3e"],{"037b":function(t,e,a){"use strict";a("f6f1")},"0dae":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("base-component",{attrs:{isFather:t.isFather,subMenuName:["1"],fatherMenu:t.fatherMenu}},[a("Breadcrumb",{style:{margin:"15px 0 15px 185px",position:"fixed"}},[a("BreadcrumbItem",{attrs:{to:"/home"}},[t._v("首页")]),a("BreadcrumbItem",{attrs:{to:"/fullDataConsistencyCluster"}},[t._v("校验集群")]),a("BreadcrumbItem",{attrs:{to:"/fullDataConsistencyCheck"}},[t._v("校验表配置")]),a("BreadcrumbItem",[t._v("当前结果及自助处理")])],1),a("Content",{staticClass:"content",style:{padding:"10px",background:"#fff",margin:"50px 0 1px 185px",zIndex:"1"}},[a("div",{staticStyle:{padding:"1px 1px"}},[a("Card",[a("div",{staticClass:"ivu-list-item-meta-title"},[a("p",[t._v("DRC集群："+t._s(t.mhaAName)+"---"+t._s(t.mhaBName))])]),a("div",{staticClass:"ivu-list-item-meta-title"},[a("p",[t._v("数据库名："+t._s(this.dbName))])]),a("div",{staticClass:"ivu-list-item-meta-title"},[a("p",[t._v("表名："+t._s(this.tableName))])]),a("div",{staticClass:"ivu-list-item-meta-title"},[t._v("一致性结果： "),a("Tag",{attrs:{color:t.isInconsistency,size:"medium"}},[t._v(t._s(t.inconsistency))])],1),a("div",{staticClass:"ivu-list-item-meta-title"},[a("p",[t._v("当前不一致条数："+t._s(this.differentCount))])]),a("Divider"),a("div",{staticClass:"ivu-list-item-meta-title"},[t._v("机房："+t._s(t.mhaADc))]),a("Table",{staticStyle:{"margin-top":"20px"},attrs:{columns:t.mhaAColumn,data:t.mhaARecord,size:"small"}}),a("Divider"),a("div",{staticClass:"ivu-list-item-meta-title"},[t._v("机房："+t._s(t.mhaBDc))]),a("Table",{staticStyle:{"margin-top":"20px"},attrs:{columns:t.mhaBColumn,data:t.mhaBRecord,size:"small"}}),a("Divider"),a("Card",[a("p",{attrs:{slot:"title"},slot:"title"},[t._v(" 一致性处理 ")]),a("Form",[a("FormItem",[a("div",{staticClass:"ivu-list-item-meta-title"},[t._v("机房："+t._s(t.mhaADc))])]),a("FormItem",{attrs:{label:"操作SQL"}},[a("codemirror",{attrs:{options:t.operateCmOptions},model:{value:t.operateCode1,callback:function(e){t.operateCode1=e},expression:"operateCode1"}})],1)],1),a("Button",{style:{marginLeft:"1000px"},attrs:{type:"primary"},on:{click:t.SubmitSrcSql}},[t._v(" 提交 ")]),a("Divider"),a("Form",[a("FormItem",[a("div",{staticClass:"ivu-list-item-meta-title"},[t._v("机房："+t._s(t.mhaBDc))])]),a("FormItem",{attrs:{label:"操作SQL"}},[a("codemirror",{attrs:{options:t.operateCmOptions},model:{value:t.operateCode2,callback:function(e){t.operateCode2=e},expression:"operateCode2"}})],1),a("Button",{style:{marginLeft:"1000px"},attrs:{type:"primary"},on:{click:t.SubmitDestSql}},[t._v(" 提交 ")]),a("Divider")],1)],1),a("Modal",{attrs:{title:"执行SQL",width:"1000px"},on:{"on-ok":t.okSubmitSrcSql,"on-cancel":t.cancelSubmitSrcSql},model:{value:this.submitSrcSql,callback:function(e){t.$set(this,"submitSrcSql",e)},expression:"this.submitSrcSql"}},[a("Form",[a("FormItem",{attrs:{label:"执行机房"}},[a("Tag",{attrs:{color:"blue"}},[t._v(t._s(t.mhaADc))])],1),a("FormItem",{attrs:{label:"执行SQL"}},[a("codemirror",{ref:"submitSrcSqlEditor",attrs:{options:t.cmOptions},model:{value:t.operateCode1,callback:function(e){t.operateCode1=e},expression:"operateCode1"}})],1)],1)],1),a("Modal",{attrs:{title:"执行SQL",width:"1000px"},on:{"on-ok":t.okSubmitDestSql,"on-cancel":t.cancelSubmitDestSql},model:{value:this.submitDestSql,callback:function(e){t.$set(this,"submitDestSql",e)},expression:"this.submitDestSql"}},[a("Form",[a("FormItem",{attrs:{label:"执行机房"}},[a("Tag",{attrs:{color:"blue"}},[t._v(t._s(t.mhaBDc))])],1),a("FormItem",{attrs:{label:"执行SQL"}},[a("codemirror",{ref:"submitDestSqlEditor",attrs:{options:t.cmOptions},model:{value:t.operateCode2,callback:function(e){t.operateCode2=e},expression:"operateCode2"}})],1)],1)],1),a("Modal",{attrs:{title:"执行结果",width:"1000px"},on:{"on-ok":t.okSubmitResult,"on-cancel":t.okSubmitResult},model:{value:this.submitResult,callback:function(e){t.$set(this,"submitResult",e)},expression:"this.submitResult"}},[a("Form",[a("FormItem",{attrs:{label:"执行结果"}},[a("Alert",{attrs:{type:this.operationStatus,"show-icon":""}},[t._v("执行结果："+t._s(this.operationMsg))])],1)],1)],1)],1)],1)])],1)},i=[],r=a("c7eb"),o=a("1da1"),n=a("8f94"),m=(a("0f7c"),a("ffda"),{name:"fullDataConsistencyResult",components:{codemirror:n["codemirror"]},data:function(){return{isFather:!0,fatherMenu:"/fullDataConsistencyCluster",mhaAColumn:[],mhaARecord:[],mhaBColumn:[],mhaBRecord:[],mhaADc:"",mhaBDc:"",mhaAName:"",mhaBName:"",isInconsistency:!1,inconsistency:"",differentCount:0,dbName:"",tableName:"",operateCmOptions:{value:"",mode:"text/x-mysql",theme:"ambiance",lineWrapping:!0,autoRefresh:!0},cmOptions:{value:"",mode:"text/x-mysql",theme:"ambiance",lineWrapping:!0,height:100,readOnly:!0,lineNumbers:!0,autoRefresh:!0},operateCode1:"",operateCode2:"",operationStatus:"",operationMsg:"",submitResult:!1,submitSrcSql:!1,submitDestSql:!1}},methods:{getCurrentRecord:function(){var t=this,e=this;this.axios.get("api/drc/v1/monitor/consistency/full/history/"+this.$route.query.mhaA+"/"+this.$route.query.mhaB+"/"+this.$route.query.dbName+"/"+this.$route.query.tableName+"/"+this.$route.query.key+"/"+this.$route.query.checkTime).then((function(a){e.mhaAColumn=a.data.data.mhaAColumnPattern,e.mhaARecord=a.data.data.mhaACurrentResultList,e.mhaBColumn=a.data.data.mhaBColumnPattern,e.mhaBRecord=a.data.data.mhaBCurrentResultList,e.mhaADc=a.data.data.mhaADc,e.mhaBDc=a.data.data.mhaBDc,e.mhaAName=a.data.data.mhaAName,e.mhaBName=a.data.data.mhaBName,e.differentCount=a.data.data.differentCount,e.isInconsistency=!0===a.data.data.markDifferentRecord?"error":"success",e.inconsistency=!0===a.data.data.markDifferentRecord?"数据不一致":"数据一致";var s=t.$route.query.tableName.split(".");t.dbName=s[0],t.tableName=s[1]}))},SubmitSrcSql:function(){var t=this;setTimeout((function(){t.$refs.submitSrcSqlEditor.codemirror.refresh()}),1),this.submitSrcSql=!0},okSubmitSrcSql:function(){var t=this;return Object(o["a"])(Object(r["a"])().mark((function e(){var a;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=t,e.next=3,t.$axios.post("/api/drc/v1/monitor/consistency/update",{userName:sessionStorage.getItem("userName"),mhaGroupId:t.$route.query.mhaGroupId,mhaName:t.mhaAName,sql:t.operateCode1}).then((function(t){a.operationMsg=t.data.message,1===t.data.status?a.operationStatus="error":a.operationStatus="success"}));case 3:t.submitResult=!0;case 4:case"end":return e.stop()}}),e)})))()},cancelSubmitSrcSql:function(){this.submitSrcSql=!1},okSubmitResult:function(){this.submitResult=!1,this.submitSrcSql=!1,this.submitDestSql=!1,this.operationMsg="",this.operationStatus=""},SubmitDestSql:function(){var t=this;setTimeout((function(){t.$refs.submitDestSqlEditor.codemirror.refresh()}),1),this.submitDestSql=!0},okSubmitDestSql:function(){var t=this;return Object(o["a"])(Object(r["a"])().mark((function e(){var a;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=t,e.next=3,t.$axios.post("/api/drc/v1/monitor/consistency/update",{userName:sessionStorage.getItem("userName"),mhaName:t.mhaBName,sql:t.operateCode2}).then((function(t){a.operationMsg=t.data.message,1===t.data.status?a.operationStatus="error":a.operationStatus="success"}));case 3:t.submitResult=!0;case 4:case"end":return e.stop()}}),e)})))()},cancelSubmitDestSql:function(){this.submitDestSql=!1}},created:function(){this.getCurrentRecord()}}),c=m,u=(a("037b"),a("2877")),l=Object(u["a"])(c,s,i,!1,null,null,null);e["default"]=l.exports},f6f1:function(t,e,a){}}]);
//# sourceMappingURL=chunk-3af28c3e.3ed7cc15.js.map