(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-11a42e38"],{"0cb2":function(e,t,a){"use strict";var n=a("e330"),r=a("7b0b"),o=Math.floor,i=n("".charAt),s=n("".replace),c=n("".slice),l=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,u=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,a,n,h,d){var f=a+e.length,m=n.length,p=u;return void 0!==h&&(h=r(h),p=l),s(d,p,(function(r,s){var l;switch(i(s,0)){case"$":return"$";case"&":return e;case"`":return c(t,0,a);case"'":return c(t,f);case"<":l=h[c(s,1,-1)];break;default:var u=+s;if(0===u)return r;if(u>m){var d=o(u/10);return 0===d?r:d<=m?void 0===n[d-1]?i(s,1):n[d-1]+i(s,1):r}l=n[u-1]}return void 0===l?"":l}))}},1043:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("base-component",{attrs:{isFather:e.isFather,subMenuName:["1"],fatherMenu:e.fatherMenu}},[t("Breadcrumb",{style:{margin:"15px 0 15px 185px",position:"fixed"}},[t("BreadcrumbItem",{attrs:{to:"/home"}},[e._v("首页")]),t("BreadcrumbItem",{attrs:{to:"/fullDataConsistencyCluster"}},[e._v("校验集群")]),t("BreadcrumbItem",[e._v("校验表配置")])],1),t("Content",{staticClass:"content",style:{padding:"10px",background:"#fff",margin:"50px 0 1px 185px",zIndex:"1"}},[t("div",{staticStyle:{padding:"1px 1px"}},[t("div",{staticClass:"ivu-list-item-meta-title"},[t("p",[e._v("DRC集群："+e._s(e.$route.query.clusterA)+"(集群A)---"+e._s(e.$route.query.clusterB)+"(集群B)")])]),t("Table",{staticStyle:{"margin-top":"20px"},attrs:{stripe:"",columns:e.columns,data:e.dataWithPage,size:"small"}}),t("div",{staticStyle:{"text-align":"center",margin:"16px 0"}},[t("Page",{attrs:{total:e.records.length,current:e.current,"show-sizer":"","show-elevator":"",placement:"top"},on:{"update:current":function(t){e.current=t},"on-page-size-change":e.handleChangeSize}})],1)],1),t("Modal",{attrs:{width:"900px",title:"一致性校验确认"},on:{"on-ok":e.okCheckConsistency,"on-cancel":e.cancelCheckConsistency},model:{value:this.confirmCheckModal,callback:function(t){e.$set(this,"confirmCheckModal",t)},expression:"this.confirmCheckModal"}},[t("Form",{attrs:{"label-width":200}},[t("FormItem",{attrs:{label:"库名"}},[t("Input",{staticStyle:{width:"500px"},attrs:{readonly:""},model:{value:this.chooseTableConfig.schema,callback:function(t){e.$set(this.chooseTableConfig,"schema",t)},expression:"this.chooseTableConfig.schema"}})],1),t("FormItem",{attrs:{label:"表名"}},[t("Input",{staticStyle:{width:"500px"},attrs:{readonly:""},model:{value:this.chooseTableConfig.table,callback:function(t){e.$set(this.chooseTableConfig,"table",t)},expression:"this.chooseTableConfig.table"}})],1),t("FormItem",{attrs:{label:"key"}},[t("Input",{staticStyle:{width:"500px"},attrs:{readonly:""},model:{value:this.chooseTableConfig.key,callback:function(t){e.$set(this.chooseTableConfig,"key",t)},expression:"this.chooseTableConfig.key"}})],1),t("FormItem",{attrs:{label:"onUpdate"}},[t("Input",{staticStyle:{width:"500px"},attrs:{readonly:""},model:{value:this.chooseTableConfig.onUpdate,callback:function(t){e.$set(this.chooseTableConfig,"onUpdate",t)},expression:"this.chooseTableConfig.onUpdate"}})],1),t("FormItem",{attrs:{label:"startTimestamp"}},[t("Input",{staticStyle:{width:"500px"},attrs:{readonly:""},model:{value:this.chooseTableConfig.startTimestamp,callback:function(t){e.$set(this.chooseTableConfig,"startTimestamp",t)},expression:"this.chooseTableConfig.startTimestamp"}})],1),t("FormItem",{attrs:{label:"endTimeStamp"}},[t("Input",{staticStyle:{width:"500px"},attrs:{readonly:""},model:{value:this.chooseTableConfig.endTimeStamp,callback:function(t){e.$set(this.chooseTableConfig,"endTimeStamp",t)},expression:"this.chooseTableConfig.endTimeStamp"}})],1)],1)],1),t("Modal",{attrs:{width:"900px",title:"执行结果"},on:{"on-ok":e.okExecuteModal,"on-cancel":e.okExecuteModal},model:{value:this.executeModal,callback:function(t){e.$set(this,"executeModal",t)},expression:"this.executeModal"}},[t("Form",[t("FormItem",{attrs:{label:"执行结果"}},[t("Alert",{attrs:{type:this.executeStatus,"show-icon":""}},[e._v(e._s(this.executeMsg))])],1)],1)],1)],1)],1)},r=[],o=a("2909"),i=(a("14d9"),a("fb6a"),a("e66c")),s={name:"fullDataConsistencyCheck",data:function(){var e=this;return{isFather:!0,fatherMenu:"/fullDataConsistencyCluster",executeStatus:"",executeMsg:"",executeModal:!1,confirmCheckModal:!1,chooseTableConfig:{tableId:"",schema:"",table:"",key:"",onUpdate:"",startTimestamp:"",endTimeStamp:""},total:0,current:1,size:10,records:[],startTime:[],endTime:[],columns:[{title:"库名",key:"monitorSchemaName",resizable:!0},{title:"表名",key:"monitorTableName",resizable:!0},{title:"开始时间",align:"center",resizable:!0,render:function(t,a){return t("DatePicker",{props:{type:"datetime",format:"yyyy-MM-dd HH:mm",transfer:!0,placeholder:"start time"},on:{"on-change":function(t){e.startTime[a.index+(e.current-1)*e.size]=t}}})}},{title:"结束时间",align:"center",resizable:!0,render:function(t,a){return t("DatePicker",{props:{type:"datetime",format:"yyyy-MM-dd HH:mm",transfer:!0,placeholder:"end time"},on:{"on-change":function(t){e.endTime[a.index+(e.current-1)*e.size]=t}}})}},{title:"操作",align:"center",resizable:!0,render:function(t,a){return t("div",[t("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.confirmModalCheck(a)}}},"执行")])}},{title:"校验状态",align:"center",render:function(e,t){var a=t.row,n=0===a.fullDataCheckStatus?"error":1===a.fullDataCheckStatus?"warning":2===a.fullDataCheckStatus?"success":"warning",r=0===a.fullDataCheckStatus?"未校验":1===a.fullDataCheckStatus?"校验中":2===a.fullDataCheckStatus?"已校验":"校验失败";return e("Tag",{props:{color:n}},r)}},{title:"最近校验时间",align:"center",render:function(e,t){return e("div",null==t.row.fullDataCheckLasttime?"":Object(i["a"])(new Date(t.row.fullDataCheckLasttime),"yyyy-MM-dd hh:mm:ss"))}},{title:"最近校验结果",align:"center",render:function(t,a){return t("div",[t("Button",{props:{type:"info",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.showCheckResult(a.row)}}},"查看")])}}]}},methods:{getConfiguredTables:function(){var e=this;this.axios.get("/api/drc/v1/monitor/consistency/data/"+this.$route.query.clusterA+"/"+this.$route.query.clusterB).then((function(t){e.records=t.data.data,console.log(t.data.data)}))},handleChangeSize:function(e){var t=this;this.size=e,this.$nextTick((function(){t.getData()}))},confirmModalCheck:function(e){this.chooseTableConfig.tableId=e.row.id,this.chooseTableConfig.schema=e.row.monitorSchemaName,this.chooseTableConfig.table=e.row.monitorTableName,this.chooseTableConfig.key=e.row.monitorTableKey,this.chooseTableConfig.onUpdate=e.row.monitorTableOnUpdate,this.chooseTableConfig.startTimestamp=this.startTime[e.index+(this.current-1)*this.size],this.chooseTableConfig.endTimeStamp=this.endTime[e.index+(this.current-1)*this.size],this.confirmCheckModal=!0},okCheckConsistency:function(){this.checkDataConsistency(),this.confirmCheckModal=!1},cancelCheckConsistency:function(){this.confirmCheckModal=!1},checkDataConsistency:function(){var e=this;this.axios.post("/api/drc/v1/monitor/consistency/data/full/"+this.$route.query.clusterA+"/"+this.$route.query.clusterB,{tableId:this.chooseTableConfig.tableId,schema:this.chooseTableConfig.schema,table:this.chooseTableConfig.table,key:this.chooseTableConfig.key,onUpdate:this.chooseTableConfig.onUpdate,startTimestamp:this.chooseTableConfig.startTimestamp,endTimeStamp:this.chooseTableConfig.endTimeStamp,mhaAName:this.$route.query.clusterA,mhaBName:this.$route.query.clusterB}).then((function(t){console.log("add result"),console.log(t.data),0===t.data.status?(e.executeStatus="success",e.executeMsg=t.data.message):(e.executeStatus="error",e.executeMsg=t.data.data),e.executeModal=!0}))},okExecuteModal:function(){this.executeModal=!1,this.confirmCheckModal=!1},showCheckResult:function(e){this.$router.push({name:"fullDataConsistencyResult",query:{dbName:e.monitorSchemaName,tableName:e.monitorTableName,mhaA:this.$route.query.clusterA,mhaB:this.$route.query.clusterB,key:e.monitorTableKey,checkTime:Object(i["a"])(new Date(e.fullDataCheckLasttime),"yyyy-MM-dd hh:mm:ss")}})}},computed:{dataWithPage:function(){var e=this.records,t=this.current*this.size-this.size,a=t+this.size;return Object(o["a"])(e).slice(t,a)}},created:function(){this.getConfiguredTables()}},c=s,l=a("2877"),u=Object(l["a"])(c,n,r,!1,null,"ddb6d8ee",null);t["default"]=u.exports},"14c3":function(e,t,a){"use strict";var n=a("c65b"),r=a("825a"),o=a("1626"),i=a("c6b6"),s=a("9263"),c=TypeError;e.exports=function(e,t){var a=e.exec;if(o(a)){var l=n(a,e,t);return null!==l&&r(l),l}if("RegExp"===i(e))return n(s,e,t);throw new c("RegExp#exec called on incompatible receiver")}},"2c3e":function(e,t,a){"use strict";var n=a("83ab"),r=a("9f7f").MISSED_STICKY,o=a("c6b6"),i=a("edd0"),s=a("69f3").get,c=RegExp.prototype,l=TypeError;n&&r&&i(c,"sticky",{configurable:!0,get:function(){if(this!==c){if("RegExp"===o(this))return!!s(this).sticky;throw new l("Incompatible receiver, RegExp required")}}})},"44e7":function(e,t,a){"use strict";var n=a("861d"),r=a("c6b6"),o=a("b622"),i=o("match");e.exports=function(e){var t;return n(e)&&(void 0!==(t=e[i])?!!t:"RegExp"===r(e))}},"4d63":function(e,t,a){"use strict";var n=a("83ab"),r=a("cfe9"),o=a("e330"),i=a("94ca"),s=a("7156"),c=a("9112"),l=a("7c73"),u=a("241c").f,h=a("3a9b"),d=a("44e7"),f=a("577e"),m=a("90d8"),p=a("9f7f"),g=a("aeb0"),b=a("cb2d"),x=a("d039"),y=a("1a2d"),v=a("69f3").enforce,C=a("2626"),T=a("b622"),k=a("fce3"),w=a("107c"),M=T("match"),S=r.RegExp,$=S.prototype,I=r.SyntaxError,E=o($.exec),R=o("".charAt),D=o("".replace),z=o("".indexOf),A=o("".slice),B=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,q=/a/g,F=/a/g,_=new S(q)!==q,N=p.MISSED_STICKY,U=p.UNSUPPORTED_Y,O=n&&(!_||N||k||w||x((function(){return F[M]=!1,S(q)!==q||S(F)===F||"/a/i"!==String(S(q,"i"))}))),P=function(e){for(var t,a=e.length,n=0,r="",o=!1;n<=a;n++)t=R(e,n),"\\"!==t?o||"."!==t?("["===t?o=!0:"]"===t&&(o=!1),r+=t):r+="[\\s\\S]":r+=t+R(e,++n);return r},H=function(e){for(var t,a=e.length,n=0,r="",o=[],i=l(null),s=!1,c=!1,u=0,h="";n<=a;n++){if(t=R(e,n),"\\"===t)t+=R(e,++n);else if("]"===t)s=!1;else if(!s)switch(!0){case"["===t:s=!0;break;case"("===t:if(r+=t,"?:"===A(e,n+1,n+3))continue;E(B,A(e,n+1))&&(n+=2,c=!0),u++;continue;case">"===t&&c:if(""===h||y(i,h))throw new I("Invalid capture group name");i[h]=!0,o[o.length]=[h,u],c=!1,h="";continue}c?h+=t:r+=t}return[r,o]};if(i("RegExp",O)){for(var j=function(e,t){var a,n,r,o,i,l,u=h($,this),p=d(e),g=void 0===t,b=[],x=e;if(!u&&p&&g&&e.constructor===j)return e;if((p||h($,e))&&(e=e.source,g&&(t=m(x))),e=void 0===e?"":f(e),t=void 0===t?"":f(t),x=e,k&&"dotAll"in q&&(n=!!t&&z(t,"s")>-1,n&&(t=D(t,/s/g,""))),a=t,N&&"sticky"in q&&(r=!!t&&z(t,"y")>-1,r&&U&&(t=D(t,/y/g,""))),w&&(o=H(e),e=o[0],b=o[1]),i=s(S(e,t),u?this:$,j),(n||r||b.length)&&(l=v(i),n&&(l.dotAll=!0,l.raw=j(P(e),a)),r&&(l.sticky=!0),b.length&&(l.groups=b)),e!==x)try{c(i,"source",""===x?"(?:)":x)}catch(y){}return i},K=u(S),Y=0;K.length>Y;)g(j,S,K[Y++]);$.constructor=j,j.prototype=$,b(r,"RegExp",j,{constructor:!0})}C("RegExp")},5319:function(e,t,a){"use strict";var n=a("2ba4"),r=a("c65b"),o=a("e330"),i=a("d784"),s=a("d039"),c=a("825a"),l=a("1626"),u=a("7234"),h=a("5926"),d=a("50c4"),f=a("577e"),m=a("1d80"),p=a("8aa5"),g=a("dc4a"),b=a("0cb2"),x=a("14c3"),y=a("b622"),v=y("replace"),C=Math.max,T=Math.min,k=o([].concat),w=o([].push),M=o("".indexOf),S=o("".slice),$=function(e){return void 0===e?e:String(e)},I=function(){return"$0"==="a".replace(/./,"$0")}(),E=function(){return!!/./[v]&&""===/./[v]("a","$0")}(),R=!s((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}));i("replace",(function(e,t,a){var o=E?"$":"$0";return[function(e,a){var n=m(this),o=u(e)?void 0:g(e,v);return o?r(o,e,n,a):r(t,f(n),e,a)},function(e,r){var i=c(this),s=f(e);if("string"==typeof r&&-1===M(r,o)&&-1===M(r,"$<")){var u=a(t,i,s,r);if(u.done)return u.value}var m=l(r);m||(r=f(r));var g,y=i.global;y&&(g=i.unicode,i.lastIndex=0);var v,I=[];while(1){if(v=x(i,s),null===v)break;if(w(I,v),!y)break;var E=f(v[0]);""===E&&(i.lastIndex=p(s,d(i.lastIndex),g))}for(var R="",D=0,z=0;z<I.length;z++){v=I[z];for(var A,B=f(v[0]),q=C(T(h(v.index),s.length),0),F=[],_=1;_<v.length;_++)w(F,$(v[_]));var N=v.groups;if(m){var U=k([B],F,q,s);void 0!==N&&w(U,N),A=f(n(r,void 0,U))}else A=b(B,s,q,F,N,r);q>=D&&(R+=S(s,D,q)+A,D=q+B.length)}return R+S(s,D)}]}),!R||!I||E)},"8aa5":function(e,t,a){"use strict";var n=a("6547").charAt;e.exports=function(e,t,a){return t+(a?n(e,t).length:1)}},c607:function(e,t,a){"use strict";var n=a("83ab"),r=a("fce3"),o=a("c6b6"),i=a("edd0"),s=a("69f3").get,c=RegExp.prototype,l=TypeError;n&&r&&i(c,"dotAll",{configurable:!0,get:function(){if(this!==c){if("RegExp"===o(this))return!!s(this).dotAll;throw new l("Incompatible receiver, RegExp required")}}})},d784:function(e,t,a){"use strict";a("ac1f");var n=a("c65b"),r=a("cb2d"),o=a("9263"),i=a("d039"),s=a("b622"),c=a("9112"),l=s("species"),u=RegExp.prototype;e.exports=function(e,t,a,h){var d=s(e),f=!i((function(){var t={};return t[d]=function(){return 7},7!==""[e](t)})),m=f&&!i((function(){var t=!1,a=/a/;return"split"===e&&(a={},a.constructor={},a.constructor[l]=function(){return a},a.flags="",a[d]=/./[d]),a.exec=function(){return t=!0,null},a[d](""),!t}));if(!f||!m||a){var p=/./[d],g=t(d,""[e],(function(e,t,a,r,i){var s=t.exec;return s===o||s===u.exec?f&&!i?{done:!0,value:n(p,t,a,r)}:{done:!0,value:n(e,a,t,r)}:{done:!1}}));r(String.prototype,e,g[0]),r(u,d,g[1])}h&&c(u[d],"sham",!0)}},e66c:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));a("4d63"),a("c607"),a("ac1f"),a("2c3e"),a("00b4"),a("25f0"),a("5319");function n(e,t){var a={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"S+":e.getMilliseconds()};for(var n in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length))),a)new RegExp("("+n+")").test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?a[n]:("00"+a[n]).substr((""+a[n]).length)));return t}}}]);
//# sourceMappingURL=chunk-11a42e38.3d4c12b2.js.map