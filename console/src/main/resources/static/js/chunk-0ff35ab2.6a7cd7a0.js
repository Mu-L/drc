(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0ff35ab2"],{1276:function(t,e,o){"use strict";var n=o("d784"),i=o("44e7"),r=o("825a"),l=o("1d80"),s=o("4840"),a=o("8aa5"),c=o("50c4"),u=o("14c3"),m=o("9263"),d=o("d039"),f=[].push,h=Math.min,g=4294967295,p=!d((function(){return!RegExp(g,"y")}));n("split",2,(function(t,e,o){var n;return n="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,o){var n=String(l(this)),r=void 0===o?g:o>>>0;if(0===r)return[];if(void 0===t)return[n];if(!i(t))return e.call(n,t,r);var s,a,c,u=[],d=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),h=0,p=new RegExp(t.source,d+"g");while(s=m.call(p,n)){if(a=p.lastIndex,a>h&&(u.push(n.slice(h,s.index)),s.length>1&&s.index<n.length&&f.apply(u,s.slice(1)),c=s[0].length,h=a,u.length>=r))break;p.lastIndex===s.index&&p.lastIndex++}return h===n.length?!c&&p.test("")||u.push(""):u.push(n.slice(h)),u.length>r?u.slice(0,r):u}:"0".split(void 0,0).length?function(t,o){return void 0===t&&0===o?[]:e.call(this,t,o)}:e,[function(e,o){var i=l(this),r=void 0==e?void 0:e[t];return void 0!==r?r.call(e,i,o):n.call(String(i),e,o)},function(t,i){var l=o(n,t,this,i,n!==e);if(l.done)return l.value;var m=r(t),d=String(this),f=s(m,RegExp),C=m.unicode,b=(m.ignoreCase?"i":"")+(m.multiline?"m":"")+(m.unicode?"u":"")+(p?"y":"g"),v=new f(p?m:"^(?:"+m.source+")",b),F=void 0===i?g:i>>>0;if(0===F)return[];if(0===d.length)return null===u(v,d)?[d]:[];var I=0,x=0,w=[];while(x<d.length){v.lastIndex=p?x:0;var y,S=u(v,p?d:d.slice(x));if(null===S||(y=h(c(v.lastIndex+(p?0:x)),d.length))===I)x=a(d,x,C);else{if(w.push(d.slice(I,x)),w.length===F)return w;for(var N=1;N<=S.length-1;N++)if(w.push(S[N]),w.length===F)return w;x=I=y}}return w.push(d.slice(I)),w}]}),!p)},"14c3":function(t,e,o){var n=o("c6b6"),i=o("9263");t.exports=function(t,e){var o=t.exec;if("function"===typeof o){var r=o.call(t,e);if("object"!==typeof r)throw TypeError("RegExp exec method returned something other than an Object or null");return r}if("RegExp"!==n(t))throw TypeError("RegExp#exec called on incompatible receiver");return i.call(t,e)}},"20e4":function(t,e,o){"use strict";o.r(e);var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("base-component",[o("Breadcrumb",{style:{margin:"15px 0 15px 185px",position:"fixed"}},[o("BreadcrumbItem",{attrs:{to:"/home"}},[t._v("首页")]),o("BreadcrumbItem",{attrs:{to:{path:"/drcV2",query:{step:3,srcMhaName:this.commonInfo.srcMhaName,dstMhaName:this.commonInfo.dstMhaName,srcDc:this.commonInfo.srcDc,dstDc:this.commonInfo.dstDc,order:this.commonInfo.order}}}},[t._v("DRC配置V2")]),o("BreadcrumbItem",{attrs:{to:{path:"/dbTables",query:{srcMhaName:this.commonInfo.srcMhaName,dstMhaName:this.commonInfo.dstMhaName,srcDc:this.commonInfo.srcDc,dstDc:this.commonInfo.dstDc}}}},[t._v("同步表")]),o("BreadcrumbItem",[t._v("配置流程")])],1),o("Content",{staticClass:"content",style:{padding:"10px",background:"#ffffff",margin:"50px 0 1px 185px",zIndex:"1",top:"500px"}},[o("span",{staticStyle:{"margin-top":"10px",color:"#464c5b","font-weight":"600"}},[t._v(t._s(t.commonInfo.srcMhaName)+"("+t._s(t.commonInfo.srcDc)+")==>"+t._s(t.commonInfo.dstMhaName)+"}("+t._s(t.commonInfo.dstDc)+")")]),[o("Steps",{staticStyle:{width:"90%","margin-left":"50px","margin-bottom":"15px","margin-top":"50px"},attrs:{current:t.currentStep}},[o("Step",{style:{cursor:"pointer"},attrs:{title:"配置表",content:"添加同步表"},nativeOn:{click:function(e){return t.jumpTo(0)}}}),o("Step",{style:{cursor:"pointer"},attrs:{title:"行过滤",content:"配置行过滤（非必要）"},nativeOn:{click:function(e){return t.jumpTo(1)}}}),o("Step",{style:{cursor:"pointer"},attrs:{title:"字段过滤",content:"配置字段过滤(非必要）"},nativeOn:{click:function(e){return t.jumpTo(2)}}}),o("Step",{style:{cursor:"pointer"},attrs:{title:"完成",content:"完成该表同步配置"},nativeOn:{click:function(e){return t.jumpTo(3)}}})],1)],o("Card",{attrs:{"dis-hover":""}},[o("Row",[o("Col",{attrs:{span:"10"}},[o("Card",[o("div",{attrs:{slot:"title"},slot:"title"},[o("span",[t._v("相关表")])]),o("Table",{attrs:{stripe:"",columns:t.nameFilterCheck.columns,data:t.dataWithPage,border:""}}),o("div",[o("Page",{attrs:{transfer:!0,total:t.commonInfo.tableData.length,current:t.nameFilterCheck.current,"page-size-opts":t.nameFilterCheck.pageSizeOpts,"page-size":this.nameFilterCheck.size,"show-total":"","show-sizer":"","show-elevator":""},on:{"update:current":function(e){return t.$set(t.nameFilterCheck,"current",e)},"on-page-size-change":t.handleChangeSize}})],1)],1)],1),o("Col",{attrs:{span:"14"}},[o("Card",[0===t.currentStep?o("div",[o("div",{attrs:{slot:"title"},slot:"title"},[o("span",[t._v("库表配置")])]),o("Form",{ref:"commonInfo",attrs:{model:t.commonInfo,rules:t.ruleInline,"label-width":100}},[o("FormItem",{staticStyle:{width:"350px"},attrs:{prop:"dbName",label:"库名"}},[o("Input",{attrs:{type:"text",placeholder:"请输入库名（支持正则）"},model:{value:t.commonInfo.dbName,callback:function(e){t.$set(t.commonInfo,"dbName",e)},expression:"commonInfo.dbName"}})],1),o("FormItem",{staticStyle:{width:"350px"},attrs:{prop:"tableName",label:"表名"}},[o("Input",{attrs:{type:"text",placeholder:"请输入表名（支持正则）"},model:{value:t.commonInfo.tableName,callback:function(e){t.$set(t.commonInfo,"tableName",e)},expression:"commonInfo.tableName"}})],1),o("FormItem",[o("Row",[o("Col",{attrs:{span:"10"}},[o("Button",{staticStyle:{"margin-left":"10px"},attrs:{type:"success"},on:{click:t.checkMysqlTablesInSrcMha}},[t._v("校验")])],1),o("Col",{attrs:{span:"8"}},[o("Button",{attrs:{type:"primary"},on:{click:t.submitConfig}},[t._v("保存")])],1)],1)],1)],1)],1):t._e(),1===t.currentStep?o("rows-filter-v2",t._b({},"rows-filter-v2",t.commonInfo,!1)):t._e(),2===t.currentStep?o("columns-filter-v2",t._b({},"columns-filter-v2",t.commonInfo,!1)):t._e(),3===t.currentStep?o("complete",t._b({},"complete",t.commonInfo,!1)):t._e()],1)],1),o("Divider"),o("div",{staticStyle:{padding:"1px 1px",height:"100px","margin-top":"75px"}},[o("div",[t.currentStep>0?o("Button",{staticStyle:{position:"absolute",left:"465px"},attrs:{type:"primary"},on:{click:t.prev}},[t._v(" 上一步 ")]):t._e(),t.currentStep<5?o("Button",{staticStyle:{position:"absolute",left:"790px"},attrs:{type:"primary"},on:{click:t.next}},[t._v(" 下一步 ")]):t._e()],1)])],1)],1)],2)],1)},i=[],r=(o("fb6a"),o("a9e3"),o("2909")),l=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("Card",{attrs:{"dis-hover":""}},[o("Form",{ref:"rowsFilterConfig",staticStyle:{"margin-top":"10px"},attrs:{model:t.rowsFilterConfig,"label-width":100}},[o("FormItem",{attrs:{label:"库名"}},[o("Input",{staticStyle:{width:"200px"},attrs:{disabled:""},model:{value:this.dbName,callback:function(e){t.$set(this,"dbName",e)},expression:"this.dbName"}})],1),o("FormItem",{attrs:{label:"表名"}},[o("Input",{staticStyle:{width:"200px"},attrs:{disabled:""},model:{value:this.tableName,callback:function(e){t.$set(this,"tableName",e)},expression:"this.tableName"}})],1),o("FormItem",{attrs:{label:"模式"}},[o("Select",{staticStyle:{width:"200px"},attrs:{placeholder:"选择行过滤模式"},model:{value:t.rowsFilterConfig.mode,callback:function(e){t.$set(t.rowsFilterConfig,"mode",e)},expression:"rowsFilterConfig.mode"}},t._l(t.modes,(function(e){return o("Option",{key:e.mode,attrs:{value:e.mode}},[t._v(t._s(e.name))])})),1)],1),1!==t.rowsFilterConfig.mode||0===t.rowsFilterConfig.fetchMode?o("FormItem",{attrs:{label:"规则内容"}},[1!==t.rowsFilterConfig.mode?o("Input",{staticStyle:{width:"250px"},attrs:{type:"textarea",placeholder:"请输入行过滤内容"},model:{value:t.rowsFilterConfig.context,callback:function(e){t.$set(t.rowsFilterConfig,"context",e)},expression:"rowsFilterConfig.context"}}):t._e(),1===t.rowsFilterConfig.mode&&0===t.rowsFilterConfig.fetchMode?o("Select",{staticStyle:{width:"200px"},attrs:{multiple:"",placeholder:"Region 选择"},model:{value:t.configInTripUid.regionsChosen,callback:function(e){t.$set(t.configInTripUid,"regionsChosen",e)},expression:"configInTripUid.regionsChosen"}},t._l(t.regionsForChose,(function(e){return o("Option",{key:e,attrs:{value:e}},[t._v(t._s(e))])})),1):t._e()],1):t._e(),1===t.rowsFilterConfig.mode?o("FormItem",{attrs:{label:"空处理"}},[o("Checkbox",{model:{value:t.rowsFilterConfig.illegalArgument,callback:function(e){t.$set(t.rowsFilterConfig,"illegalArgument",e)},expression:"rowsFilterConfig.illegalArgument"}},[t._v("【字段为空时】同步")])],1):t._e(),1===t.rowsFilterConfig.mode?o("Divider",[t._v("UDL配置")]):t._e(),1===t.rowsFilterConfig.mode?o("FormItem",{attrs:{label:"UDL字段"}},[o("Select",{staticStyle:{width:"200px"},attrs:{filterable:"","allow-create":"",multiple:"",placeholder:"不选默认则无UDL配置"},model:{value:t.rowsFilterConfig.udlColumns,callback:function(e){t.$set(t.rowsFilterConfig,"udlColumns",e)},expression:"rowsFilterConfig.udlColumns"}},t._l(t.columnsForChose,(function(e){return o("Option",{key:e,attrs:{value:e}},[t._v(t._s(e))])})),1)],1):t._e(),1===t.rowsFilterConfig.mode&&0!==t.rowsFilterConfig.udlColumns.length?o("FormItem",{attrs:{label:"DRC UDL策略id"}},[o("Select",{staticStyle:{width:"200px"},attrs:{filterable:"","allow-create":"",placeholder:"请选择ucs策略id"},model:{value:t.rowsFilterConfig.drcStrategyId,callback:function(e){t.$set(t.rowsFilterConfig,"drcStrategyId",e)},expression:"rowsFilterConfig.drcStrategyId"}},t._l(t.drcStrategyIdsForChose,(function(e){return o("Option",{key:e,attrs:{value:e}},[t._v(t._s(e))])})),1)],1):t._e(),1===t.rowsFilterConfig.mode?o("Divider",[t._v("UID配置")]):t._e(),1!==t.rowsFilterConfig.mode?o("FormItem",{attrs:{label:"相关字段"}},[o("Select",{staticStyle:{width:"200px"},attrs:{filterable:"","allow-create":"",multiple:"",placeholder:"选择相关字段"},model:{value:t.rowsFilterConfig.columns,callback:function(e){t.$set(t.rowsFilterConfig,"columns",e)},expression:"rowsFilterConfig.columns"}},t._l(t.columnsForChose,(function(t){return o("Option",{key:t,attrs:{value:t,lable:t}})})),1)],1):t._e(),1===t.rowsFilterConfig.mode?o("FormItem",{attrs:{label:"UID字段"}},[o("Select",{staticStyle:{width:"200px"},attrs:{filterable:"","allow-create":"",multiple:"",placeholder:"不选默认则无UID配置"},model:{value:t.rowsFilterConfig.columns,callback:function(e){t.$set(t.rowsFilterConfig,"columns",e)},expression:"rowsFilterConfig.columns"}},t._l(t.columnsForChose,(function(e){return o("Option",{key:e,attrs:{value:e}},[t._v(t._s(e))])})),1)],1):t._e(),1===t.rowsFilterConfig.mode?o("FormItem",{attrs:{label:"fetchMode"}},[o("Select",{staticStyle:{width:"200px"},attrs:{placeholder:"选择"},on:{"on-change":function(e){return t.fetchModeChange()}},model:{value:t.rowsFilterConfig.fetchMode,callback:function(e){t.$set(t.rowsFilterConfig,"fetchMode",e)},expression:"rowsFilterConfig.fetchMode"}},t._l(t.fetchModeForChose,(function(e){return o("Option",{key:e.k,attrs:{value:e.v}},[t._v(t._s(e.k))])})),1)],1):t._e(),o("FormItem",[o("Row",[o("Col",{attrs:{span:"10"}},[o("Button",{staticStyle:{"margin-left":"10px"},attrs:{type:"error"},on:{click:t.deleteConfig}},[t._v("删除")])],1),o("Col",{attrs:{span:"8"}},[o("Button",{attrs:{type:"primary"},on:{click:t.submitConfig}},[t._v("保存")])],1)],1)],1)],1)],1)],1)},s=[],a=(o("a15b"),o("ac1f"),o("1276"),{name:"rowsFilterV2",props:{srcMhaName:String,dstMhaName:String,srcDc:String,destDc:String,dbName:String,tableName:String,dbReplicationId:Number,dbReplicationIds:[],update:Number},data:function(){return{rowsFilterConfig:{mode:1,drcStrategyId:0,routeStrategyId:0,udlColumns:[],columns:[],context:"",illegalArgument:!1,fetchMode:0},configInTripUid:{regionsChosen:[]},modes:[{name:"trip_udl",mode:1},{name:"java_regex",mode:0},{name:"aviator_regex",mode:3},{name:"custom",mode:4}],columnsForChose:[],regionsForChose:["SIN","SH","FRA"],drcStrategyIdsForChose:[2000000002,20001],fetchModeForChose:[{k:"RPC调用",v:0},{k:"BlackList",v:1},{k:"WhiteList",v:2},{k:"BlackListGlobal",v:3}]}},methods:{selectMode:function(){1===this.rowsFilterConfig.mode&&(this.rowsFilterConfig={mode:1,drcStrategyId:0,routeStrategyId:0,udlColumns:[],columns:[],context:"",illegalArgument:!1,fetchMode:0},this.configInTripUid={regionsChosen:[]})},submitConfig:function(){var t=this;if(console.log(this.rowsFilterConfig),1===this.rowsFilterConfig.mode){if(0===this.rowsFilterConfig.columns.length&&0===this.rowsFilterConfig.udlColumns.length)return void alert("uid 与 uld字段不能同时为空！");if(1===this.rowsFilterConfig.fetchMode||2===this.rowsFilterConfig.fetchMode||3===this.rowsFilterConfig.fetchMode?this.rowsFilterConfig.context="//filter by config":this.rowsFilterConfig.context=this.configInTripUid.regionsChosen.join(","),0===this.rowsFilterConfig.fetchMode&&(""===this.rowsFilterConfig.context||void 0===this.rowsFilterConfig.context||"//filter by config"===this.rowsFilterConfig.context))return void alert("context 不能为空！")}if(""===this.rowsFilterConfig.mode||void 0===this.rowsFilterConfig.mode||0===this.rowsFilterConfig.columns.length&&0===this.rowsFilterConfig.udlColumns.length)alert("缺少行过滤配置 禁止提交");else{var e={dbReplicationIds:this.dbReplicationIds,dbName:this.dbName,tableName:this.tableName,mode:this.rowsFilterConfig.mode,columns:0===this.rowsFilterConfig.columns.length?null:this.rowsFilterConfig.columns,udlColumns:0===this.rowsFilterConfig.udlColumns.length?null:this.rowsFilterConfig.udlColumns,drcStrategyId:0===this.rowsFilterConfig.udlColumns.length?null:this.rowsFilterConfig.drcStrategyId,routeStrategyId:this.rowsFilterConfig.routeStrategyId,illegalArgument:this.rowsFilterConfig.illegalArgument,fetchMode:this.rowsFilterConfig.fetchMode,context:""===this.rowsFilterConfig.context?null:this.rowsFilterConfig.context};this.axios.post("/api/drc/v2/config/rowsFilter",e).then((function(e){1===e.data.status?window.alert("提交失败!"):(window.alert("提交成功!"),t.getConfig())}))}},getConfig:function(){var t=this;console.log(this.dbReplicationId),this.axios.get("/api/drc/v2/config/rowsFilter?dbReplicationId="+this.dbReplicationId).then((function(e){if(1===e.data.status)alert("查询行过滤配置失败!");else{var o=e.data.data;null==o||(t.rowsFilterConfig.context=o.context,1===o.mode?t.configInTripUid.regionsChosen=o.context.split(","):t.configInTripUid={regionsChosen:[]},t.rowsFilterConfig.mode=o.mode,t.rowsFilterConfig.columns=o.columns,0!==o.udlColumns.length&&(t.rowsFilterConfig.udlColumns=o.udlColumns),t.rowsFilterConfig.drcStrategyId=0===o.drcStrategyId?null:o.drcStrategyId,t.rowsFilterConfig.routeStrategyId=o.routeStrategyId,t.rowsFilterConfig.illegalArgument=o.illegalArgument,t.rowsFilterConfig.fetchMode=o.fetchMode)}}))},getCommonColumns:function(){var t=this;this.axios.get("/api/drc/v2/mysql/commonColumns?&mhaName="+this.srcMhaName+"&namespace="+this.dbName+"&name="+this.tableName).then((function(e){1===e.data.status?(alert("查询公共列名失败，请手动添加！"),t.columnsForChose=[]):(console.log(e.data.data),t.columnsForChose=e.data.data,0===t.columnsForChose.length&&alert("查询无公共字段！"))}))},fetchModeChange:function(){1===this.rowsFilterConfig.fetchMode||3===this.rowsFilterConfig.fetchMode?this.rowsFilterConfig.illegalArgument=!0:this.rowsFilterConfig.illegalArgument=!1}},created:function(){this.getConfig(),this.getCommonColumns()}}),c=a,u=o("2877"),m=Object(u["a"])(c,l,s,!1,null,"54cc78f2",null),d=m.exports,f=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("Card",{attrs:{"dis-hover":""}},[o("div",{attrs:{slot:"title"},slot:"title"},[o("span",[t._v("字段过滤配置")])]),o("Form",{ref:"columnsFilterConfig",staticStyle:{"margin-top":"10px"},attrs:{model:t.columnsFilterConfig,"label-width":100}},[o("FormItem",{attrs:{label:"库名"}},[o("Input",{staticStyle:{width:"200px"},attrs:{disabled:""},model:{value:this.dbName,callback:function(e){t.$set(this,"dbName",e)},expression:"this.dbName"}})],1),o("FormItem",{attrs:{label:"表名"}},[o("Input",{staticStyle:{width:"200px"},attrs:{disabled:""},model:{value:this.tableName,callback:function(e){t.$set(this,"tableName",e)},expression:"this.tableName"}})],1),o("FormItem",{attrs:{label:"模式"}},[o("Select",{staticStyle:{width:"200px"},attrs:{placeholder:"选择字段过滤模式"},model:{value:t.columnsFilterConfig.mode,callback:function(e){t.$set(t.columnsFilterConfig,"mode",e)},expression:"columnsFilterConfig.mode"}},t._l(t.modes,(function(e){return o("Option",{key:e.mode,attrs:{value:e.mode}},[t._v(t._s(e.name))])})),1)],1),o("FormItem",{attrs:{label:"字段"}},[o("Select",{staticStyle:{width:"200px"},attrs:{filterable:"","allow-create":"",multiple:"",placeholder:"选择相关的字段"},on:{"on-create":t.handleCreateColumn},model:{value:t.columnsFilterConfig.columns,callback:function(e){t.$set(t.columnsFilterConfig,"columns",e)},expression:"columnsFilterConfig.columns"}},t._l(t.columnsForChose,(function(e){return o("Option",{key:e,attrs:{value:e}},[t._v(t._s(e))])})),1)],1),o("FormItem",[o("Row",[o("Col",{attrs:{span:"10"}},[o("Button",{staticStyle:{"margin-left":"10px"},attrs:{type:"error"},on:{click:t.deleteConfig}},[t._v("删除")])],1),o("Col",{attrs:{span:"8"}},[o("Button",{attrs:{type:"primary"},on:{click:function(e){return t.handleSubmit("tableInfo")}}},[t._v("保存")])],1)],1)],1)],1)],1)],1)},h=[],g={name:"columnsFilterV2",props:{srcMhaName:String,dstMhaName:String,srcDc:String,destDc:String,dbName:String,tableName:String,test:String,dbReplicationId:Number,dbReplicationIds:[]},data:function(){return{columnsFilterConfig:{mode:Number,columns:[]},modes:[{name:"exclude",mode:0},{name:"include",mode:1},{name:"regex",mode:2}],columnsForChose:[]}},methods:{handleSubmit:function(){this.submitConfig()},submitConfig:function(){this.axios.post("/api/drc/v2/config/columnsFilter",{dbReplicationIds:this.dbReplicationIds,mode:this.columnsFilterConfig.mode,columns:this.columnsFilterConfig.columns}).then((function(t){1===t.data.status?alert("提交失败!"):alert("提交成功！")}))},deleteConfig:function(){},getConfig:function(){var t=this;console.log(this.dbReplicationId),this.axios.get("/api/drc/v2/config/columnsFilter?dbReplicationId="+this.dbReplicationId).then((function(e){if(1===e.data.status)alert("查询字段过滤配置失败!");else{var o=e.data.data;null==o||(t.columnsFilterConfig.mode=o.mode,t.columnsFilterConfig.columns=o.columns)}}))},getCommonColumns:function(){var t=this;this.axios.get("/api/drc/v2/mysql/commonColumns?&mhaName="+this.srcMhaName+"&namespace="+this.dbName+"&name="+this.tableName).then((function(e){1===e.data.status?alert("查询公共列名失败，请手动添加！"+e.data.data):(console.log(e.data.data),t.columnsForChose=e.data.data,0===t.columnsForChose.length&&alert("查询无公共字段！"))}))},handleCreateColumn:function(t){this.contains(this.columnsForChose,t)?alert("已有项禁止创建"):""!==t&&void 0!==t&&null!==t?this.columnsForChose.push(t):alert("字段不能为空")},contains:function(t,e){var o=t.length;while(o--)if(t[o]===e)return!0;return!1}},created:function(){this.getConfig(),this.getCommonColumns()}},p=g,C=Object(u["a"])(p,f,h,!1,null,"049803ec",null),b=C.exports,v=o("62f8"),F={name:"dbReplicationConfig",components:{rowsFilterV2:d,columnsFilterV2:b,complete:v["a"]},data:function(){return{currentStep:0,update:1,commonInfo:{srcMhaName:"",srcMhaId:0,dstMhaName:"",srcDc:"",dstDc:"",order:!0,dbReplicationIds:[],dbReplicationId:0,dbName:"",tableName:"",tableData:[]},ruleInline:{dbName:[{required:!0,message:"Please fill in the schema",trigger:"blur"}],tableName:[{required:!0,message:"Please fill in the table.",trigger:"blur"}]},nameFilterCheck:{columns:[{title:"序号",width:75,align:"center",fixed:"left",render:function(t,e){return t("span",e.index+1)}},{title:"库名",key:"schema",resizable:!0},{title:"表名",key:"table",resizable:!0},{title:"结果",align:"center",render:function(t,e){var o=e.row,n="ok"!==o.res?"volcano":"green",i=o.res;return t("Tag",{props:{color:n}},i)}}],total:0,current:1,size:5,pageSizeOpts:[5,10,20,100]}}},methods:{jumpTo:function(t){this.currentStep=t},next:function(){this.currentStep=this.currentStep+1},prev:function(){this.currentStep=this.currentStep-1},handleSubmit:function(){this.commonInfo.dataMediaId,this.submitConfig()},submitConfig:function(){var t=this;console.log(this.commonInfo),this.axios.post("/api/drc/v2/config/dbReplication",{srcMhaName:this.commonInfo.srcMhaName,dstMhaName:this.commonInfo.dstMhaName,dbName:this.commonInfo.dbName,tableName:this.commonInfo.tableName}).then((function(e){1===e.data.status?alert("提交失败!"):(t.commonInfo.dbReplicationIds=e.data.data,alert("提交成功！"))}))},checkMysqlTablesInSrcMha:function(){this.checkMySqlTables(this.commonInfo.srcMhaName,this.commonInfo.dbName+"\\."+this.commonInfo.tableName)},checkMySqlTables:function(t,e){var o=this;console.log("nameFilter:"+e),null==e&&(e=""),this.$Spin.show({render:function(t){return t("div",[t("Icon",{class:"demo-spin-icon-load",props:{size:18}}),t("div","检测中，请稍等...")])}}),setTimeout((function(){o.$Spin.hide()}),8e4),this.axios.get("/api/drc/v2/mysql/preCheckMySqlTables?mha="+t+"&nameFilter="+e).then((function(t){o.commonInfo.tableData=t.data.data,o.$Spin.hide()}))},handleChangeSize:function(t){this.size=t}},computed:{dataWithPage:function(){var t=this.commonInfo.tableData,e=this.nameFilterCheck.current*this.nameFilterCheck.size-this.nameFilterCheck.size,o=e+this.nameFilterCheck.size;return Object(r["a"])(t).slice(e,o)}},created:function(){var t=this.$route.query.step;null==t?console.log("curStep is null, do nothing"):this.jumpTo(Number(t)),this.commonInfo={srcMhaName:this.$route.query.srcMhaName,srcMhaId:this.$route.query.srcMhaId,dstMhaName:this.$route.query.dstMhaName,srcDc:this.$route.query.srcDc,dstDc:this.$route.query.dstDc,order:this.$route.query.order,dbName:this.$route.query.dbName,tableName:this.$route.query.tableName,dbReplicationId:this.$route.query.dbReplicationId,dbReplicationIds:[],tableData:[]},this.commonInfo.dbReplicationIds.push(this.$route.query.dbReplicationId),""!==this.commonInfo.dbName&&""!==this.commonInfo.tableName&&this.checkMysqlTablesInSrcMha(),console.log("commonInfo"),console.log(this.commonInfo)}},I=F,x=Object(u["a"])(I,n,i,!1,null,"20fe57a4",null);e["default"]=x.exports},"44e7":function(t,e,o){var n=o("861d"),i=o("c6b6"),r=o("b622"),l=r("match");t.exports=function(t){var e;return n(t)&&(void 0!==(e=t[l])?!!e:"RegExp"==i(t))}},"8aa5":function(t,e,o){"use strict";var n=o("6547").charAt;t.exports=function(t,e,o){return e+(o?n(t,e).length:1)}},9263:function(t,e,o){"use strict";var n=o("ad6d"),i=o("9f7f"),r=RegExp.prototype.exec,l=String.prototype.replace,s=r,a=function(){var t=/a/,e=/b*/g;return r.call(t,"a"),r.call(e,"a"),0!==t.lastIndex||0!==e.lastIndex}(),c=i.UNSUPPORTED_Y||i.BROKEN_CARET,u=void 0!==/()??/.exec("")[1],m=a||u||c;m&&(s=function(t){var e,o,i,s,m=this,d=c&&m.sticky,f=n.call(m),h=m.source,g=0,p=t;return d&&(f=f.replace("y",""),-1===f.indexOf("g")&&(f+="g"),p=String(t).slice(m.lastIndex),m.lastIndex>0&&(!m.multiline||m.multiline&&"\n"!==t[m.lastIndex-1])&&(h="(?: "+h+")",p=" "+p,g++),o=new RegExp("^(?:"+h+")",f)),u&&(o=new RegExp("^"+h+"$(?!\\s)",f)),a&&(e=m.lastIndex),i=r.call(d?o:m,p),d?i?(i.input=i.input.slice(g),i[0]=i[0].slice(g),i.index=m.lastIndex,m.lastIndex+=i[0].length):m.lastIndex=0:a&&i&&(m.lastIndex=m.global?i.index+i[0].length:e),u&&i&&i.length>1&&l.call(i[0],o,(function(){for(s=1;s<arguments.length-2;s++)void 0===arguments[s]&&(i[s]=void 0)})),i}),t.exports=s},"9f7f":function(t,e,o){"use strict";var n=o("d039");function i(t,e){return RegExp(t,e)}e.UNSUPPORTED_Y=n((function(){var t=i("a","y");return t.lastIndex=2,null!=t.exec("abcd")})),e.BROKEN_CARET=n((function(){var t=i("^r","gy");return t.lastIndex=2,null!=t.exec("str")}))},a15b:function(t,e,o){"use strict";var n=o("23e7"),i=o("44ad"),r=o("fc6a"),l=o("a640"),s=[].join,a=i!=Object,c=l("join",",");n({target:"Array",proto:!0,forced:a||!c},{join:function(t){return s.call(r(this),void 0===t?",":t)}})},a640:function(t,e,o){"use strict";var n=o("d039");t.exports=function(t,e){var o=[][t];return!!o&&n((function(){o.call(null,e||function(){throw 1},1)}))}},ac1f:function(t,e,o){"use strict";var n=o("23e7"),i=o("9263");n({target:"RegExp",proto:!0,forced:/./.exec!==i},{exec:i})},d784:function(t,e,o){"use strict";o("ac1f");var n=o("6eeb"),i=o("d039"),r=o("b622"),l=o("9263"),s=o("9112"),a=r("species"),c=!i((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")})),u=function(){return"$0"==="a".replace(/./,"$0")}(),m=r("replace"),d=function(){return!!/./[m]&&""===/./[m]("a","$0")}(),f=!i((function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var o="ab".split(t);return 2!==o.length||"a"!==o[0]||"b"!==o[1]}));t.exports=function(t,e,o,m){var h=r(t),g=!i((function(){var e={};return e[h]=function(){return 7},7!=""[t](e)})),p=g&&!i((function(){var e=!1,o=/a/;return"split"===t&&(o={},o.constructor={},o.constructor[a]=function(){return o},o.flags="",o[h]=/./[h]),o.exec=function(){return e=!0,null},o[h](""),!e}));if(!g||!p||"replace"===t&&(!c||!u||d)||"split"===t&&!f){var C=/./[h],b=o(h,""[t],(function(t,e,o,n,i){return e.exec===l?g&&!i?{done:!0,value:C.call(e,o,n)}:{done:!0,value:t.call(o,e,n)}:{done:!1}}),{REPLACE_KEEPS_$0:u,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:d}),v=b[0],F=b[1];n(String.prototype,t,v),n(RegExp.prototype,h,2==e?function(t,e){return F.call(t,this,e)}:function(t){return F.call(t,this)})}m&&s(RegExp.prototype[h],"sham",!0)}}}]);
//# sourceMappingURL=chunk-0ff35ab2.6a7cd7a0.js.map