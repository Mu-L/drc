(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-cc1de8ba"],{"0c47":function(e,t,r){var a=r("da84"),n=r("d44e");n(a.JSON,"JSON",!0)},"131a":function(e,t,r){var a=r("23e7"),n=r("d2bb");a({target:"Object",stat:!0},{setPrototypeOf:n})},"14c3":function(e,t,r){var a=r("c6b6"),n=r("9263");e.exports=function(e,t){var r=e.exec;if("function"===typeof r){var o=r.call(e,t);if("object"!==typeof o)throw TypeError("RegExp exec method returned something other than an Object or null");return o}if("RegExp"!==a(e))throw TypeError("RegExp#exec called on incompatible receiver");return n.call(e,t)}},"159b":function(e,t,r){var a=r("da84"),n=r("fdbc"),o=r("17c2"),i=r("9112");for(var s in n){var l=a[s],c=l&&l.prototype;if(c&&c.forEach!==o)try{i(c,"forEach",o)}catch(u){c.forEach=o}}},"17c2":function(e,t,r){"use strict";var a=r("b727").forEach,n=r("a640"),o=r("ae40"),i=n("forEach"),s=o("forEach");e.exports=i&&s?[].forEach:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}},"1da1":function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));r("d3b7"),r("e6cf");function a(e,t,r,a,n,o,i){try{var s=e[o](i),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(a,n)}function n(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function s(e){a(i,n,o,s,l,"next",e)}function l(e){a(i,n,o,s,l,"throw",e)}s(void 0)}))}}},"23dc":function(e,t,r){var a=r("d44e");a(Math,"Math",!0)},3410:function(e,t,r){var a=r("23e7"),n=r("d039"),o=r("7b0b"),i=r("e163"),s=r("e177"),l=n((function(){i(1)}));a({target:"Object",stat:!0,forced:l,sham:!s},{getPrototypeOf:function(e){return i(o(e))}})},5319:function(e,t,r){"use strict";var a=r("d784"),n=r("825a"),o=r("7b0b"),i=r("50c4"),s=r("a691"),l=r("1d80"),c=r("8aa5"),u=r("14c3"),d=Math.max,f=Math.min,h=Math.floor,g=/\$([$&'`]|\d\d?|<[^>]*>)/g,m=/\$([$&'`]|\d\d?)/g,p=function(e){return void 0===e?e:String(e)};a("replace",2,(function(e,t,r,a){var v=a.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,y=a.REPLACE_KEEPS_$0,b=v?"$":"$0";return[function(r,a){var n=l(this),o=void 0==r?void 0:r[e];return void 0!==o?o.call(r,n,a):t.call(String(n),r,a)},function(e,a){if(!v&&y||"string"===typeof a&&-1===a.indexOf(b)){var o=r(t,e,this,a);if(o.done)return o.value}var l=n(e),h=String(this),g="function"===typeof a;g||(a=String(a));var m=l.global;if(m){var q=l.unicode;l.lastIndex=0}var R=[];while(1){var x=u(l,h);if(null===x)break;if(R.push(x),!m)break;var P=String(x[0]);""===P&&(l.lastIndex=c(h,i(l.lastIndex),q))}for(var E="",S=0,T=0;T<R.length;T++){x=R[T];for(var _=String(x[0]),L=d(f(s(x.index),h.length),0),D=[],k=1;k<x.length;k++)D.push(p(x[k]));var N=x.groups;if(g){var I=[_].concat(D,L,h);void 0!==N&&I.push(N);var $=String(a.apply(void 0,I))}else $=w(_,h,L,D,N,a);L>=S&&(E+=h.slice(S,L)+$,S=L+_.length)}return E+h.slice(S)}];function w(e,r,a,n,i,s){var l=a+e.length,c=n.length,u=m;return void 0!==i&&(i=o(i),u=g),t.call(s,u,(function(t,o){var s;switch(o.charAt(0)){case"$":return"$";case"&":return e;case"`":return r.slice(0,a);case"'":return r.slice(l);case"<":s=i[o.slice(1,-1)];break;default:var u=+o;if(0===u)return t;if(u>c){var d=h(u/10);return 0===d?t:d<=c?void 0===n[d-1]?o.charAt(1):n[d-1]+o.charAt(1):t}s=n[u-1]}return void 0===s?"":s}))}}))},"53ca":function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));r("a4d3"),r("e01a"),r("d28b"),r("e260"),r("d3b7"),r("3ca3"),r("ddb0");function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,r){var a=r("1d80"),n=r("5899"),o="["+n+"]",i=RegExp("^"+o+o+"*"),s=RegExp(o+o+"*$"),l=function(e){return function(t){var r=String(a(t));return 1&e&&(r=r.replace(i,"")),2&e&&(r=r.replace(s,"")),r}};e.exports={start:l(1),end:l(2),trim:l(3)}},"61b1":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{padding:"1px 1px"}},[r("Row",{attrs:{gutter:10,align:"middle"}},[r("Col",{attrs:{span:"20"}},[r("Card",{attrs:{padding:5},scopedSlots:e._u([{key:"title",fn:function(){return[e._v("查询条件")]},proxy:!0}])},[r("Row",{directives:[{name:"show",rawName:"v-show",value:!e.searchMode,expression:"!searchMode"}],attrs:{gutter:10}},[r("Col",{attrs:{span:"2"}},[r("Select",{attrs:{filterable:"",clearable:"",placeholder:"源region"},model:{value:e.queryParam.srcRegion,callback:function(t){e.$set(e.queryParam,"srcRegion",t)},expression:"queryParam.srcRegion"}},e._l(e.regions,(function(t){return r("Option",{key:t.regionName,attrs:{value:t.regionName}},[e._v(" "+e._s(t.regionName)+" ")])})),1)],1),r("Col",{attrs:{span:"2"}},[r("Select",{attrs:{filterable:"",clearable:"",placeholder:"目标region"},model:{value:e.queryParam.dstRegion,callback:function(t){e.$set(e.queryParam,"dstRegion",t)},expression:"queryParam.dstRegion"}},e._l(e.regions,(function(t){return r("Option",{key:t.regionName,attrs:{value:t.regionName}},[e._v(" "+e._s(t.regionName)+" ")])})),1)],1),r("Col",{attrs:{span:"4"}},[r("Input",{attrs:{prefix:"ios-search",placeholder:"库名"},model:{value:e.queryParam.dbName,callback:function(t){e.$set(e.queryParam,"dbName",t)},expression:"queryParam.dbName"}})],1),r("Col",{attrs:{span:"4"}},[r("Input",{attrs:{prefix:"ios-search",placeholder:"表名"},model:{value:e.queryParam.tableName,callback:function(t){e.$set(e.queryParam,"tableName",t)},expression:"queryParam.tableName"}})],1),r("Col",{attrs:{span:"4"}},[r("DatePicker",{attrs:{transfer:!0,type:"datetime",editable:e.editable,clearable:!1,placeholder:"起始日期"},model:{value:e.queryParam.beginHandleTime,callback:function(t){e.$set(e.queryParam,"beginHandleTime",t)},expression:"queryParam.beginHandleTime"}})],1),r("Col",{attrs:{span:"4"}},[r("DatePicker",{attrs:{transfer:!0,type:"datetime",editable:e.editable,confirm:!1,clearable:!1,placeholder:"结束日期"},model:{value:e.queryParam.endHandleTime,callback:function(t){e.$set(e.queryParam,"endHandleTime",t)},expression:"queryParam.endHandleTime"}})],1),r("Col",{attrs:{span:"2"}},[r("Select",{attrs:{filterable:"",clearable:"",placeholder:"日志情况"},model:{value:e.queryParam.brief,callback:function(t){e.$set(e.queryParam,"brief",t)},expression:"queryParam.brief"}},e._l(e.briefOpts,(function(t){return r("Option",{key:t.val,attrs:{value:t.val}},[e._v(e._s(t.name))])})),1)],1),r("Col",{attrs:{span:"2"}},[r("Select",{attrs:{filterable:"",clearable:"",placeholder:"执行结果"},model:{value:e.queryParam.rowResult,callback:function(t){e.$set(e.queryParam,"rowResult",t)},expression:"queryParam.rowResult"}},e._l(e.resultOpts,(function(t){return r("Option",{key:t.val,attrs:{value:t.val}},[e._v(e._s(t.name))])})),1)],1)],1),r("Row",{directives:[{name:"show",rawName:"v-show",value:e.searchMode,expression:"searchMode"}],attrs:{gutter:10}},[r("Col",{attrs:{span:"12"}},[r("Input",{attrs:{prefix:"ios-search",placeholder:"事务id"},model:{value:e.queryParam.gtid,callback:function(t){e.$set(e.queryParam,"gtid",t)},expression:"queryParam.gtid"}})],1),r("Col",{attrs:{span:"4"}},[r("DatePicker",{attrs:{type:"datetime",editable:e.editable,clearable:!1,placeholder:"起始日期"},model:{value:e.queryParam.beginHandleTime,callback:function(t){e.$set(e.queryParam,"beginHandleTime",t)},expression:"queryParam.beginHandleTime"}})],1),r("Col",{attrs:{span:"4"}},[r("DatePicker",{attrs:{type:"datetime",editable:e.editable,clearable:!1,placeholder:"结束日期"},model:{value:e.queryParam.endHandleTime,callback:function(t){e.$set(e.queryParam,"endHandleTime",t)},expression:"queryParam.endHandleTime"}})],1),r("Col",{attrs:{span:"4"}},[r("Select",{attrs:{filterable:"",clearable:"",placeholder:"执行结果"},model:{value:e.queryParam.rowResult,callback:function(t){e.$set(e.queryParam,"rowResult",t)},expression:"queryParam.rowResult"}},e._l(e.resultOpts,(function(t){return r("Option",{key:t.val,attrs:{value:t.val}},[e._v(e._s(t.name))])})),1)],1)],1)],1)],1),r("Col",{attrs:{span:"4"}},[r("Row",{attrs:{gutter:10,align:"middle"}},[r("Button",{attrs:{type:"primary",icon:"ios-search",loading:e.dataLoading},on:{click:e.getTotalData}},[e._v("查询")]),r("i-switch",{staticStyle:{"margin-left":"10px"},attrs:{size:"large"},scopedSlots:e._u([{key:"open",fn:function(){return[r("span",[e._v("模糊匹配")])]},proxy:!0},{key:"close",fn:function(){return[r("span",[e._v("精确匹配")])]},proxy:!0}]),model:{value:e.queryParam.likeSearch,callback:function(t){e.$set(e.queryParam,"likeSearch",t)},expression:"queryParam.likeSearch"}},[e._v("模糊匹配 ")])],1),r("Row",{staticStyle:{"margin-top":"20px"},attrs:{gutter:10,align:"middle"}},[r("Button",{attrs:{icon:"md-refresh"},on:{click:e.resetParam}},[e._v("重置")]),r("i-switch",{staticStyle:{"margin-left":"10px"},attrs:{size:"large"},on:{"on-change":e.searchModeChange},scopedSlots:e._u([{key:"open",fn:function(){return[r("span",[e._v("进阶")])]},proxy:!0},{key:"close",fn:function(){return[r("span",[e._v("进阶")])]},proxy:!0}]),model:{value:e.searchMode,callback:function(t){e.searchMode=t},expression:"searchMode"}},[e._v("进阶 ")])],1)],1)],1),r("br"),r("Row",{staticStyle:{background:"#fdfdff",border:"1px solid #e8eaec"}},[r("Col",{staticStyle:{display:"flex",float:"left",margin:"5px"},attrs:{span:"2"}},[r("Dropdown",{attrs:{placement:"bottom-start"},scopedSlots:e._u([{key:"list",fn:function(){return[r("DropdownMenu",[r("DropdownItem",{nativeOn:{click:function(t){return e.compareRecords.apply(null,arguments)}}},[e._v("数据比对")]),r("DropdownItem",{nativeOn:{click:function(t){return e.getLogDetails.apply(null,arguments)}}},[e._v("冲突行详情")])],1)]},proxy:!0}])},[r("Button",{attrs:{type:"default",icon:"ios-hammer"}},[e._v(" 批量操作 "),r("Icon",{attrs:{type:"ios-arrow-down"}})],1)],1)],1),r("Col",{staticStyle:{display:"flex",float:"left",margin:"5px"},attrs:{span:"2"}},[r("Button",{attrs:{type:"default",icon:"md-create"},on:{click:e.dbBlacklist}},[e._v(" 冲突黑名单 ")])],1)],1),r("Table",{ref:"multipleTable",attrs:{border:"",columns:e.columns,data:e.tableData},on:{"on-selection-change":e.changeSelection},scopedSlots:e._u([{key:"action",fn:function(t){var a=t.row,n=t.index;return[r("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"primary",size:"small"},on:{click:function(t){return e.getLogDetail1(a,n)}}},[e._v(" 详情 ")]),r("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"success",size:"small"},on:{click:function(t){return e.queryTrxLog(a,n)}}},[e._v(" 冲突事务 ")])]}}])}),r("div",{staticStyle:{"text-align":"center",margin:"16px 0"}},[e.countLoading?r("div",[e._v(" Total Loading... ")]):r("Page",{attrs:{transfer:!0,total:e.total,current:e.current,"page-size-opts":[10,20,50,100],"page-size":10,"show-total":"","show-sizer":"","show-elevator":""},on:{"update:current":function(t){e.current=t},"on-change":e.getData,"on-page-size-change":e.handleChangeSize}})],1),r("Modal",{attrs:{title:"冲突行详情",width:"1200px",scrollable:!0,draggable:!0},model:{value:e.detailModal,callback:function(t){e.detailModal=t},expression:"detailModal"}},[r("div",{style:{padding:"1px 1px",height:"100%"}},[r("Card",[r("div",{staticClass:"ivu-list-item-meta-title"},[e._v("冲突行提交结果： "),r("Button",{attrs:{loading:e.modalLoading,size:"small",type:0==e.logDetail.result?"success":"error"}},[e._v(" "+e._s(e.logDetail.resultStr)+" ")])],1),r("div",{staticClass:"ivu-list-item-meta-title"},[e._v("冲突行数据一致性比较结果： "),r("Tooltip",{attrs:{content:"数据一致性比对忽略字段过滤的列"}},[r("Button",{attrs:{loading:e.modalLoading,size:"small",type:1==e.logDetail.recordEqual?"success":"warning"}},[e._v(" "+e._s(e.logDetail.diffStr)+" ")])],1)],1),r("Divider"),r("div",{staticClass:"ivu-list-item-meta-title"},[e._v("源机房("+e._s(e.logDetail.srcRegion)+")")]),e._l(e.logDetail.srcRecords,(function(t,a){return r("Card",{key:a},[r("div",{staticClass:"ivu-list-item-meta-title"},[e._v("表名："+e._s(t.tableName)+" "),r("Tooltip",{attrs:{content:1==t.doubleSync?"双向同步":"单向同步"}},[r("Button",{attrs:{size:"small",type:1==t.doubleSync?"success":"primary"}},[e._v(" "+e._s(1==t.doubleSync?"双向同步":"单向同步")+" ")])],1)],1),r("Table",{attrs:{loading:e.modalLoading,size:"small",columns:t.columns,data:t.records,border:""}})],1)})),r("Divider"),r("div",{staticClass:"ivu-list-item-meta-title"},[e._v("目标机房("+e._s(e.logDetail.dstRegion)+")")]),e._l(e.logDetail.dstRecords,(function(t,a){return r("Card",{key:a},[r("div",{staticClass:"ivu-list-item-meta-title"},[e._v("表名："+e._s(t.tableName)+" "),r("Tooltip",{attrs:{content:1==t.doubleSync?"双向同步":"单向同步"}},[r("Button",{attrs:{size:"small",type:1==t.doubleSync?"success":"primary"}},[e._v(" "+e._s(1==t.doubleSync?"双向同步":"单向同步")+" ")])],1)],1),r("Table",{attrs:{loading:e.modalLoading,size:"small",columns:t.columns,data:t.records,border:""}})],1)})),r("Divider"),r("Card",[r("codemirror",{attrs:{options:e.options},model:{value:e.rowData,callback:function(t){e.rowData=t},expression:"rowData"}})],1)],2)],1)]),r("Modal",{attrs:{title:"数据一致性比对结果",width:"800px"},model:{value:e.compareModal,callback:function(t){e.compareModal=t},expression:"compareModal"}},[this.rowLogIds.length>0?r("div",{staticClass:"ivu-list-item-meta-title"},[e._v("存在数据比对不一致的冲突行，点击查询 "),r("Tooltip",{attrs:{content:"冲突行仅限当前页面"}},[r("Button",{attrs:{size:"middle",type:"success"},on:{click:e.getUnEqualRecords}},[e._v("冲突行")])],1)],1):e._e(),r("Table",{attrs:{stripe:"",border:"",loading:e.compareLoading,columns:e.compareData.columns,data:e.compareData.compareRowRecords}})],1)],1)},n=[],o=r("53ca"),i=r("c7eb"),s=r("1da1"),l=(r("d81d"),r("4ec9"),r("a9e3"),r("d3b7"),r("ac1f"),r("3ca3"),r("5319"),r("159b"),r("ddb0"),r("8f94")),c=(r("0f7c"),r("ffda"),{name:"conflictRowsLog",props:{gtid:String,beginHandleTime:String,endHandleTime:String,searchMode:Boolean},components:{codemirror:l["codemirror"]},data:function(){var e=this;return{compareModal:!1,multiData:[],detailModal:!1,compareEqualLoading:!1,modalLoading:!1,compareLoading:!1,rowLogIds:[],compareData:{compareRowRecords:[],columns:[{title:"表名",key:"tableName"},{title:"比对结果",key:"recordIsEqual",render:function(e,t){var r=t.row,a=r.recordIsEqual?"blue":"warning",n=r.recordIsEqual?"数据一致":"数据不一致";return e("Tag",{props:{color:a}},n)}}]},logDetail:{srcRecords:[],dstRecords:[],srcRegion:"",dstRegion:"",result:null,resultStr:"",hasDiff:null,recordEqual:null,diffStr:"",rowData:""},regions:[],editable:!1,dataLoading:!1,countLoading:!1,queryParam:{srcRegion:this.$route.query.srcRegion,dstRegion:this.$route.query.dstRegion,dbName:this.$route.query.dbName,tableName:this.$route.query.tableName,rowResult:this.$route.query.rowResult?Number(this.$route.query.rowResult):null,brief:this.$route.query.brief?Number(this.$route.query.brief):null,gtid:this.gtid,likeSearch:!0===this.$route.query.likeSearch||"true"===this.$route.query.likeSearch,beginHandleTime:this.$route.query.beginTime?new Date(Number(this.$route.query.beginTime)):this.beginHandleTime,endHandleTime:this.$route.query.endTime?new Date(Number(this.$route.query.endTime)):this.endHandleTime},tableData:[],columns:[{type:"selection",width:60,align:"center"},{title:"同步方向",key:"region",width:160,render:function(e,t){var r=t.row,a="blue",n=r.srcRegion+" -> "+r.dstRegion;return e("Tag",{props:{color:a}},n)}},{title:"表名",key:"tableName",width:250,tooltip:!0,render:function(e,t){var r=t.row,a=r.dbName+"."+r.tableName;return e("div",a)}},{title:"原始sql",key:"rawSql",tooltip:!0},{title:"冲突处理sql",key:"handleSql",tooltip:!0},{title:"提交时间",key:"handleTime",width:180,sortable:!0},{title:"执行结果",key:"rowResult",width:150,align:"center",render:function(e,t){var r=t.row,a=0===r.rowResult?"blue":"volcano",n=0===r.rowResult?"commit":"rollBack";return e("Tag",{props:{color:a}},n)}},{title:"数据是否一致",key:"recordIsEqual",width:150,align:"center",renderHeader:function(t,r){return t("span",[t("span","数据比对"),t("Button",{on:{click:function(){var t=Object(s["a"])(Object(i["a"])().mark((function t(){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.compareRecordEqual();case 2:case"end":return t.stop()}}),t)})));function r(){return t.apply(this,arguments)}return r}()},props:{loading:e.compareEqualLoading,size:"small",shape:"circle",type:"default",icon:"md-refresh"}})])},render:function(e,t){var r,a,n=t.row;return!0===n.recordIsEqual?(r="success",a="一致"):!1===n.recordIsEqual&&(r="warning",a="不一致"),e("Tag",{props:{color:r}},a)}},{title:"操作",slot:"action",width:165,align:"center"}],total:0,current:1,size:10,pageSizeOpts:[10,20,50,100],resultOpts:[{name:"commit",val:0},{name:"rollBack",val:1}],briefOpts:[{name:"有日志",val:0},{name:"无日志",val:1}],options:{value:"",mode:"text/x-mysql",theme:"ambiance",lineWrapping:!0,height:100,readOnly:!0,lineNumbers:!0}}},methods:{resetPath:function(){this.searchMode?this.$router.replace({query:{gtid:this.queryParam.gtid,rowResult:this.queryParam.rowResult,beginTime:new Date(this.queryParam.beginHandleTime).getTime(),endTime:new Date(this.queryParam.endHandleTime).getTime()}}):this.$router.replace({query:{srcRegion:this.queryParam.srcRegion,dstRegion:this.queryParam.dstRegion,dbName:this.queryParam.dbName,tableName:this.queryParam.tableName,rowResult:this.queryParam.rowResult,brief:this.queryParam.brief,likeSearch:this.queryParam.likeSearch,beginTime:new Date(this.queryParam.beginHandleTime).getTime(),endTime:new Date(this.queryParam.endHandleTime).getTime()}})},searchModeChange:function(){this.queryParam.gtid=null},compareRecordEqual:function(){var e=this,t=[];0!==this.tableData.length&&(this.tableData.forEach((function(e){return t.push(e.conflictRowsLogId)})),this.compareEqualLoading=!0,this.axios.get("/api/drc/v2/log/conflict/compare?conflictRowLogIds="+t).then((function(t){if(1===t.data.status)e.$Message.error({content:"数据比对失败! "+t.data.message,duration:5});else{var r=t.data.data,a=new Map(r.map((function(e){return[e.rowLogId,e.recordIsEqual]})));e.tableData.forEach((function(e){e.recordIsEqual=a.get(e.conflictRowsLogId)}))}})).finally((function(){e.compareEqualLoading=!1})))},compareRecords:function(){var e=this,t=this.multiData;if(void 0!==t&&null!==t&&0!==t.length){this.compareLoading=!0,this.compareModal=!0;var r=[];t.forEach((function(e){return r.push(e.conflictRowsLogId)})),this.axios.get("/api/drc/v2/log/conflict/records/compare?conflictRowLogIds="+r).then((function(t){if(1===t.data.status)e.compareData.compareRowRecords=[],e.$Message.error({content:"数据比对失败! "+t.data.message,duration:5});else{var r=t.data.data;e.compareData.compareRowRecords=r.recordDetailList,e.rowLogIds=[],r.rowLogIds.forEach((function(t){return e.rowLogIds.push(t)}))}})).finally((function(){e.compareLoading=!1}))}else this.$Message.warning("请勾选！")},getLogDetails:function(){var e=this,t=this.multiData;if(void 0!==t&&null!==t&&0!==t.length){var r=[],a=t[0];t.forEach((function(e){return r.push(e.conflictRowsLogId)})),this.axios.get("/api/drc/v2/log/conflict/rows/check?conflictRowLogIds="+r).then((function(t){if(1===t.data.status)e.$Message.error(t.data.message);else{var n=e.$router.resolve({path:"/conflictLogDetail",query:{queryType:"1",rowLogIds:r,srcRegion:a.srcRegion,dstRegion:a.dstRegion}});window.open(n.href,"_blank")}}))}else this.$Message.warning("请勾选！")},dbBlacklist:function(){var e=this.$router.resolve({path:"/dbBlacklist"});window.open(e.href,"_blank")},changeSelection:function(e){this.multiData=e,console.log(this.multiData)},getLogDetail1:function(e,t){var r=this;this.modalLoading=!0,this.detailModal=!0,this.logDetail.result=e.rowResult,this.logDetail.resultStr=0===e.rowResult?"commit":"rollBack",this.logDetail.srcRegion=e.srcRegion,this.logDetail.dstRegion=e.dstRegion,this.logDetail.srcRecords=[],this.logDetail.dstRecords=[],this.rowData="",this.axios.get("/api/drc/v2/log/conflict/row/record?conflictRowLogId="+e.conflictRowsLogId+"&columnSize=12").then((function(t){if(1===t.data.status)r.$Message.error({content:"查询失败! "+t.data.message,duration:5}),r.logDetail.recordEqual=!1,r.logDetail.diffStr="数据比对失败",r.logDetail.srcRecords=[],r.logDetail.dstRecords=[];else{var a=t.data.data;r.logDetail.recordEqual=a.recordIsEqual,r.logDetail.diffStr=a.recordIsEqual?"数据一致":"数据不一致",r.logDetail.srcRecords=a.srcRecords,r.logDetail.dstRecords=a.dstRecords,r.rowData="/*原始SQL*/\n"+e.rawSql+"\n/*原始SQL处理结果: "+e.rawSqlResult+"*/\n\n/*冲突时行记录*/\n"+e.dstRowRecord+"\n\n/*冲突处理SQL*/\n"+e.handleSql+"\n/*冲突处理SQL处理结果: "+e.handleSqlResult+"*/"}})).finally((function(){r.modalLoading=!1}))},getRegions:function(){var e=this;this.axios.get("/api/drc/v2/meta/regions/all").then((function(t){e.regions=t.data.data}))},queryTrxLog:function(e,t){this.$emit("tabValueChanged","trxLog"),this.$emit("gtidChanged",e.gtid),this.$emit("beginHandleTimeChanged",this.queryParam.beginHandleTime),this.$emit("endHandleTimeChanged",this.queryParam.endHandleTime)},getUnEqualRecords:function(){var e=this;this.multiData=[],this.compareModal=!1,this.dataLoading=!0,this.axios.get("/api/drc/v2/log/conflict/rows/rowLogIds?rowLogIds="+this.rowLogIds).then((function(t){var r=t.data;1===r.status?e.$Message.error("查询失败"):(e.tableData=r.data,e.total=r.data.length,e.current=1,e.tableData=r.data,0===e.total?e.$Message.warning("查询结果为空"):(e.compareRecordEqual(),e.$Message.success("以下冲突行数据对比不一致")))})).finally((function(){e.dataLoading=!1}))},getTotalData:function(){this.getData(),this.getCount()},getCount:function(){var e=this,t=this.queryParam.beginHandleTime,r=this.queryParam.endHandleTime,a=new Date(t).getTime(),n=new Date(r).getTime();if(!isNaN(a)&&!isNaN(n)){console.log("beginTime: "+t),console.log("endTime: "+r);var o={gtid:this.queryParam.gtid,dbName:this.queryParam.dbName,tableName:this.queryParam.tableName,rowResult:this.queryParam.rowResult,srcRegion:this.queryParam.srcRegion,dstRegion:this.queryParam.dstRegion,beginHandleTime:a,endHandleTime:n,likeSearch:this.queryParam.likeSearch,brief:this.queryParam.brief,pageReq:{pageSize:this.size,pageIndex:this.current}};this.countLoading=!0;var i=this.flattenObj(o);this.axios.get("/api/drc/v2/log/conflict/rows/count",{params:i}).then((function(t){var r=t.data;0===r.status&&(e.total=r.data)})).finally((function(){e.countLoading=!1}))}},getData:function(){var e=this;this.resetPath(),this.multiData=[],this.compareData.compareRowRecords=[],this.rowLogIds=[];var t=this.queryParam.beginHandleTime,r=this.queryParam.endHandleTime,a=new Date(t).getTime(),n=new Date(r).getTime();if(isNaN(a)||isNaN(n))this.$Message.warning("请选择时间范围!");else{console.log("beginTime: "+t),console.log("endTime: "+r);var o={gtid:this.queryParam.gtid,dbName:this.queryParam.dbName,tableName:this.queryParam.tableName,rowResult:this.queryParam.rowResult,srcRegion:this.queryParam.srcRegion,dstRegion:this.queryParam.dstRegion,beginHandleTime:a,endHandleTime:n,likeSearch:this.queryParam.likeSearch,brief:this.queryParam.brief,pageReq:{pageSize:this.size,pageIndex:this.current}};console.log("params"),console.log(o);var i=this.flattenObj(o);this.dataLoading=!0,this.axios.get("/api/drc/v2/log/conflict/rows",{params:i}).then((function(t){var r=t.data,a=r.pageReq;1===r.status?e.$Message.error(r.message):0===r.data.length?(e.current=1,e.tableData=r.data,e.$Message.warning("查询结果为空")):(e.current=a.pageIndex,e.tableData=r.data,e.$Message.success("查询成功"),e.compareRecordEqual())})).finally((function(){e.dataLoading=!1}))}},flattenObj:function(e){var t={};for(var r in e)if("object"!==Object(o["a"])(e[r])||Array.isArray(e[r]))t[r]=e[r];else{var a=this.flattenObj(e[r]);for(var n in a)t[r+"."+n]=a[n]}return t},resetParam:function(){this.queryParam={dbName:null,tableName:null,gtId:null,beginHandleTime:new Date((new Date).setSeconds(0,0)-6e5),endHandleTime:new Date((new Date).setSeconds(0,0)+6e4),rowResult:null,srcRegion:null,dstRegion:null},this.rowLogIds=[]},handleChangeSize:function(e){var t=this;this.size=e,this.$nextTick((function(){t.getData()}))}},created:function(){this.getTotalData(),this.getRegions()}}),u=c,d=(r("f889"),r("2877")),f=Object(d["a"])(u,a,n,!1,null,null,null);t["default"]=f.exports},"8aa5":function(e,t,r){"use strict";var a=r("6547").charAt;e.exports=function(e,t,r){return t+(r?a(e,t).length:1)}},"944a":function(e,t,r){var a=r("746f");a("toStringTag")},a640:function(e,t,r){"use strict";var a=r("d039");e.exports=function(e,t){var r=[][e];return!!r&&a((function(){r.call(null,t||function(){throw 1},1)}))}},a9e3:function(e,t,r){"use strict";var a=r("83ab"),n=r("da84"),o=r("94ca"),i=r("6eeb"),s=r("5135"),l=r("c6b6"),c=r("7156"),u=r("c04e"),d=r("d039"),f=r("7c73"),h=r("241c").f,g=r("06cf").f,m=r("9bf2").f,p=r("58a8").trim,v="Number",y=n[v],b=y.prototype,w=l(f(b))==v,q=function(e){var t,r,a,n,o,i,s,l,c=u(e,!1);if("string"==typeof c&&c.length>2)if(c=p(c),t=c.charCodeAt(0),43===t||45===t){if(r=c.charCodeAt(2),88===r||120===r)return NaN}else if(48===t){switch(c.charCodeAt(1)){case 66:case 98:a=2,n=49;break;case 79:case 111:a=8,n=55;break;default:return+c}for(o=c.slice(2),i=o.length,s=0;s<i;s++)if(l=o.charCodeAt(s),l<48||l>n)return NaN;return parseInt(o,a)}return+c};if(o(v,!y(" 0o1")||!y("0b1")||y("+0x1"))){for(var R,x=function(e){var t=arguments.length<1?0:e,r=this;return r instanceof x&&(w?d((function(){b.valueOf.call(r)})):l(r)!=v)?c(new y(q(t)),r,x):q(t)},P=a?h(y):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),E=0;P.length>E;E++)s(y,R=P[E])&&!s(x,R)&&m(x,R,g(y,R));x.prototype=b,b.constructor=x,i(n,v,x)}},b636:function(e,t,r){var a=r("746f");a("asyncIterator")},c7eb:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));r("a4d3"),r("e01a"),r("b636"),r("d28b"),r("944a"),r("e260"),r("fb6a"),r("b0c0"),r("0c47"),r("23dc"),r("3410"),r("131a"),r("d3b7"),r("e6cf"),r("3ca3"),r("159b"),r("ddb0");var a=r("53ca");function n(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */
n=function(){return t};var e,t={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(e,t,r){e[t]=r.value},s="function"==typeof Symbol?Symbol:{},l=s.iterator||"@@iterator",c=s.asyncIterator||"@@asyncIterator",u=s.toStringTag||"@@toStringTag";function d(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(e){d=function(e,t,r){return e[t]=r}}function f(e,t,r,a){var n=t&&t.prototype instanceof b?t:b,o=Object.create(n.prototype),s=new N(a||[]);return i(o,"_invoke",{value:_(e,r,s)}),o}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=f;var g="suspendedStart",m="suspendedYield",p="executing",v="completed",y={};function b(){}function w(){}function q(){}var R={};d(R,l,(function(){return this}));var x=Object.getPrototypeOf,P=x&&x(x(I([])));P&&P!==r&&o.call(P,l)&&(R=P);var E=q.prototype=b.prototype=Object.create(R);function S(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function T(e,t){function r(n,i,s,l){var c=h(e[n],e,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==Object(a["a"])(d)&&o.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,s,l)}),(function(e){r("throw",e,s,l)})):t.resolve(d).then((function(e){u.value=e,s(u)}),(function(e){return r("throw",e,s,l)}))}l(c.arg)}var n;i(this,"_invoke",{value:function(e,a){function o(){return new t((function(t,n){r(e,a,t,n)}))}return n=n?n.then(o,o):o()}})}function _(t,r,a){var n=g;return function(o,i){if(n===p)throw Error("Generator is already running");if(n===v){if("throw"===o)throw i;return{value:e,done:!0}}for(a.method=o,a.arg=i;;){var s=a.delegate;if(s){var l=L(s,a);if(l){if(l===y)continue;return l}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(n===g)throw n=v,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);n=p;var c=h(t,r,a);if("normal"===c.type){if(n=a.done?v:m,c.arg===y)continue;return{value:c.arg,done:a.done}}"throw"===c.type&&(n=v,a.method="throw",a.arg=c.arg)}}}function L(t,r){var a=r.method,n=t.iterator[a];if(n===e)return r.delegate=null,"throw"===a&&t.iterator["return"]&&(r.method="return",r.arg=e,L(t,r),"throw"===r.method)||"return"!==a&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+a+"' method")),y;var o=h(n,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,y;var i=o.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,y):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function D(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(D,this),this.reset(!0)}function I(t){if(t||""===t){var r=t[l];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function r(){for(;++n<t.length;)if(o.call(t,n))return r.value=t[n],r.done=!1,r;return r.value=e,r.done=!0,r};return i.next=i}}throw new TypeError(Object(a["a"])(t)+" is not iterable")}return w.prototype=q,i(E,"constructor",{value:q,configurable:!0}),i(q,"constructor",{value:w,configurable:!0}),w.displayName=d(q,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,q):(e.__proto__=q,d(e,u,"GeneratorFunction")),e.prototype=Object.create(E),e},t.awrap=function(e){return{__await:e}},S(T.prototype),d(T.prototype,c,(function(){return this})),t.AsyncIterator=T,t.async=function(e,r,a,n,o){void 0===o&&(o=Promise);var i=new T(f(e,r,a,n),o);return t.isGeneratorFunction(r)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},S(E),d(E,u,"Generator"),d(E,l,(function(){return this})),d(E,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var a in t)r.push(a);return r.reverse(),function e(){for(;r.length;){var a=r.pop();if(a in t)return e.value=a,e.done=!1,e}return e.done=!0,e}},t.values=I,N.prototype={constructor:N,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(k),!t)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function a(a,n){return s.type="throw",s.arg=t,r.next=a,n&&(r.method="next",r.arg=e),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n],s=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var l=o.call(i,"catchLoc"),c=o.call(i,"finallyLoc");if(l&&c){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&o.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var n=a;break}}n&&("break"===e||"continue"===e)&&n.tryLoc<=t&&t<=n.finallyLoc&&(n=null);var i=n?n.completion:{};return i.type=e,i.arg=t,n?(this.method="next",this.next=n.finallyLoc,y):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),k(r),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var a=r.completion;if("throw"===a.type){var n=a.arg;k(r)}return n}}throw Error("illegal catch attempt")},delegateYield:function(t,r,a){return this.delegate={iterator:I(t),resultName:r,nextLoc:a},"next"===this.method&&(this.arg=e),y}},t}},d784:function(e,t,r){"use strict";r("ac1f");var a=r("6eeb"),n=r("d039"),o=r("b622"),i=r("9263"),s=r("9112"),l=o("species"),c=!n((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),u=function(){return"$0"==="a".replace(/./,"$0")}(),d=o("replace"),f=function(){return!!/./[d]&&""===/./[d]("a","$0")}(),h=!n((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return 2!==r.length||"a"!==r[0]||"b"!==r[1]}));e.exports=function(e,t,r,d){var g=o(e),m=!n((function(){var t={};return t[g]=function(){return 7},7!=""[e](t)})),p=m&&!n((function(){var t=!1,r=/a/;return"split"===e&&(r={},r.constructor={},r.constructor[l]=function(){return r},r.flags="",r[g]=/./[g]),r.exec=function(){return t=!0,null},r[g](""),!t}));if(!m||!p||"replace"===e&&(!c||!u||f)||"split"===e&&!h){var v=/./[g],y=r(g,""[e],(function(e,t,r,a,n){return t.exec===i?m&&!n?{done:!0,value:v.call(t,r,a)}:{done:!0,value:e.call(r,t,a)}:{done:!1}}),{REPLACE_KEEPS_$0:u,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:f}),b=y[0],w=y[1];a(String.prototype,e,b),a(RegExp.prototype,g,2==t?function(e,t){return w.call(e,this,t)}:function(e){return w.call(e,this)})}d&&s(RegExp.prototype[g],"sham",!0)}},d81d:function(e,t,r){"use strict";var a=r("23e7"),n=r("b727").map,o=r("1dde"),i=r("ae40"),s=o("map"),l=i("map");a({target:"Array",proto:!0,forced:!s||!l},{map:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}})},f057:function(e,t,r){},f889:function(e,t,r){"use strict";r("f057")}}]);
//# sourceMappingURL=chunk-cc1de8ba.b8bc496a.js.map