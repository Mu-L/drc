(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-199a5a75"],{1043:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("base-component",{attrs:{isFather:e.isFather,subMenuName:["1"],fatherMenu:e.fatherMenu}},[a("Breadcrumb",{style:{margin:"15px 0 15px 185px",position:"fixed"}},[a("BreadcrumbItem",{attrs:{to:"/home"}},[e._v("首页")]),a("BreadcrumbItem",{attrs:{to:"/fullDataConsistencyCluster"}},[e._v("校验集群")]),a("BreadcrumbItem",[e._v("校验表配置")])],1),a("Content",{staticClass:"content",style:{padding:"10px",background:"#fff",margin:"50px 0 1px 185px",zIndex:"1"}},[a("div",{staticStyle:{padding:"1px 1px"}},[a("div",{staticClass:"ivu-list-item-meta-title"},[a("p",[e._v("DRC集群："+e._s(e.$route.query.clusterA)+"(集群A)---"+e._s(e.$route.query.clusterB)+"(集群B)")])]),a("Table",{staticStyle:{"margin-top":"20px"},attrs:{stripe:"",columns:e.columns,data:e.dataWithPage,size:"small"}}),a("div",{staticStyle:{"text-align":"center",margin:"16px 0"}},[a("Page",{attrs:{total:e.records.length,current:e.current,"show-sizer":"","show-elevator":"",placement:"top"},on:{"update:current":function(t){e.current=t},"on-page-size-change":e.handleChangeSize}})],1)],1),a("Modal",{attrs:{width:"900px",title:"一致性校验确认"},on:{"on-ok":e.okCheckConsistency,"on-cancel":e.cancelCheckConsistency},model:{value:this.confirmCheckModal,callback:function(t){e.$set(this,"confirmCheckModal",t)},expression:"this.confirmCheckModal"}},[a("Form",{attrs:{"label-width":200}},[a("FormItem",{attrs:{label:"库名"}},[a("Input",{staticStyle:{width:"500px"},attrs:{readonly:""},model:{value:this.chooseTableConfig.schema,callback:function(t){e.$set(this.chooseTableConfig,"schema",t)},expression:"this.chooseTableConfig.schema"}})],1),a("FormItem",{attrs:{label:"表名"}},[a("Input",{staticStyle:{width:"500px"},attrs:{readonly:""},model:{value:this.chooseTableConfig.table,callback:function(t){e.$set(this.chooseTableConfig,"table",t)},expression:"this.chooseTableConfig.table"}})],1),a("FormItem",{attrs:{label:"key"}},[a("Input",{staticStyle:{width:"500px"},attrs:{readonly:""},model:{value:this.chooseTableConfig.key,callback:function(t){e.$set(this.chooseTableConfig,"key",t)},expression:"this.chooseTableConfig.key"}})],1),a("FormItem",{attrs:{label:"onUpdate"}},[a("Input",{staticStyle:{width:"500px"},attrs:{readonly:""},model:{value:this.chooseTableConfig.onUpdate,callback:function(t){e.$set(this.chooseTableConfig,"onUpdate",t)},expression:"this.chooseTableConfig.onUpdate"}})],1),a("FormItem",{attrs:{label:"startTimestamp"}},[a("Input",{staticStyle:{width:"500px"},attrs:{readonly:""},model:{value:this.chooseTableConfig.startTimestamp,callback:function(t){e.$set(this.chooseTableConfig,"startTimestamp",t)},expression:"this.chooseTableConfig.startTimestamp"}})],1),a("FormItem",{attrs:{label:"endTimeStamp"}},[a("Input",{staticStyle:{width:"500px"},attrs:{readonly:""},model:{value:this.chooseTableConfig.endTimeStamp,callback:function(t){e.$set(this.chooseTableConfig,"endTimeStamp",t)},expression:"this.chooseTableConfig.endTimeStamp"}})],1)],1)],1),a("Modal",{attrs:{width:"900px",title:"执行结果"},on:{"on-ok":e.okExecuteModal,"on-cancel":e.okExecuteModal},model:{value:this.executeModal,callback:function(t){e.$set(this,"executeModal",t)},expression:"this.executeModal"}},[a("Form",[a("FormItem",{attrs:{label:"执行结果"}},[a("Alert",{attrs:{type:this.executeStatus,"show-icon":""}},[e._v(e._s(this.executeMsg))])],1)],1)],1)],1)],1)},o=[],r=a("2909"),i=(a("fb6a"),a("e66c")),s={name:"fullDataConsistencyCheck",data:function(){var e=this;return{isFather:!0,fatherMenu:"/fullDataConsistencyCluster",executeStatus:"",executeMsg:"",executeModal:!1,confirmCheckModal:!1,chooseTableConfig:{tableId:"",schema:"",table:"",key:"",onUpdate:"",startTimestamp:"",endTimeStamp:""},total:0,current:1,size:10,records:[],startTime:[],endTime:[],columns:[{title:"库名",key:"monitorSchemaName",resizable:!0},{title:"表名",key:"monitorTableName",resizable:!0},{title:"开始时间",align:"center",resizable:!0,render:function(t,a){return t("DatePicker",{props:{type:"datetime",format:"yyyy-MM-dd HH:mm",transfer:!0,placeholder:"start time"},on:{"on-change":function(t){e.startTime[a.index+(e.current-1)*e.size]=t}}})}},{title:"结束时间",align:"center",resizable:!0,render:function(t,a){return t("DatePicker",{props:{type:"datetime",format:"yyyy-MM-dd HH:mm",transfer:!0,placeholder:"end time"},on:{"on-change":function(t){e.endTime[a.index+(e.current-1)*e.size]=t}}})}},{title:"操作",align:"center",resizable:!0,render:function(t,a){return t("div",[t("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.confirmModalCheck(a)}}},"执行")])}},{title:"校验状态",align:"center",render:function(e,t){var a=t.row,n=0===a.fullDataCheckStatus?"error":1===a.fullDataCheckStatus?"warning":2===a.fullDataCheckStatus?"success":"warning",o=0===a.fullDataCheckStatus?"未校验":1===a.fullDataCheckStatus?"校验中":2===a.fullDataCheckStatus?"已校验":"校验失败";return e("Tag",{props:{color:n}},o)}},{title:"最近校验时间",align:"center",render:function(e,t){return e("div",null==t.row.fullDataCheckLasttime?"":Object(i["a"])(new Date(t.row.fullDataCheckLasttime),"yyyy-MM-dd hh:mm:ss"))}},{title:"最近校验结果",align:"center",render:function(t,a){return t("div",[t("Button",{props:{type:"info",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.showCheckResult(a.row)}}},"查看")])}}]}},methods:{getConfiguredTables:function(){var e=this;this.axios.get("/api/drc/v1/monitor/consistency/data/"+this.$route.query.clusterA+"/"+this.$route.query.clusterB).then((function(t){e.records=t.data.data,console.log(t.data.data)}))},handleChangeSize:function(e){var t=this;this.size=e,this.$nextTick((function(){t.getData()}))},confirmModalCheck:function(e){this.chooseTableConfig.tableId=e.row.id,this.chooseTableConfig.schema=e.row.monitorSchemaName,this.chooseTableConfig.table=e.row.monitorTableName,this.chooseTableConfig.key=e.row.monitorTableKey,this.chooseTableConfig.onUpdate=e.row.monitorTableOnUpdate,this.chooseTableConfig.startTimestamp=this.startTime[e.index+(this.current-1)*this.size],this.chooseTableConfig.endTimeStamp=this.endTime[e.index+(this.current-1)*this.size],this.confirmCheckModal=!0},okCheckConsistency:function(){this.checkDataConsistency(),this.confirmCheckModal=!1},cancelCheckConsistency:function(){this.confirmCheckModal=!1},checkDataConsistency:function(){var e=this;this.axios.post("/api/drc/v1/monitor/consistency/data/full/"+this.$route.query.clusterA+"/"+this.$route.query.clusterB,{tableId:this.chooseTableConfig.tableId,schema:this.chooseTableConfig.schema,table:this.chooseTableConfig.table,key:this.chooseTableConfig.key,onUpdate:this.chooseTableConfig.onUpdate,startTimestamp:this.chooseTableConfig.startTimestamp,endTimeStamp:this.chooseTableConfig.endTimeStamp,mhaAName:this.$route.query.clusterA,mhaBName:this.$route.query.clusterB}).then((function(t){console.log("add result"),console.log(t.data),0===t.data.status?(e.executeStatus="success",e.executeMsg=t.data.message):(e.executeStatus="error",e.executeMsg=t.data.data),e.executeModal=!0}))},okExecuteModal:function(){this.executeModal=!1,this.confirmCheckModal=!1},showCheckResult:function(e){this.$router.push({name:"fullDataConsistencyResult",query:{dbName:e.monitorSchemaName,tableName:e.monitorTableName,mhaA:this.$route.query.clusterA,mhaB:this.$route.query.clusterB,key:e.monitorTableKey,checkTime:Object(i["a"])(new Date(e.fullDataCheckLasttime),"yyyy-MM-dd hh:mm:ss")}})}},computed:{dataWithPage:function(){var e=this.records,t=this.current*this.size-this.size,a=t+this.size;return Object(r["a"])(e).slice(t,a)}},created:function(){this.getConfiguredTables()}},c=s,l=a("2877"),u=Object(l["a"])(c,n,o,!1,null,"ddb6d8ee",null);t["default"]=u.exports},"14c3":function(e,t,a){var n=a("c6b6"),o=a("9263");e.exports=function(e,t){var a=e.exec;if("function"===typeof a){var r=a.call(e,t);if("object"!==typeof r)throw TypeError("RegExp exec method returned something other than an Object or null");return r}if("RegExp"!==n(e))throw TypeError("RegExp#exec called on incompatible receiver");return o.call(e,t)}},"44e7":function(e,t,a){var n=a("861d"),o=a("c6b6"),r=a("b622"),i=r("match");e.exports=function(e){var t;return n(e)&&(void 0!==(t=e[i])?!!t:"RegExp"==o(e))}},"4d63":function(e,t,a){var n=a("83ab"),o=a("da84"),r=a("94ca"),i=a("7156"),s=a("9bf2").f,c=a("241c").f,l=a("44e7"),u=a("ad6d"),h=a("9f7f"),d=a("6eeb"),f=a("d039"),m=a("69f3").set,p=a("2626"),g=a("b622"),b=g("match"),y=o.RegExp,x=y.prototype,v=/a/g,C=/a/g,T=new y(v)!==v,k=h.UNSUPPORTED_Y,S=n&&r("RegExp",!T||k||f((function(){return C[b]=!1,y(v)!=v||y(C)==C||"/a/i"!=y(v,"i")})));if(S){var E=function(e,t){var a,n=this instanceof E,o=l(e),r=void 0===t;if(!n&&o&&e.constructor===E&&r)return e;T?o&&!r&&(e=e.source):e instanceof E&&(r&&(t=u.call(e)),e=e.source),k&&(a=!!t&&t.indexOf("y")>-1,a&&(t=t.replace(/y/g,"")));var s=i(T?new y(e,t):y(e,t),n?this:x,E);return k&&a&&m(s,{sticky:a}),s},M=function(e){e in E||s(E,e,{configurable:!0,get:function(){return y[e]},set:function(t){y[e]=t}})},w=c(y),$=0;while(w.length>$)M(w[$++]);x.constructor=E,E.prototype=x,d(o,"RegExp",E)}p("RegExp")},5319:function(e,t,a){"use strict";var n=a("d784"),o=a("825a"),r=a("7b0b"),i=a("50c4"),s=a("a691"),c=a("1d80"),l=a("8aa5"),u=a("14c3"),h=Math.max,d=Math.min,f=Math.floor,m=/\$([$&'`]|\d\d?|<[^>]*>)/g,p=/\$([$&'`]|\d\d?)/g,g=function(e){return void 0===e?e:String(e)};n("replace",2,(function(e,t,a,n){var b=n.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,y=n.REPLACE_KEEPS_$0,x=b?"$":"$0";return[function(a,n){var o=c(this),r=void 0==a?void 0:a[e];return void 0!==r?r.call(a,o,n):t.call(String(o),a,n)},function(e,n){if(!b&&y||"string"===typeof n&&-1===n.indexOf(x)){var r=a(t,e,this,n);if(r.done)return r.value}var c=o(e),f=String(this),m="function"===typeof n;m||(n=String(n));var p=c.global;if(p){var C=c.unicode;c.lastIndex=0}var T=[];while(1){var k=u(c,f);if(null===k)break;if(T.push(k),!p)break;var S=String(k[0]);""===S&&(c.lastIndex=l(f,i(c.lastIndex),C))}for(var E="",M=0,w=0;w<T.length;w++){k=T[w];for(var $=String(k[0]),R=h(d(s(k.index),f.length),0),I=[],D=1;D<k.length;D++)I.push(g(k[D]));var _=k.groups;if(m){var z=[$].concat(I,R,f);void 0!==_&&z.push(_);var A=String(n.apply(void 0,z))}else A=v($,f,R,I,_,n);R>=M&&(E+=f.slice(M,R)+A,M=R+$.length)}return E+f.slice(M)}];function v(e,a,n,o,i,s){var c=n+e.length,l=o.length,u=p;return void 0!==i&&(i=r(i),u=m),t.call(s,u,(function(t,r){var s;switch(r.charAt(0)){case"$":return"$";case"&":return e;case"`":return a.slice(0,n);case"'":return a.slice(c);case"<":s=i[r.slice(1,-1)];break;default:var u=+r;if(0===u)return t;if(u>l){var h=f(u/10);return 0===h?t:h<=l?void 0===o[h-1]?r.charAt(1):o[h-1]+r.charAt(1):t}s=o[u-1]}return void 0===s?"":s}))}}))},"8aa5":function(e,t,a){"use strict";var n=a("6547").charAt;e.exports=function(e,t,a){return t+(a?n(e,t).length:1)}},d784:function(e,t,a){"use strict";a("ac1f");var n=a("6eeb"),o=a("d039"),r=a("b622"),i=a("9263"),s=a("9112"),c=r("species"),l=!o((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),u=function(){return"$0"==="a".replace(/./,"$0")}(),h=r("replace"),d=function(){return!!/./[h]&&""===/./[h]("a","$0")}(),f=!o((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var a="ab".split(e);return 2!==a.length||"a"!==a[0]||"b"!==a[1]}));e.exports=function(e,t,a,h){var m=r(e),p=!o((function(){var t={};return t[m]=function(){return 7},7!=""[e](t)})),g=p&&!o((function(){var t=!1,a=/a/;return"split"===e&&(a={},a.constructor={},a.constructor[c]=function(){return a},a.flags="",a[m]=/./[m]),a.exec=function(){return t=!0,null},a[m](""),!t}));if(!p||!g||"replace"===e&&(!l||!u||d)||"split"===e&&!f){var b=/./[m],y=a(m,""[e],(function(e,t,a,n,o){return t.exec===i?p&&!o?{done:!0,value:b.call(t,a,n)}:{done:!0,value:e.call(a,t,n)}:{done:!1}}),{REPLACE_KEEPS_$0:u,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:d}),x=y[0],v=y[1];n(String.prototype,e,x),n(RegExp.prototype,m,2==t?function(e,t){return v.call(e,this,t)}:function(e){return v.call(e,this)})}h&&s(RegExp.prototype[m],"sham",!0)}},e66c:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));a("4d63"),a("ac1f"),a("25f0"),a("5319");function n(e,t){var a={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"S+":e.getMilliseconds()};for(var n in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length))),a)new RegExp("("+n+")").test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?a[n]:("00"+a[n]).substr((""+a[n]).length)));return t}}}]);
//# sourceMappingURL=chunk-199a5a75.d0a1cac5.js.map