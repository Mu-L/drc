(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4bb59468"],{"159b":function(t,r,e){var o=e("da84"),s=e("fdbc"),a=e("17c2"),i=e("9112");for(var u in s){var c=o[u],l=c&&c.prototype;if(l&&l.forEach!==a)try{i(l,"forEach",a)}catch(n){l.forEach=a}}},"17c2":function(t,r,e){"use strict";var o=e("b727").forEach,s=e("a640"),a=e("ae40"),i=s("forEach"),u=a("forEach");t.exports=i&&u?[].forEach:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}},4160:function(t,r,e){"use strict";var o=e("23e7"),s=e("17c2");o({target:"Array",proto:!0,forced:[].forEach!=s},{forEach:s})},a640:function(t,r,e){"use strict";var o=e("d039");t.exports=function(t,r){var e=[][t];return!!e&&o((function(){e.call(null,r||function(){throw 1},1)}))}},c6d5:function(t,r,e){"use strict";e.r(r);var o=function(){var t=this,r=t.$createElement,e=t._self._c||r;return e("base-component",[e("Breadcrumb",{style:{margin:"15px 0 15px 185px",position:"fixed"}},[e("BreadcrumbItem",{attrs:{to:"/home"}},[t._v("首页")]),e("BreadcrumbItem",{attrs:{to:"/proxyRouteManagement"}},[t._v("录入路由规则")])],1),e("Content",{staticClass:"content",style:{padding:"10px",background:"#fff",margin:"50px 0 1px 185px",zIndex:"1"}},[e("div",{staticStyle:{padding:"1px 1px"}},[e("Row",[e("i-col",{attrs:{span:"12"}},[e("Form",{ref:"route",staticStyle:{float:"left","margin-top":"50px"},attrs:{model:t.route,rules:t.ruleRoute,"label-width":250}},[e("FormItem",{attrs:{label:"业务部门"}},[e("Select",{attrs:{filterable:"",disabled:"true"===t.updateStatus,clearable:"",placeholder:"请输入路由BU,不填默认为公用路由"},model:{value:t.route.routeOrgName,callback:function(r){t.$set(t.route,"routeOrgName",r)},expression:"route.routeOrgName"}},t._l(t.bus,(function(r){return e("Option",{key:r.buName,attrs:{value:r.buName}},[t._v(t._s(r.buName))])})),1)],1),e("FormItem",{attrs:{label:"源端（Applier）机房",prop:"srcDcName"}},[e("Select",{staticStyle:{width:"250px"},attrs:{disabled:"true"===t.updateStatus,filterable:"","allow-create":"",placeholder:"请选择源端（Applier）机房"},on:{"on-select":t.getProxyUrisInSrc,"on-create":t.handleCreateDc},model:{value:t.route.srcDcName,callback:function(r){t.$set(t.route,"srcDcName",r)},expression:"route.srcDcName"}},t._l(t.drcZoneList,(function(r){return e("Option",{key:r.value,attrs:{value:r.value}},[t._v(t._s(r.label))])})),1)],1),e("FormItem",{attrs:{label:"源端（Applier）Proxy",prop:"srcProxyUris"}},[e("Select",{staticStyle:{width:"250px"},attrs:{filterable:"",multiple:"",placeholder:"请选择源端Proxy"},model:{value:t.route.proxyUris.src,callback:function(r){t.$set(t.route.proxyUris,"src",r)},expression:"route.proxyUris.src"}},t._l(t.route.proxyUriList.src,(function(r){return e("Option",{key:r,attrs:{value:r}},[t._v(t._s(r))])})),1)],1),e("FormItem",{attrs:{label:"中继Proxy",prop:"relayProxyUris"}},[e("Select",{staticStyle:{width:"250px"},attrs:{filterable:"",multiple:"",placeholder:"请选择中继Proxy"},model:{value:t.route.proxyUris.relay,callback:function(r){t.$set(t.route.proxyUris,"relay",r)},expression:"route.proxyUris.relay"}},t._l(t.route.proxyUriList.all,(function(r){return e("Option",{key:r,attrs:{value:r}},[t._v(t._s(r))])})),1)],1),e("FormItem",{attrs:{label:"目标（Replicator）机房",prop:"dstDcName"}},[e("Select",{staticStyle:{width:"250px"},attrs:{disabled:"true"===t.updateStatus,filterable:"","allow-create":"",placeholder:"请选择目标（Replicator）机房"},on:{"on-select":t.getProxyUrisInDst,"on-create":t.handleCreateDc},model:{value:t.route.dstDcName,callback:function(r){t.$set(t.route,"dstDcName",r)},expression:"route.dstDcName"}},t._l(t.drcZoneList,(function(r){return e("Option",{key:r.value,attrs:{value:r.value}},[t._v(t._s(r.label))])})),1)],1),e("FormItem",{attrs:{label:"目标（Replicator）Proxy",prop:"dstProxyUris"}},[e("Select",{staticStyle:{width:"250px"},attrs:{filterable:"",multiple:"",placeholder:"请选择目标Proxy"},model:{value:t.route.proxyUris.dst,callback:function(r){t.$set(t.route.proxyUris,"dst",r)},expression:"route.proxyUris.dst"}},t._l(t.route.proxyUriList.dst,(function(r){return e("Option",{key:r,attrs:{value:r}},[t._v(t._s(r))])})),1)],1),e("FormItem",{staticStyle:{width:"500px"},attrs:{label:"Tag",prop:"tag"}},[e("Select",{attrs:{filterable:"",clearable:"",disabled:"true"===t.updateStatus,placeholder:"请输入路由tag"},model:{value:t.route.tag,callback:function(r){t.$set(t.route,"tag",r)},expression:"route.tag"}},t._l(t.tags,(function(r){return e("Option",{key:r,attrs:{value:r}},[t._v(t._s(r))])})),1)],1),e("FormItem",[e("Button",{on:{click:function(r){return t.handleReset()}}},[t._v("重置")]),e("br"),e("br"),e("Button",{attrs:{type:"primary"},on:{click:function(r){t.reviewInputResource()}}},[t._v("录入")])],1),e("Modal",{attrs:{title:"录入确认"},on:{"on-ok":function(r){return t.inputResource()}},model:{value:t.route.reviewModal,callback:function(r){t.$set(t.route,"reviewModal",r)},expression:"route.reviewModal"}},[t._v(" 对BU["+t._s(this.route.routeOrgName)+"]、tag["+t._s(this.route.tag)+"]、方向["+t._s(this.route.srcDcName)+"->"+t._s(this.route.dstDcName)+"]，确认新增/修改路由为源端Proxies："+t._s(this.route.proxyUris.src)+"，中继Proxies："+t._s(this.route.proxyUris.relay)+"，目标Proxies："+t._s(this.route.proxyUris.dst)+"吗？ ")]),e("Modal",{attrs:{title:"录入结果"},model:{value:t.route.resultModal,callback:function(r){t.$set(t.route,"resultModal",r)},expression:"route.resultModal"}},[t._v(" "+t._s(this.result)+" ")])],1)],1)],1)],1)])],1)},s=[],a=(e("4160"),e("159b"),{name:"proxyRouteManagement",data:function(){return{tags:this.constant.routeTags,updateStatus:this.$route.query.updateStatus,bus:[],route:{reviewModal:!1,resultModal:!1,routeId:this.$route.query.routeId,routeOrgName:"",srcDcName:"",dstDcName:"",tag:"",proxyUris:{src:[],relay:[],dst:[]},proxyUriList:{src:[],all:[],dst:[]}},ruleRoute:{srcDcName:[{required:!0,message:"源端（Applier）机房不能为空",trigger:"blur"}],dstDcName:[{required:!0,message:"目标（Replicator）机房不能为空",trigger:"blur"}],srcProxyUris:[{required:!0,message:"源端Proxy不能为空",trigger:"blur"}],dstProxyUris:[{required:!0,message:"目标Proxy不能为空",trigger:"blur"}],tag:[{required:!0,message:"tag不能为空",trigger:"blur"}]},drcZoneList:this.constant.dcList,result:""}},methods:{reviewInputResource:function(){this.route.reviewModal=!0},inputResource:function(){var t=this;this.axios.post("/api/drc/v2/meta/route",{id:this.route.routeId,routeOrgName:this.route.routeOrgName,srcDcName:this.route.srcDcName,dstDcName:this.route.dstDcName,srcProxyUris:this.route.proxyUris.src,relayProxyUris:this.route.proxyUris.relay,dstProxyUris:this.route.proxyUris.dst,tag:this.route.tag}).then((function(r){console.log(r.data),t.result=r.data.data,t.route.reviewModal=!1,t.route.resultModal=!0}))},handleCreateDc:function(t){console.log("customize add dc: "+t),this.drcZoneList.push({value:t,label:t}),console.log(this.drcZoneList)},handleReset:function(){alert(this.updateStatus),this.route.routeOrgName="",this.route.srcDcName="",this.route.dstDcName="",this.route.tag="",this.route.proxyUris.src=[],this.route.proxyUris.relay=[],this.route.proxyUris.dst=[]},getProxyUrisInSrc:function(t){var r=this,e="/api/drc/v2/meta/proxy/uris?dc="+t.value+"&src=true";console.log("uri: "+e),this.axios.get(e).then((function(t){console.log(t.data),r.route.proxyUriList.src=[],t.data.data.forEach((function(t){return r.route.proxyUriList.src.push(t)}))}))},getProxyUrisInDst:function(t){var r=this,e="/api/drc/v2/meta/proxy/uris?dc="+t.value+"&src=false";console.log("uri: "+e),this.axios.get(e).then((function(t){console.log(t.data),r.route.proxyUriList.dst=[],t.data.data.forEach((function(t){return r.route.proxyUriList.dst.push(t)}))}))},getProxyUrisInSrc2:function(){var t=this,r="/api/drc/v2/meta/proxy/uris?dc="+this.route.srcDcName+"&src=true";console.log("uri: "+r),this.axios.get(r).then((function(r){console.log(r.data),t.route.proxyUriList.src=[],r.data.data.forEach((function(r){return t.route.proxyUriList.src.push(r)}))}))},getProxyUrisInDst2:function(){var t=this,r="/api/drc/v2/meta/proxy/uris?dc="+this.route.dstDcName+"&src=false";console.log("uri: "+r),this.axios.get(r).then((function(r){console.log(r.data),t.route.proxyUriList.dst=[],r.data.data.forEach((function(r){return t.route.proxyUriList.dst.push(r)}))}))},getAllProxyUris:function(){var t=this,r="/api/drc/v2/meta/proxy/uris/relay";console.log("uri: "+r),this.axios.get(r).then((function(r){console.log(r.data),t.route.proxyUriList.all=[],r.data.data.forEach((function(r){return t.route.proxyUriList.all.push(r)}))}))},getProxyUrisInUse:function(){var t=this,r="/api/drc/v2/meta/route?routeId="+this.route.routeId;console.log("uri: "+r),this.axios.get(r).then((function(r){console.log(r),t.route.proxyUris.src=[],t.route.proxyUris.relay=[],t.route.proxyUris.dst=[];var e=r.data.data;null!==e&&(e.srcProxyUris.forEach((function(r){return t.route.proxyUris.src.push(r)})),e.relayProxyUris.forEach((function(r){return t.route.proxyUris.relay.push(r)})),e.dstProxyUris.forEach((function(r){return t.route.proxyUris.dst.push(r)})),t.route.routeOrgName=e.routeOrgName,t.route.srcDcName=e.srcDcName,t.route.dstDcName=e.dstDcName,t.route.tag=e.tag,t.getProxyUrisInSrc2(),t.getProxyUrisInDst2())}))},getBus:function(){var t=this;this.axios.get("/api/drc/v2/meta/bus/all").then((function(r){t.bus=r.data.data}))}},created:function(){var t=this;this.axios.get("/api/drc/v2/permission/resource/proxy").then((function(r){403!==r.data.status?(t.getProxyUrisInUse(),t.getAllProxyUris(),t.getBus()):t.$router.push("/nopermission")}))}}),i=a,u=e("2877"),c=Object(u["a"])(i,o,s,!1,null,"508a79d7",null);r["default"]=c.exports}}]);
//# sourceMappingURL=chunk-4bb59468.56618a56.js.map