(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-76b982ae"],{"0c77":function(e,a,t){"use strict";t("491b")},3535:function(e,a,t){"use strict";t.r(a);var i=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("base-component",[t("Breadcrumb",{style:{margin:"15px 0 15px 185px",position:"fixed"}},[t("BreadcrumbItem",{attrs:{to:"/home"}},[e._v("首页")]),t("BreadcrumbItem",{attrs:{to:"/v2/migration"}},[e._v("DB 搬迁任务")])],1),t("Content",{staticClass:"content",style:{padding:"10px",background:"#fff",margin:"50px 0 1px 185px",zIndex:"1"}},[t("div",{staticStyle:{padding:"1px 1px"}},[t("Row",{attrs:{gutter:10,align:"middle"}},[t("Col",{attrs:{span:"15"}},[t("Card",{attrs:{padding:5},scopedSlots:e._u([{key:"title",fn:function(){return[e._v("查询条件")]},proxy:!0}])},[t("Row",{attrs:{gutter:10}},[t("Col",{attrs:{span:"5"}},[t("Input",{attrs:{prefix:"ios-search",placeholder:"老集群"},on:{"on-enter":e.getMigrationTasks},model:{value:e.queryParam.oldMha,callback:function(a){e.$set(e.queryParam,"oldMha",a)},expression:"queryParam.oldMha"}})],1),t("Col",{attrs:{span:"5"}},[t("Input",{attrs:{prefix:"ios-search",placeholder:"新集群"},on:{"on-enter":e.getMigrationTasks},model:{value:e.queryParam.newMha,callback:function(a){e.$set(e.queryParam,"newMha",a)},expression:"queryParam.newMha"}})],1),t("Col",{attrs:{span:"5"}},[t("Input",{attrs:{prefix:"ios-search",placeholder:"操作人"},on:{"on-enter":e.getMigrationTasks},model:{value:e.queryParam.operator,callback:function(a){e.$set(e.queryParam,"operator",a)},expression:"queryParam.operator"}})],1),t("Col",{attrs:{span:"5"}},[t("Select",{attrs:{filterable:"",prefix:"ios-home",clearable:"",placeholder:"状态"},on:{"on-change":e.getMigrationTasks},model:{value:e.queryParam.status,callback:function(a){e.$set(e.queryParam,"status",a)},expression:"queryParam.status"}},e._l(e.status,(function(a){return t("Option",{key:a,attrs:{value:a}},[e._v(e._s(a))])})),1)],1)],1)],1)],1),t("Col",{attrs:{span:"1"}},[t("Button",{attrs:{type:"primary",icon:"ios-search",loading:e.dataLoading},on:{click:e.getMigrationTasks}},[e._v("查询")]),t("Button",{staticStyle:{"margin-top":"20px"},attrs:{icon:"md-refresh",loading:e.dataLoading},on:{click:e.resetParam}},[e._v("重置")])],1)],1),t("br"),t("Table",{attrs:{loading:e.dataLoading,stripe:"",border:"",columns:e.columns,data:e.migrationTasks},scopedSlots:e._u([{key:"action",fn:function(a){var i=a.row,r=a.index;return[t("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"success",size:"small"},on:{click:function(a){return e.getDetail(i,r)}}},[e._v(" 查看 ")])]}}])}),t("div",{staticStyle:{"text-align":"center",margin:"16px 0"}},[t("Page",{attrs:{transfer:!0,total:e.total,current:e.current,"page-size-opts":[10,20,50,100],"page-size":10,"show-total":"","show-sizer":"","show-elevator":""},on:{"update:current":function(a){e.current=a},"on-change":e.getMigrationTasks,"on-page-size-change":e.handleChangeSize}})],1),t("Modal",{attrs:{width:"1200px"},model:{value:e.replicationDetail.show,callback:function(a){e.$set(e.replicationDetail,"show",a)},expression:"replicationDetail.show"}},[t("Divider",{attrs:{orientation:"left"}},[e._v("相关 DRC 延迟")]),t("Table",{attrs:{stripe:"",loading:e.replicationDetail.mhaReplicationDataLoading,columns:e.detailColumn,data:e.replicationDetail.data,border:""}}),t("Divider",{attrs:{orientation:"left"}},[e._v("相关 Messenger 延迟")]),t("Table",{attrs:{stripe:"",loading:e.replicationDetail.messengerDataLoading,columns:e.messengerDetailColumn,data:e.replicationDetail.messengerData,border:""}})],1)],1)])],1)},r=[],s=(t("a15b"),t("b0c0"),t("d3b7"),t("53ca")),n=t("a3b8"),o=t.n(n),c=(t("7a7a"),t("d5e0"),t("697e"),t("cbc8"),{name:"Application",data:function(){function e(){return function(e,a){var t,i,r=a.row.delayInfoDto,s=a.row.srcMha.monitorSwitch,n=r.delay,c="";if(null!=n&&n<1e4)t="blue",i=o()(n);else{if(t="volcano",i=n?o()(n):0===s?"查询失败, 未打开延迟监控":"查询失败",r.srcTime){var l=new Date(r.srcTime);c+="源集群: "+l.toLocaleDateString()+" "+l.toLocaleTimeString()+"\n"}if(r.dstTime){var u=new Date(r.dstTime);r.dstMha?c+="端集群: ":c+="Messenger: ",c+=u.toLocaleDateString()+" "+u.toLocaleTimeString()}}return e("div",[e("Tag",{props:{color:t}},i),e("div",{style:{"white-space":"pre-wrap"}},c)])}}return{detailColumn:[{title:"状态",key:"status",width:100,align:"center",render:function(e,a){var t=a.row,i=1===t.status?"blue":"volcano",r=1===t.status?"已接入":"未接入";return e("Tag",{props:{color:i}},r)}},{title:"srcMha",width:150,key:"id",render:function(e,a){return e("p",a.row.srcMha.name)}},{title:"dstMha",width:150,key:"id",render:function(e,a){return e("p",a.row.dstMha.name)}},{title:"delay",key:"delay",render:e()},{title:"dbs",key:"dbs",render:function(e,a){return e("p",a.row.dbs.join(","))}}],messengerDetailColumn:[{title:"srcMha",width:150,key:"id",render:function(e,a){return e("p",a.row.srcMha.name)}},{title:"delay",key:"delay",render:e()},{title:"dbs",key:"dbs",render:function(e,a){return e("p",a.row.dbs.join(","))}}],columns:[{title:"状态",key:"status",width:150,align:"center",render:function(e,a){var t=a.row,i="blue",r=t.status;return e("Tag",{props:{color:i}},r)}},{title:"ID",width:80,key:"id",render:function(e,a){return e("p",a.row.id)}},{title:"DB",key:"srcMhaName",render:function(e,a){return e("p",a.row.dbs.join(","))}},{title:"老集群名",key:"srcMhaName",render:function(e,a){return e("p",a.row.oldMha)}},{title:"新集群名",key:"dstMhaName",render:function(e,a){return e("p",a.row.newMha)}},{title:"操作人",key:"operator",render:function(e,a){return e("p",a.row.operator)}},{title:"操作",slot:"action",align:"center"}],total:0,current:1,size:10,queryParam:{dbName:"",oldMha:"",newMha:"",status:"",operator:""},migrationTasks:[],bus:[],regions:[],status:[],replicationDetail:{show:!1,row:{},mhaReplicationDataLoading:!1,data:[],messengerDataLoading:!1,messengerData:[]},dataLoading:!0}},computed:{},methods:{getBus:function(){var e=this;this.axios.get("/api/drc/v2/meta/bus/all").then((function(a){e.bus=a.data.data}))},getRegions:function(){var e=this;this.axios.get("/api/drc/v2/meta/regions/all").then((function(a){e.regions=a.data.data}))},getStatus:function(){var e=this;this.axios.get("/api/drc/v2/migration/allStatus").then((function(a){e.status=a.data.data}))},flattenObj:function(e){var a={};for(var t in e)if("object"!==Object(s["a"])(e[t])||Array.isArray(e[t]))a[t]=e[t];else{var i=this.flattenObj(e[t]);for(var r in i)a[t+"."+r]=i[r]}return a},resetParam:function(){this.queryParam={},this.getMigrationTasks()},getMigrationTasks:function(){var e=this,a=this.flattenObj(this.queryParam);e.dataLoading=!0,e.axios.get("/api/drc/v2/migration/query",{params:a}).then((function(a){var t=a.data.data;t&&0!==t.totalCount?(e.total=t.totalCount,e.current=t.pageIndex,e.migrationTasks=t.data,e.$Message.success("查询成功")):(e.total=0,e.current=1,e.migrationTasks=[],e.$Message.warning("查询结果为空"))})).catch((function(a){e.$Message.error("查询异常: "+a)})).finally((function(){e.dataLoading=!1}))},handleChangeSize:function(e){var a=this;this.size=e,this.$nextTick((function(){a.getMigrationTasks()}))},getMhaReplicationDetail:function(e){var a=this;this.replicationDetail.mhaReplicationDataLoading=!0,this.replicationDetail.data=[],this.axios.get("/api/drc/v2/replication/relatedReplicationDelay",{params:{mhas:[e.oldMha,e.newMha].join(","),dbs:e.dbs.join(",")}}).then((function(t){1!==t.data.status?(a.replicationDetail.data=t.data.data,console.log(a.replicationDetail.data),a.replicationDetail.show=!0,a.replicationDetail.row=e,a.replicationDetail.mhaReplicationDataLoading=!1):a.$Message.warning("查询异常: "+t.data.message)})).catch((function(e){a.$Message.error("查询异常: "+e)})).finally((function(){}))},getMhaMessengerDetail:function(e){var a=this;this.replicationDetail.messengerDataLoading=!0,this.replicationDetail.messengerData=[],this.axios.get("/api/drc/v2/messenger/delay",{params:{mhas:[e.oldMha,e.newMha].join(","),dbs:e.dbs.join(",")}}).then((function(e){1!==e.data.status?(a.replicationDetail.messengerData=e.data.data,console.log(a.replicationDetail.messengerData),a.replicationDetail.messengerDataLoading=!1):a.$Message.warning("查询异常: "+e.data.message)})).catch((function(e){a.$Message.error("查询异常: "+e)})).finally((function(){}))},getDetail:function(e,a){this.replicationDetail.show=!0,this.replicationDetail.row=e,this.getMhaReplicationDetail(e),this.getMhaMessengerDetail(e)}},created:function(){this.getMigrationTasks(),this.getStatus()}}),l=c,u=(t("0c77"),t("2877")),d=Object(u["a"])(l,i,r,!1,null,"e95c7cf2",null);a["default"]=d.exports},"491b":function(e,a,t){},"53ca":function(e,a,t){"use strict";t.d(a,"a",(function(){return i}));t("a4d3"),t("e01a"),t("d28b"),t("e260"),t("d3b7"),t("3ca3"),t("ddb0");function i(e){return i="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}},7252:function(e,a,t){"use strict";e.exports=function(e){if("number"!==typeof e)throw new TypeError("Expected a number");var a=e>0?Math.floor:Math.ceil;return{days:a(e/864e5),hours:a(e/36e5)%24,minutes:a(e/6e4)%60,seconds:a(e/1e3)%60,milliseconds:a(e)%1e3}}},"86aa":function(e){e.exports=JSON.parse('{"addendum":"addenda","aircraft":"aircraft","alga":"algae","alumna":"alumnae","alumnus":"alumni","amoeba":"amoebae","analysis":"analyses","antenna":"antennae","antithesis":"antitheses","apex":"apices","appendix":"appendices","automaton":"automata","axis":"axes","bacillus":"bacilli","bacterium":"bacteria","barracks":"barracks","basis":"bases","beau":"beaux","bison":"bison","buffalo":"buffalo","bureau":"bureaus","cactus":"cacti","calf":"calves","carp":"carp","census":"censuses","chassis":"chassis","cherub":"cherubim","child":"children","château":"châteaus","cod":"cod","codex":"codices","concerto":"concerti","corpus":"corpora","crisis":"crises","criterion":"criteria","curriculum":"curricula","datum":"data","deer":"deer","diagnosis":"diagnoses","die":"dice","dwarf":"dwarfs","echo":"echoes","elf":"elves","elk":"elk","ellipsis":"ellipses","embargo":"embargoes","emphasis":"emphases","erratum":"errata","faux pas":"faux pas","fez":"fezes","firmware":"firmware","fish":"fish","focus":"foci","foot":"feet","formula":"formulae","fungus":"fungi","gallows":"gallows","genus":"genera","goose":"geese","graffito":"graffiti","grouse":"grouse","half":"halves","hero":"heroes","hoof":"hooves","hovercraft":"hovercraft","hypothesis":"hypotheses","index":"indices","kakapo":"kakapo","knife":"knives","larva":"larvae","leaf":"leaves","libretto":"libretti","life":"lives","loaf":"loaves","locus":"loci","louse":"lice","man":"men","matrix":"matrices","means":"means","medium":"media","memorandum":"memoranda","millennium":"millennia","minutia":"minutiae","moose":"moose","mouse":"mice","nebula":"nebulae","nemesis":"nemeses","neurosis":"neuroses","news":"news","nucleus":"nuclei","oasis":"oases","offspring":"offspring","opus":"opera","ovum":"ova","ox":"oxen","paralysis":"paralyses","parenthesis":"parentheses","person":"people","phenomenon":"phenomena","phylum":"phyla","pike":"pike","polyhedron":"polyhedra","potato":"potatoes","prognosis":"prognoses","quiz":"quizzes","radius":"radii","referendum":"referenda","salmon":"salmon","scarf":"scarves","self":"selves","series":"series","sheep":"sheep","shelf":"shelves","shrimp":"shrimp","spacecraft":"spacecraft","species":"species","spectrum":"spectra","squid":"squid","stimulus":"stimuli","stratum":"strata","swine":"swine","syllabus":"syllabi","symposium":"symposia","synopsis":"synopses","synthesis":"syntheses","tableau":"tableaus","that":"those","thesis":"theses","thief":"thieves","this":"these","tomato":"tomatoes","tooth":"teeth","trout":"trout","tuna":"tuna","vertebra":"vertebrae","vertex":"vertices","veto":"vetoes","vita":"vitae","vortex":"vortices","watercraft":"watercraft","wharf":"wharves","wife":"wives","wolf":"wolves","woman":"women"}')},a15b:function(e,a,t){"use strict";var i=t("23e7"),r=t("44ad"),s=t("fc6a"),n=t("a640"),o=[].join,c=r!=Object,l=n("join",",");i({target:"Array",proto:!0,forced:c||!l},{join:function(e){return o.call(s(this),void 0===e?",":e)}})},a3b8:function(e,a,t){"use strict";const i=t("7252"),r=t("afa5");e.exports=(e,a)=>{if(!Number.isFinite(e))throw new TypeError("Expected a finite number");if(a=a||{},e<1e3){const t="number"===typeof a.msDecimalDigits?a.msDecimalDigits:0;return(t?e.toFixed(t):Math.ceil(e))+(a.verbose?" "+r("millisecond",Math.ceil(e)):"ms")}const t=[],s=(e,i,s,n)=>{if(0===e)return;const o=a.verbose?" "+r(i,e):s;t.push((n||e)+o)},n=i(e);if(s(Math.trunc(n.days/365),"year","y"),s(n.days%365,"day","d"),s(n.hours,"hour","h"),s(n.minutes,"minute","m"),a.compact)return s(n.seconds,"second","s"),"~"+t[0];const o=e/1e3%60,c="number"===typeof a.secDecimalDigits?a.secDecimalDigits:1,l=o.toFixed(c).replace(/\.0$/,"");return s(o,"second","s",l),t.join(" ")}},a640:function(e,a,t){"use strict";var i=t("d039");e.exports=function(e,a){var t=[][e];return!!t&&i((function(){t.call(null,a||function(){throw 1},1)}))}},afa5:function(e,a,t){"use strict";var i=t("86aa");e.exports=function(e,a,t){return"number"===typeof a&&(t=a),e in i?a=i[e]:"string"!==typeof a&&(a=(e.replace(/(?:s|x|z|ch|sh)$/i,"$&e").replace(/([^aeiou])y$/i,"$1ie")+"s").replace(/i?e?s$/i,(function(a){var t=e.slice(-1)===e.slice(-1).toLowerCase();return t?a.toLowerCase():a.toUpperCase()}))),1===t?e:a}},b0c0:function(e,a,t){var i=t("83ab"),r=t("9bf2").f,s=Function.prototype,n=s.toString,o=/^\s*function ([^ (]*)/,c="name";i&&!(c in s)&&r(s,c,{configurable:!0,get:function(){try{return n.call(this).match(o)[1]}catch(e){return""}}})}}]);
//# sourceMappingURL=chunk-76b982ae.7338cf08.js.map