(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e9adc6a8","chunk-5e52595a"],{"159b":function(e,t,a){var n=a("da84"),r=a("fdbc"),o=a("17c2"),i=a("9112");for(var s in r){var l=n[s],c=l&&l.prototype;if(c&&c.forEach!==o)try{i(c,"forEach",o)}catch(u){c.forEach=o}}},"17c2":function(e,t,a){"use strict";var n=a("b727").forEach,r=a("a640"),o=a("ae40"),i=r("forEach"),s=o("forEach");e.exports=i&&s?[].forEach:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}},4895:function(e,t,a){(function(e){e(a("56b3"))})((function(e){"use strict";function t(t,n,o,i){if(o&&o.call){var s=o;o=null}else s=r(t,o,"rangeFinder");"number"==typeof n&&(n=e.Pos(n,0));var l=r(t,o,"minFoldSize");function c(e){var a=s(t,n);if(!a||a.to.line-a.from.line<l)return null;if("fold"===i)return a;for(var r=t.findMarksAt(a.from),o=0;o<r.length;++o)if(r[o].__isFold){if(!e)return null;a.cleared=!0,r[o].clear()}return a}var u=c(!0);if(r(t,o,"scanUp"))while(!u&&n.line>t.firstLine())n=e.Pos(n.line-1,0),u=c(!1);if(u&&!u.cleared&&"unfold"!==i){var p=a(t,o,u);e.on(p,"mousedown",(function(t){d.clear(),e.e_preventDefault(t)}));var d=t.markText(u.from,u.to,{replacedWith:p,clearOnEnter:r(t,o,"clearOnEnter"),__isFold:!0});d.on("clear",(function(a,n){e.signal(t,"unfold",t,a,n)})),e.signal(t,"fold",t,u.from,u.to)}}function a(e,t,a){var n=r(e,t,"widget");if("function"==typeof n&&(n=n(a.from,a.to)),"string"==typeof n){var o=document.createTextNode(n);n=document.createElement("span"),n.appendChild(o),n.className="CodeMirror-foldmarker"}else n&&(n=n.cloneNode(!0));return n}e.newFoldFunction=function(e,a){return function(n,r){t(n,r,{rangeFinder:e,widget:a})}},e.defineExtension("foldCode",(function(e,a,n){t(this,e,a,n)})),e.defineExtension("isFolded",(function(e){for(var t=this.findMarksAt(e),a=0;a<t.length;++a)if(t[a].__isFold)return!0})),e.commands.toggleFold=function(e){e.foldCode(e.getCursor())},e.commands.fold=function(e){e.foldCode(e.getCursor(),null,"fold")},e.commands.unfold=function(e){e.foldCode(e.getCursor(),{scanUp:!1},"unfold")},e.commands.foldAll=function(t){t.operation((function(){for(var a=t.firstLine(),n=t.lastLine();a<=n;a++)t.foldCode(e.Pos(a,0),{scanUp:!1},"fold")}))},e.commands.unfoldAll=function(t){t.operation((function(){for(var a=t.firstLine(),n=t.lastLine();a<=n;a++)t.foldCode(e.Pos(a,0),{scanUp:!1},"unfold")}))},e.registerHelper("fold","combine",(function(){var e=Array.prototype.slice.call(arguments,0);return function(t,a){for(var n=0;n<e.length;++n){var r=e[n](t,a);if(r)return r}}})),e.registerHelper("fold","auto",(function(e,t){for(var a=e.getHelpers(t,"fold"),n=0;n<a.length;n++){var r=a[n](e,t);if(r)return r}}));var n={rangeFinder:e.fold.auto,widget:"↔",minFoldSize:0,scanUp:!1,clearOnEnter:!0};function r(e,t,a){if(t&&void 0!==t[a])return t[a];var r=e.options.foldOptions;return r&&void 0!==r[a]?r[a]:n[a]}e.defineOption("foldOptions",null),e.defineExtension("foldOption",(function(e,t){return r(this,e,t)}))}))},"53ca":function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));a("a4d3"),a("e01a"),a("d28b"),a("e260"),a("d3b7"),a("3ca3"),a("ddb0");function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}},"5c86":function(e,t,a){"use strict";a("692d")},6062:function(e,t,a){"use strict";var n=a("6d61"),r=a("6566");e.exports=n("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),r)},"692d":function(e,t,a){},"697e":function(e,t,a){},7252:function(e,t,a){"use strict";e.exports=function(e){if("number"!==typeof e)throw new TypeError("Expected a number");var t=e>0?Math.floor:Math.ceil;return{days:t(e/864e5),hours:t(e/36e5)%24,minutes:t(e/6e4)%60,seconds:t(e/1e3)%60,milliseconds:t(e)%1e3}}},"7a7a":function(e,t,a){},"857a":function(e,t,a){var n=a("1d80"),r=/"/g;e.exports=function(e,t,a,o){var i=String(n(e)),s="<"+t;return""!==a&&(s+=" "+a+'="'+String(o).replace(r,"&quot;")+'"'),s+">"+i+"</"+t+">"}},"86aa":function(e){e.exports=JSON.parse('{"addendum":"addenda","aircraft":"aircraft","alga":"algae","alumna":"alumnae","alumnus":"alumni","amoeba":"amoebae","analysis":"analyses","antenna":"antennae","antithesis":"antitheses","apex":"apices","appendix":"appendices","automaton":"automata","axis":"axes","bacillus":"bacilli","bacterium":"bacteria","barracks":"barracks","basis":"bases","beau":"beaux","bison":"bison","buffalo":"buffalo","bureau":"bureaus","cactus":"cacti","calf":"calves","carp":"carp","census":"censuses","chassis":"chassis","cherub":"cherubim","child":"children","château":"châteaus","cod":"cod","codex":"codices","concerto":"concerti","corpus":"corpora","crisis":"crises","criterion":"criteria","curriculum":"curricula","datum":"data","deer":"deer","diagnosis":"diagnoses","die":"dice","dwarf":"dwarfs","echo":"echoes","elf":"elves","elk":"elk","ellipsis":"ellipses","embargo":"embargoes","emphasis":"emphases","erratum":"errata","faux pas":"faux pas","fez":"fezes","firmware":"firmware","fish":"fish","focus":"foci","foot":"feet","formula":"formulae","fungus":"fungi","gallows":"gallows","genus":"genera","goose":"geese","graffito":"graffiti","grouse":"grouse","half":"halves","hero":"heroes","hoof":"hooves","hovercraft":"hovercraft","hypothesis":"hypotheses","index":"indices","kakapo":"kakapo","knife":"knives","larva":"larvae","leaf":"leaves","libretto":"libretti","life":"lives","loaf":"loaves","locus":"loci","louse":"lice","man":"men","matrix":"matrices","means":"means","medium":"media","memorandum":"memoranda","millennium":"millennia","minutia":"minutiae","moose":"moose","mouse":"mice","nebula":"nebulae","nemesis":"nemeses","neurosis":"neuroses","news":"news","nucleus":"nuclei","oasis":"oases","offspring":"offspring","opus":"opera","ovum":"ova","ox":"oxen","paralysis":"paralyses","parenthesis":"parentheses","person":"people","phenomenon":"phenomena","phylum":"phyla","pike":"pike","polyhedron":"polyhedra","potato":"potatoes","prognosis":"prognoses","quiz":"quizzes","radius":"radii","referendum":"referenda","salmon":"salmon","scarf":"scarves","self":"selves","series":"series","sheep":"sheep","shelf":"shelves","shrimp":"shrimp","spacecraft":"spacecraft","species":"species","spectrum":"spectra","squid":"squid","stimulus":"stimuli","stratum":"strata","swine":"swine","syllabus":"syllabi","symposium":"symposia","synopsis":"synopses","synthesis":"syntheses","tableau":"tableaus","that":"those","thesis":"theses","thief":"thieves","this":"these","tomato":"tomatoes","tooth":"teeth","trout":"trout","tuna":"tuna","vertebra":"vertebrae","vertex":"vertices","veto":"vetoes","vita":"vitae","vortex":"vortices","watercraft":"watercraft","wharf":"wharves","wife":"wives","wolf":"wolves","woman":"women"}')},9911:function(e,t,a){"use strict";var n=a("23e7"),r=a("857a"),o=a("af03");n({target:"String",proto:!0,forced:o("link")},{link:function(e){return r(this,"a","href",e)}})},"99af":function(e,t,a){"use strict";var n=a("23e7"),r=a("d039"),o=a("e8b5"),i=a("861d"),s=a("7b0b"),l=a("50c4"),c=a("8418"),u=a("65f0"),p=a("1dde"),d=a("b622"),f=a("2d00"),h=d("isConcatSpreadable"),g=9007199254740991,m="Maximum allowed index exceeded",v=f>=51||!r((function(){var e=[];return e[h]=!1,e.concat()[0]!==e})),b=p("concat"),y=function(e){if(!i(e))return!1;var t=e[h];return void 0!==t?!!t:o(e)},w=!v||!b;n({target:"Array",proto:!0,forced:w},{concat:function(e){var t,a,n,r,o,i=s(this),p=u(i,0),d=0;for(t=-1,n=arguments.length;t<n;t++)if(o=-1===t?i:arguments[t],y(o)){if(r=l(o.length),d+r>g)throw TypeError(m);for(a=0;a<r;a++,d++)a in o&&c(p,d,o[a])}else{if(d>=g)throw TypeError(m);c(p,d++,o)}return p.length=d,p}})},"9a28":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("base-component",[a("Breadcrumb",{style:{margin:"15px 0 15px 185px",position:"fixed"}},[a("BreadcrumbItem",{attrs:{to:"/home"}},[e._v("首页")])],1),a("Content",{staticClass:"content",style:{padding:"10px",background:"#fff",margin:"50px 0 1px 185px",zIndex:"1"}},[a("div",{staticStyle:{padding:"1px 1px"}},[a("Row",{attrs:{gutter:10,align:"middle"}},[a("Col",{attrs:{span:"16"}},[a("Card",{attrs:{padding:5},scopedSlots:e._u([{key:"title",fn:function(){return[e._v("查询条件")]},proxy:!0}])},[a("Row",{attrs:{gutter:10}},[a("Col",{attrs:{span:"8"}},[a("Input",{attrs:{prefix:"ios-search",placeholder:"ip"},on:{"on-enter":e.getResources},model:{value:e.queryParam.ip,callback:function(t){e.$set(e.queryParam,"ip",t)},expression:"queryParam.ip"}})],1),a("Col",{attrs:{span:"4"}},[a("Select",{attrs:{filterable:"",clearable:"",placeholder:"类型"},on:{"on-change":e.getResources},model:{value:e.queryParam.type,callback:function(t){e.$set(e.queryParam,"type",t)},expression:"queryParam.type"}},e._l(e.typeList,(function(t){return a("Option",{key:t.val,attrs:{value:t.val}},[e._v(e._s(t.name))])})),1)],1),a("Col",{attrs:{span:"4"}},[a("Select",{attrs:{filterable:"",clearable:"",placeholder:"地域"},on:{"on-change":e.getResources},model:{value:e.queryParam.region,callback:function(t){e.$set(e.queryParam,"region",t)},expression:"queryParam.region"}},e._l(e.regions,(function(t){return a("Option",{key:t.regionName,attrs:{value:t.regionName}},[e._v(" "+e._s(t.regionName)+" ")])})),1)],1),a("Col",{attrs:{span:"4"}},[a("Select",{attrs:{filterable:"",clearable:"","allow-create":"",placeholder:"tag"},on:{"on-change":e.getResources,"on-create":e.handleAddTag},model:{value:e.queryParam.tag,callback:function(t){e.$set(e.queryParam,"tag",t)},expression:"queryParam.tag"}},e._l(e.tagList,(function(t){return a("Option",{key:t,attrs:{value:t}},[e._v(e._s(t))])})),1)],1),a("Col",{attrs:{span:"4"}},[a("Select",{attrs:{filterable:"",clearable:"",placeholder:"启用状态"},on:{"on-change":e.getResources},model:{value:e.queryParam.active,callback:function(t){e.$set(e.queryParam,"active",t)},expression:"queryParam.active"}},e._l(e.activeList,(function(t){return a("Option",{key:t.val,attrs:{value:t.val}},[e._v(e._s(t.name))])})),1)],1)],1)],1)],1),a("Col",{attrs:{span:"1"}},[a("Button",{attrs:{type:"primary",icon:"ios-search",loading:e.dataLoading},on:{click:e.getResources}},[e._v("查询")]),a("Button",{staticStyle:{"margin-top":"20px"},attrs:{icon:"md-refresh",loading:e.dataLoading},on:{click:e.resetParam}},[e._v("重置")])],1)],1),a("br"),a("Row",{staticStyle:{background:"#fdfdff",border:"1px solid #e8eaec"}},[a("Col",{staticStyle:{display:"flex",float:"left",margin:"5px"},attrs:{span:"2"}},[a("Dropdown",{attrs:{placement:"bottom-start"},scopedSlots:e._u([{key:"list",fn:function(){return[a("DropdownMenu",[a("DropdownItem",{nativeOn:{click:function(t){return function(){e.$router.push({path:"/drcResource"})}.apply(null,arguments)}}},[e._v("资源录入")])],1)]},proxy:!0}])},[a("Button",{attrs:{type:"default",icon:"ios-hammer"}},[e._v(" 操作 "),a("Icon",{attrs:{type:"ios-arrow-down"}})],1)],1)],1)],1),a("Table",{attrs:{stripe:"",border:"",columns:e.columns,data:e.resources},scopedSlots:e._u([{key:"action",fn:function(t){var n=t.row,r=t.index;return[a("Dropdown",{attrs:{transfer:!0,placement:"bottom-start"},scopedSlots:e._u([{key:"list",fn:function(){return[a("DropdownMenu",[a("DropdownItem",[a("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"success",size:"small"},on:{click:function(t){return e.showMigrateInfo(n,r)}}},[e._v(" 实例迁移 ")])],1),a("DropdownItem",[a("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"error",size:"small"},on:{click:function(t){return e.preDeleteResource(n,r)}}},[e._v(" 下线 ")])],1)],1)]},proxy:!0}],null,!0)},[a("Button",{attrs:{type:"default",icon:"ios-hammer"}},[e._v(" 操作 "),a("Icon",{attrs:{type:"ios-arrow-down"}})],1)],1)]}}])}),a("div",{staticStyle:{"text-align":"center",margin:"16px 0"}},[a("Page",{attrs:{transfer:!0,total:e.total,current:e.current,"page-size-opts":[10,20,50,100],"page-size":10,"show-total":"","show-sizer":"","show-elevator":""},on:{"update:current":function(t){e.current=t},"on-change":e.getResources,"on-page-size-change":e.handleChangeSize}})],1),a("Modal",{attrs:{title:"确认删除以下机器资源"},on:{"on-ok":e.deleteResource,"on-cancel":e.clearDeleteResource},model:{value:e.deleteResourceModal,callback:function(t){e.deleteResourceModal=t},expression:"deleteResourceModal"}},[a("p",[e._v('ip: "'+e._s(e.deleteResourceInfo.ip)+'" ,tag: "'+e._s(e.deleteResourceInfo.tag)+'" az: "'+e._s(e.deleteResourceInfo.az)+'"')]),a("p",[a("span",[e._v("部署实例数量: ")]),a("span",{staticStyle:{color:"red","font-size":"20px"}},[e._v(e._s(e.deleteResourceInfo.instanceNum))])])]),a("Modal",{attrs:{title:1===e.migrateApplierInfo.oldIpInfo.type?"applier实例迁移":"messenger实例迁移","footer-hide":!0,width:"900px",scrollable:!0,draggable:!0},model:{value:e.migrateApplierInfo.modal,callback:function(t){e.$set(e.migrateApplierInfo,"modal",t)},expression:"migrateApplierInfo.modal"}},[a("Row",{attrs:{gutter:10}},[a("Col",{attrs:{span:"4"}},[a("span",[e._v("当前ip: ")]),a("span",{staticStyle:{color:"red","font-size":"15px"}},[e._v(e._s(e.migrateApplierInfo.oldIpInfo.ip))])]),a("Col",{attrs:{span:"4"}},[a("span",[e._v("  tag: ")]),a("span",{staticStyle:{color:"red","font-size":"15px"}},[e._v(e._s(e.migrateApplierInfo.oldIpInfo.tag))])]),a("Col",{attrs:{span:"4"}},[a("span",[e._v("  AZ: ")]),a("span",{staticStyle:{color:"red","font-size":"15px"}},[e._v(e._s(e.migrateApplierInfo.oldIpInfo.az))])])],1),a("Form",[a("FormItem",{attrs:{label:"选择目标ip"}},[a("Select",{staticStyle:{width:"400px"},attrs:{filterable:"",clearable:"",placeholder:"目标ip"},model:{value:e.migrateApplierInfo.newIp,callback:function(t){e.$set(e.migrateApplierInfo,"newIp",t)},expression:"migrateApplierInfo.newIp"}},e._l(e.migrateApplierInfo.ipChooseList,(function(t){return a("Option",{key:t,attrs:{value:t}},[e._v(" "+e._s(t)+" ")])})),1),a("Button",{staticStyle:{"margin-left":"100px"},attrs:{type:"primary",loading:e.migrateApplierInfo.loading2},on:{click:e.migrateAllApplierOrMessenger}},[e._v("全部实例迁移")])],1),a("FormItem",[a("Table",{ref:"multipleTable",attrs:{stripe:"",border:"",columns:e.migrateApplierInfo.columns,data:e.aDataWithPage},on:{"on-selection-change":e.changeSelectionA}}),a("div",[a("Page",{attrs:{transfer:!0,total:e.migrateApplierInfo.tableData.length,current:e.migrateApplierInfo.current,"page-size-opts":e.migrateApplierInfo.pageSizeOpts,"page-size":this.migrateApplierInfo.size,"show-total":"","show-sizer":"","show-elevator":""},on:{"update:current":function(t){return e.$set(e.migrateApplierInfo,"current",t)},"on-page-size-change":e.aHandleChangeSize}})],1)],1),a("FormItem",[a("Button",{attrs:{type:"primary",loading:e.migrateApplierInfo.loading},on:{click:e.migrateApplierOrMessenger}},[e._v("迁移")]),a("Button",{staticStyle:{"margin-left":"100px"},attrs:{type:"success"},on:{click:e.refreshMigrateApplier}},[e._v("刷新")])],1)],1)],1),a("Modal",{attrs:{title:"replicator实例迁移","footer-hide":!0,width:"900px",scrollable:!0,draggable:!0},model:{value:e.migrateReplicatorInfo.modal,callback:function(t){e.$set(e.migrateReplicatorInfo,"modal",t)},expression:"migrateReplicatorInfo.modal"}},[a("Row",{attrs:{gutter:10}},[a("Col",{attrs:{span:"4"}},[a("span",[e._v("当前ip: ")]),a("span",{staticStyle:{color:"red","font-size":"15px"}},[e._v(e._s(e.migrateReplicatorInfo.oldIpInfo.ip))])]),a("Col",{attrs:{span:"4"}},[a("span",[e._v("  tag: ")]),a("span",{staticStyle:{color:"red","font-size":"15px"}},[e._v(e._s(e.migrateReplicatorInfo.oldIpInfo.tag))])]),a("Col",{attrs:{span:"4"}},[a("span",[e._v("  AZ: ")]),a("span",{staticStyle:{color:"red","font-size":"15px"}},[e._v(e._s(e.migrateReplicatorInfo.oldIpInfo.az))])])],1),a("Form",[a("FormItem",{attrs:{label:"选择目标ip"}},[a("Select",{staticStyle:{width:"400px"},attrs:{filterable:"",clearable:"",placeholder:"目标ip"},model:{value:e.migrateReplicatorInfo.newIp,callback:function(t){e.$set(e.migrateReplicatorInfo,"newIp",t)},expression:"migrateReplicatorInfo.newIp"}},e._l(e.migrateReplicatorInfo.ipChooseList,(function(t){return a("Option",{key:t,attrs:{value:t}},[e._v(" "+e._s(t)+" ")])})),1)],1),a("FormItem",[a("Table",{ref:"multipleTable",attrs:{stripe:"",border:"",columns:e.migrateReplicatorInfo.columns,data:e.rDataWithPage},on:{"on-selection-change":e.changeSelectionR}}),a("div",[a("Page",{attrs:{transfer:!0,total:e.migrateReplicatorInfo.tableData.length,current:e.migrateReplicatorInfo.current,"page-size-opts":e.migrateReplicatorInfo.pageSizeOpts,"page-size":this.migrateReplicatorInfo.size,"show-total":"","show-sizer":"","show-elevator":""},on:{"update:current":function(t){return e.$set(e.migrateReplicatorInfo,"current",t)},"on-page-size-change":e.rHandleChangeSize}})],1)],1),a("FormItem",[a("Button",{attrs:{type:"primary",loading:e.migrateReplicatorInfo.loading},on:{click:e.migrateReplicator}},[e._v("迁移")]),a("Button",{staticStyle:{"margin-left":"100px"},attrs:{type:"success"},on:{click:e.refreshMigrateReplicator}},[e._v("刷新")])],1)],1)],1),a("Modal",{attrs:{title:"关联mha",width:"900px",scrollable:!0,draggable:!0},model:{value:e.relatedMhaData.modal,callback:function(t){e.$set(e.relatedMhaData,"modal",t)},expression:"relatedMhaData.modal"}},[a("Table",{attrs:{stripe:"",border:"",columns:e.relatedMhaData.columns,data:e.relatedMhaData.tableData}})],1),a("Modal",{attrs:{title:"关联复制链路",width:"900px",scrollable:!0,draggable:!0},model:{value:e.relatedReplicationData.modal,callback:function(t){e.$set(e.relatedReplicationData,"modal",t)},expression:"relatedReplicationData.modal"}},[a("Table",{attrs:{stripe:"",border:"",columns:e.relatedReplicationData.columns,data:e.relatedReplicationData.tableData}})],1)],1)])],1)},r=[],o=a("53ca"),i=a("2909"),s=(a("99af"),a("fb6a"),a("d3b7"),a("159b"),a("fcc1"),a("7a7a"),a("d5e0"),a("697e"),a("cbc8"),{name:"resourceV2",data:function(){var e=this;return{columns:[{title:"类型",key:"type",width:80,render:function(t,a){var n=a.row,r="none",o="error",i=!1;switch(n.type){case 0:r="R",o="info";break;case 1:r="A",o="success";break;case 7:r="M",o="warning";break;default:r="无",i=!0;break}return t("Button",{props:{type:o,size:"small",disabled:i},on:{click:function(){e.showModal(n)}}},r)}},{title:"ip",key:"ip"},{title:"tag",key:"tag"},{title:"AZ",key:"az",sortable:!0},{title:"部署实例数量",key:"instanceNum",sortable:!0},{title:"启用状态",key:"active",sortable:!0,align:"center",render:function(t,a){var n=a.row;return t("i-switch",{props:{size:"large",value:1===n.active,beforeChange:e.handleBeforeChange},scopedSlots:{open:function(){return t("span","开启")},close:function(){return t("span","关闭")}},on:{"on-change":function(){e.switchActiveStatus(n.resourceId,n.active)}}})}},{title:"操作",slot:"action",align:"center"}],total:0,current:1,size:10,resources:[],typeList:[{name:"Replicator",val:0},{name:"Applier",val:1},{name:"Messenger",val:7}],activeList:[{name:"启用",val:1},{name:"停用",val:0}],regions:[],tagList:this.constant.tagList,deleteResourceModal:!1,relatedReplicationData:{tableData:[],modal:!1,columns:[{title:"序号",width:75,align:"center",render:function(e,t){return e("span",t.index+1)}},{title:"类型",key:"type",width:200,render:function(t,a){var n=a.row,r="none",o="error",i=!1;switch(n.type){case 1:r="Applier",o="info";break;case 2:r="DbApplier",o="success";break;case 3:r="Messenger",o="warning";break;case 4:r="DbMessenger",o="primary";break;default:r="无",i=!0;break}return r="".concat(r," (").concat(n.mqType,")"),t("Button",{props:{type:o,size:"small",disabled:i},on:{click:function(){e.showModal(n)}}},r)}},{title:"同步链路",key:"relatedId",render:function(t,a){var n=a.row,r=n.type,o="";return 1===r?o=n.srcMhaName+"("+n.srcDcName+") => "+n.dstMhaName+"("+n.dstDcName+")":2===r?o=n.srcMhaName+"("+n.srcDcName+") => "+n.dstMhaName+"("+n.dstDcName+") db: "+n.dbName:3===r?o=n.srcMhaName+"("+n.srcDcName+")":4===r&&(o=n.srcMhaName+"("+n.srcDcName+") db: "+n.dbName),t("a",{props:{type:"info",size:"small",disabled:!1},on:{click:function(){1===r?e.toMhaReplication(n):2===r?e.toMhaDbReplication(n):3===r&&e.toMessenger(n)}}},o)}}]},relatedMhaData:{tableData:[],modal:!1,columns:[{title:"序号",width:75,align:"center",render:function(e,t){return e("span",t.index+1)}},{title:"mha",key:"mhaName",render:function(t,a){var n=a.row,r=n.mhaName;return t("a",{props:{type:"info",size:"small",disabled:!1},on:{click:function(){e.toMhaReplicationByR(n)}}},r)}}]},migrateApplierInfo:{loading:!1,loading2:!1,modal:!1,newIp:"",ipChooseList:[],oldIpInfo:{ip:"",tag:"",az:"",resourceId:null,type:null},migrateDataList:[],tableData:[],columns:[{type:"selection",width:60,align:"center"},{title:"序号",width:75,align:"center",render:function(e,t){return e("span",t.index+1)}},{title:"类型",key:"type",width:200,render:function(t,a){var n=a.row,r="none",o="error",i=!1;switch(n.type){case 1:r="Applier",o="info";break;case 2:r="DbApplier",o="success";break;case 3:r="Messenger (".concat(n.mqType,")"),o="warning";break;case 4:r="DbMessenger",o="primary";break;default:r="无",i=!0;break}return t("Button",{props:{type:o,size:"small",disabled:i},on:{click:function(){e.showModal(n)}}},r)}},{title:"同步链路",key:"relatedId",render:function(t,a){var n=a.row,r=n.type,o="";return 1===r?o=n.srcMhaName+"("+n.srcDcName+") => "+n.dstMhaName+"("+n.dstDcName+")":2===r?o=n.srcMhaName+"("+n.srcDcName+") => "+n.dstMhaName+"("+n.dstDcName+") db: "+n.dbName:3===r?o=n.srcMhaName+"("+n.srcDcName+")":4===r&&(o=n.srcMhaName+"("+n.srcDcName+") db: "+n.dbName),t("a",{props:{type:"info",size:"small",disabled:!1},on:{click:function(){1===r?e.toMhaReplication(n):2===r?e.toMhaDbReplication(n):3===r&&e.toMessenger(n)}}},o)}}],total:0,current:1,size:10,pageSizeOpts:[10,20,50,100]},migrateReplicatorInfo:{loading:!1,modal:!1,newIp:"",ipChooseList:[],oldIpInfo:{ip:"",tag:"",az:"",resourceId:null},migrateMhaList:[],tableData:[],columns:[{type:"selection",width:60,align:"center"},{title:"序号",width:75,align:"center",render:function(e,t){return e("span",t.index+1)}},{title:"mha",key:"mhaName",render:function(t,a){var n=a.row,r=n.mhaName;return t("a",{props:{type:"info",size:"small",disabled:!1},on:{click:function(){e.toMhaReplicationByR(n)}}},r)}}],total:0,current:1,size:10,pageSizeOpts:[10,20,50,100]},deleteResourceInfo:{resourceId:null,ip:"",tag:"",az:"",instanceNum:0},queryParam:{ip:"",type:null,tag:"",active:null,region:"",pageReq:{pageSize:10,pageIndex:1}},replicationDetail:{show:!1,data:null,darkMode:!0,lineWrap:!1,row:{}},dataLoading:!0}},computed:{rDataWithPage:function(){var e=this.migrateReplicatorInfo.tableData,t=this.migrateReplicatorInfo.current*this.migrateReplicatorInfo.size-this.migrateReplicatorInfo.size,a=t+this.migrateReplicatorInfo.size;return Object(i["a"])(e).slice(t,a)},aDataWithPage:function(){var e=this.migrateApplierInfo.tableData,t=this.migrateApplierInfo.current*this.migrateApplierInfo.size-this.migrateApplierInfo.size,a=t+this.migrateApplierInfo.size;return Object(i["a"])(e).slice(t,a)}},methods:{aHandleChangeSize:function(e){this.migrateApplierInfo.size=e},changeSelectionA:function(e){this.migrateApplierInfo.migrateDataList=e,console.log(this.migrateApplierInfo.migrateDataList)},rHandleChangeSize:function(e){this.migrateReplicatorInfo.size=e},changeSelectionR:function(e){this.migrateReplicatorInfo.migrateMhaList=e,console.log(this.migrateReplicatorInfo.migrateMhaList)},migrateAllApplierOrMessenger:function(){var e=this,t=this.migrateApplierInfo.newIp;if(null!==t&&""!==t){var a=this.migrateApplierInfo.tableData;if(0!==a.length){var n=this.migrateApplierInfo.oldIpInfo.ip;this.migrateApplierInfo.loading2=!0;var r=this.migrateApplierInfo.oldIpInfo.type;1===r?this.axios.post("/api/drc/v2/resource/migrate/applier?newIp="+t+"&oldIp="+n).then((function(t){0===t.data.status?(e.migrateApplierInfo.tableData=t.data.data,e.$Message.success("共迁移"+t.data.data+"个实例")):e.$Message.error("迁移失败"+t.data.message)})):7===r&&this.axios.post("/api/drc/v2/resource/migrate/messenger?newIp="+t+"&oldIp="+n).then((function(t){0===t.data.status?(e.migrateApplierInfo.tableData=t.data.data,e.$Message.success("共迁移"+t.data.data+"个实例")):e.$Message.error("迁移失败"+t.data.message)})),this.migrateApplierInfo.loading2=!1}else this.$Message.warning("没有相关实例")}else this.$Message.warning("请选择目标ip")},migrateApplierOrMessenger:function(){var e=this,t=this.migrateApplierInfo.migrateDataList;if(void 0!==t&&null!==t&&0!==t.length){var a=this.migrateApplierInfo.newIp;if(null!==a&&""!==a){var n=[];t.forEach((function(e){var t={relatedId:e.relatedId,type:e.type};n.push(t)}));var r={oldIp:this.migrateApplierInfo.oldIpInfo.ip,newIp:this.migrateApplierInfo.newIp,applierResourceDtos:n};this.migrateApplierInfo.loading=!0,1===this.migrateApplierInfo.oldIpInfo.type?this.axios.post("/api/drc/v2/resource/partialMigrate/applier",r).then((function(t){0===t.data.status?(e.migrateApplierInfo.tableData=t.data.data,e.$Message.success("共迁移"+t.data.data+"个实例")):e.$Message.error("迁移失败"+t.data.message)})):this.axios.post("/api/drc/v2/resource/partialMigrate/messenger",r).then((function(t){0===t.data.status?(e.migrateApplierInfo.tableData=t.data.data,e.$Message.success("共迁移"+t.data.data+"个实例")):e.$Message.error("迁移失败"+t.data.message)})),this.migrateApplierInfo.loading=!1}else this.$Message.warning("请选择目标ip")}else this.$Message.warning("请勾选！")},migrateReplicator:function(){var e=this,t=this.migrateReplicatorInfo.migrateMhaList;if(void 0!==t&&null!==t&&0!==t.length){var a=this.migrateReplicatorInfo.newIp;if(null!==a&&""!==a){var n=[];t.forEach((function(e){return n.push(e.mhaName)}));var r={oldIp:this.migrateReplicatorInfo.oldIpInfo.ip,newIp:this.migrateReplicatorInfo.newIp,mhaList:n};this.migrateReplicatorInfo.loading=!0,this.axios.post("/api/drc/v2/resource/partialMigrate/replicator",r).then((function(t){0===t.data.status?e.$Message.success("共迁移"+t.data.data+"个实例"):e.$Message.error("迁移失败"+t.data.message)})),this.migrateReplicatorInfo.loading=!1}else this.$Message.warning("请选择目标ip")}else this.$Message.warning("请勾选！")},refreshMigrateApplier:function(){var e=this;this.migrateApplierInfo.current=1;var t=this.migrateApplierInfo.oldIpInfo.resourceId;this.axios.get("/api/drc/v2/resource/mhaReplication?resourceId="+t).then((function(t){0===t.data.status?(e.migrateApplierInfo.tableData=t.data.data,console.log(e.migrateApplierInfo.tableData),e.$forceUpdate()):e.$Message.warning("查询异常")}))},refreshMigrateReplicator:function(){var e=this;this.migrateReplicatorInfo.current=1;var t=this.migrateReplicatorInfo.oldIpInfo.resourceId;this.axios.get("/api/drc/v2/resource/mha?resourceId="+t).then((function(t){0===t.data.status?(e.migrateReplicatorInfo.tableData=t.data.data,console.log(e.migrateReplicatorInfo.tableData),e.$forceUpdate()):e.$Message.warning("查询异常")}))},showMigrateInfo:function(e){0===e.type?this.showMigrateReplicator(e):(1===e.type||7===e.type)&&this.showMigrateApplier(e)},showMigrateApplier:function(e){var t=this;this.migrateApplierInfo.oldIpInfo={ip:e.ip,tag:e.tag,az:e.az,resourceId:e.resourceId,type:e.type},this.axios.get("/api/drc/v2/resource/mhaReplication?resourceId="+e.resourceId).then((function(e){0===e.data.status?t.migrateApplierInfo.tableData=e.data.data:t.$Message.warning("查询异常")})),this.axios.get("/api/drc/v2/resource/list?ip="+e.ip).then((function(e){t.migrateApplierInfo.ipChooseList=[],e.data.data.forEach((function(e){return t.migrateApplierInfo.ipChooseList.push(e.ip)})),console.log(t.migrateApplierInfo.ipChooseList)})),this.migrateApplierInfo.modal=!0},showMigrateReplicator:function(e){var t=this;this.migrateReplicatorInfo.oldIpInfo={ip:e.ip,tag:e.tag,az:e.az,resourceId:e.resourceId},this.axios.get("/api/drc/v2/resource/mha?resourceId="+e.resourceId).then((function(e){0===e.data.status?t.migrateReplicatorInfo.tableData=e.data.data:t.$Message.warning("查询异常")})),this.axios.get("/api/drc/v2/resource/list?ip="+e.ip).then((function(e){t.migrateReplicatorInfo.ipChooseList=[],e.data.data.forEach((function(e){return t.migrateReplicatorInfo.ipChooseList.push(e.ip)})),console.log(t.migrateReplicatorInfo.ipChooseList)})),this.migrateReplicatorInfo.modal=!0},toMessenger:function(e){var t=this.$router.resolve({path:"/v2/messengersV2",query:{mhaName:e.srcMhaName,mqType:e.mqType}});window.open(t.href,"_blank")},toDbMessenger:function(e){},toMhaReplication:function(e){var t=this.$router.resolve({path:"/v2/mhaReplications",query:{srcMhaName:e.srcMhaName,dstMhaName:e.dstMhaName,preciseSearchMode:!0}});window.open(t.href,"_blank")},toMhaDbReplication:function(e){var t=this.$router.resolve({path:"/v2/mhaDbReplications",query:{srcMhaName:e.srcMhaName,dstMhaName:e.dstMhaName,preciseSearchMode:!0,relatedDbName:e.dbName}});window.open(t.href,"_blank")},toMhaReplicationByR:function(e){var t=this.$router.resolve({path:"/v2/mhaReplications",query:{mhaName:e.mhaName,preciseSearchMode:!1}});window.open(t.href,"_blank")},showModal:function(e){0===e.type?this.getRelatedMha(e):(1===e.type||7===e.type)&&this.getRelatedMhaReplication(e)},getRegions:function(){var e=this;this.axios.get("/api/drc/v2/meta/regions/all").then((function(t){e.regions=t.data.data}))},resetParam:function(){this.queryParam={ip:"",type:null,tag:"",active:null,region:"",pageReq:{pageSize:10,pageIndex:1}},this.getResources()},getRelatedMha:function(e){var t=this;this.axios.get("/api/drc/v2/resource/mha?resourceId="+e.resourceId).then((function(e){0===e.data.status?t.relatedMhaData.tableData=e.data.data:(t.$Message.warning("查询异常"),t.relatedMhaData.tableData=[])})),this.relatedMhaData.modal=!0},getRelatedMhaReplication:function(e){var t=this;this.relatedReplicationData.tableData=[],this.axios.get("/api/drc/v2/resource/mhaReplication?resourceId="+e.resourceId).then((function(e){0===e.data.status?t.relatedReplicationData.tableData=e.data.data:(t.$Message.warning("查询异常"),t.relatedReplicationData.tableData=[])})),this.relatedReplicationData.modal=!0},getResources:function(){var e=this,t={ip:this.queryParam.ip,type:this.queryParam.type,tag:this.queryParam.tag,active:this.queryParam.active,region:this.queryParam.region,pageReq:{pageSize:this.size,pageIndex:this.current}},a=this.flattenObj(t);e.dataLoading=!0,e.axios.get("/api/drc/v2/resource/all",{params:a}).then((function(t){console.log("/api/drc/v2/resource/all response:"+t);var a=t.data,n=t.data.pageReq;1===a.status?e.$Message.error("查询异常: "+a.message):0===a.data.length||0===n.totalCount?(e.total=0,e.current=1,e.resources=[],e.$Message.warning("查询结果为空")):(e.total=n.totalCount,e.current=n.pageIndex,e.resources=a.data,e.$Message.success("查询成功"))})).catch((function(t){e.$Message.error("查询异常: "+t)})).finally((function(){e.dataLoading=!1}))},handleAddTag:function(e){this.constant.tagList.push(e)},handleChangeSize:function(e){var t=this;this.size=e,this.$nextTick((function(){t.getResources()}))},handleBeforeChange:function(){var e=this;return console.log("handleBeforeChange:",this.switchOneInfo),new Promise((function(t){e.$Modal.confirm({title:"切换确认",content:"您确认要切换开关状态吗？",onOk:function(){t()}})}))},preDeleteResource:function(e,t){this.deleteResourceInfo={resourceId:e.resourceId,ip:e.ip,tag:e.tag,az:e.az,instanceNum:e.instanceNum},this.deleteResourceModal=!0},clearDeleteResource:function(){this.deleteResourceInfo={resourceId:null,ip:"",tag:"",az:"",instanceNum:0}},deleteResource:function(e,t){var a=this;this.axios.delete("/api/drc/v2/resource/?resourceId="+this.deleteResourceInfo.resourceId).then((function(e){0===e.data.status?(a.$Message.success("删除成功"),a.getResources()):a.$Message.warning("下线失败 "+e.data.message)}))},switchActiveStatus:function(e,t){0===t?this.activeResource(e):this.deactivateResource(e)},deactivateResource:function(e){var t=this;this.axios.post("/api/drc/v2/resource/deactivate?resourceId="+e).then((function(e){0===e.data.status?t.$Message.success("已停用"):t.$Message.warning("停用失败"),t.getResources()}))},activeResource:function(e){var t=this;this.axios.post("/api/drc/v2/resource/active?resourceId="+e).then((function(e){0===e.data.status?t.$Message.success("已启用"):t.$Message.warning("启用失败"),t.getResources()}))},flattenObj:function(e){var t={};for(var a in e)if("object"!==Object(o["a"])(e[a])||Array.isArray(e[a]))t[a]=e[a];else{var n=this.flattenObj(e[a]);for(var r in n)t[a+"."+r]=n[r]}return t}},created:function(){var e=this;this.axios.get("/api/drc/v2/permission/resource/machine").then((function(t){403!==t.data.status?(console.log("still execute"),e.getResources(),e.getRegions()):e.$router.push("/nopermission")}))}}),l=s,c=(a("5c86"),a("2877")),u=Object(c["a"])(l,n,r,!1,null,"f1237e22",null);t["default"]=u.exports},a15b:function(e,t,a){"use strict";var n=a("23e7"),r=a("44ad"),o=a("fc6a"),i=a("a640"),s=[].join,l=r!=Object,c=i("join",",");n({target:"Array",proto:!0,forced:l||!c},{join:function(e){return s.call(o(this),void 0===e?",":e)}})},a3b8:function(e,t,a){"use strict";const n=a("7252"),r=a("afa5");e.exports=(e,t)=>{if(!Number.isFinite(e))throw new TypeError("Expected a finite number");if(t=t||{},e<1e3){const a="number"===typeof t.msDecimalDigits?t.msDecimalDigits:0;return(a?e.toFixed(a):Math.ceil(e))+(t.verbose?" "+r("millisecond",Math.ceil(e)):"ms")}const a=[],o=(e,n,o,i)=>{if(0===e)return;const s=t.verbose?" "+r(n,e):o;a.push((i||e)+s)},i=n(e);if(o(Math.trunc(i.days/365),"year","y"),o(i.days%365,"day","d"),o(i.hours,"hour","h"),o(i.minutes,"minute","m"),t.compact)return o(i.seconds,"second","s"),"~"+a[0];const s=e/1e3%60,l="number"===typeof t.secDecimalDigits?t.secDecimalDigits:1,c=s.toFixed(l).replace(/\.0$/,"");return o(s,"second","s",c),a.join(" ")}},a640:function(e,t,a){"use strict";var n=a("d039");e.exports=function(e,t){var a=[][e];return!!a&&n((function(){a.call(null,t||function(){throw 1},1)}))}},af03:function(e,t,a){var n=a("d039");e.exports=function(e){return n((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}))}},afa5:function(e,t,a){"use strict";var n=a("86aa");e.exports=function(e,t,a){return"number"===typeof t&&(a=t),e in n?t=n[e]:"string"!==typeof t&&(t=(e.replace(/(?:s|x|z|ch|sh)$/i,"$&e").replace(/([^aeiou])y$/i,"$1ie")+"s").replace(/i?e?s$/i,(function(t){var a=e.slice(-1)===e.slice(-1).toLowerCase();return a?t.toLowerCase():t.toUpperCase()}))),1===a?e:t}},b79c:function(e,t,a){},c7cd:function(e,t,a){"use strict";var n=a("23e7"),r=a("857a"),o=a("af03");n({target:"String",proto:!0,forced:o("fixed")},{fixed:function(){return r(this,"tt","","")}})},cbc8:function(e,t,a){(function(e){e(a("56b3"),a("4895"))})((function(e){"use strict";e.defineOption("foldGutter",!1,(function(t,r,o){o&&o!=e.Init&&(t.clearGutter(t.state.foldGutter.options.gutter),t.state.foldGutter=null,t.off("gutterClick",c),t.off("changes",p),t.off("viewportChange",d),t.off("fold",f),t.off("unfold",f),t.off("swapDoc",p),t.off("optionChange",u)),r&&(t.state.foldGutter=new a(n(r)),l(t),t.on("gutterClick",c),t.on("changes",p),t.on("viewportChange",d),t.on("fold",f),t.on("unfold",f),t.on("swapDoc",p),t.on("optionChange",u))}));var t=e.Pos;function a(e){this.options=e,this.from=this.to=0}function n(e){return!0===e&&(e={}),null==e.gutter&&(e.gutter="CodeMirror-foldgutter"),null==e.indicatorOpen&&(e.indicatorOpen="CodeMirror-foldgutter-open"),null==e.indicatorFolded&&(e.indicatorFolded="CodeMirror-foldgutter-folded"),e}function r(e,a){for(var n=e.findMarks(t(a,0),t(a+1,0)),r=0;r<n.length;++r)if(n[r].__isFold){var o=n[r].find(-1);if(o&&o.line===a)return n[r]}}function o(e){if("string"==typeof e){var t=document.createElement("div");return t.className=e+" CodeMirror-guttermarker-subtle",t}return e.cloneNode(!0)}function i(e,a,n){var i=e.state.foldGutter.options,l=a-1,c=e.foldOption(i,"minFoldSize"),u=e.foldOption(i,"rangeFinder"),p="string"==typeof i.indicatorFolded&&s(i.indicatorFolded),d="string"==typeof i.indicatorOpen&&s(i.indicatorOpen);e.eachLine(a,n,(function(a){++l;var n=null,s=a.gutterMarkers;if(s&&(s=s[i.gutter]),r(e,l)){if(p&&s&&p.test(s.className))return;n=o(i.indicatorFolded)}else{var f=t(l,0),h=u&&u(e,f);if(h&&h.to.line-h.from.line>=c){if(d&&s&&d.test(s.className))return;n=o(i.indicatorOpen)}}(n||s)&&e.setGutterMarker(a,i.gutter,n)}))}function s(e){return new RegExp("(^|\\s)"+e+"(?:$|\\s)\\s*")}function l(e){var t=e.getViewport(),a=e.state.foldGutter;a&&(e.operation((function(){i(e,t.from,t.to)})),a.from=t.from,a.to=t.to)}function c(e,a,n){var o=e.state.foldGutter;if(o){var i=o.options;if(n==i.gutter){var s=r(e,a);s?s.clear():e.foldCode(t(a,0),i)}}}function u(e,t){"mode"==t&&p(e)}function p(e){var t=e.state.foldGutter;if(t){var a=t.options;t.from=t.to=0,clearTimeout(t.changeUpdate),t.changeUpdate=setTimeout((function(){l(e)}),a.foldOnChangeTimeSpan||600)}}function d(e){var t=e.state.foldGutter;if(t){var a=t.options;clearTimeout(t.changeUpdate),t.changeUpdate=setTimeout((function(){var a=e.getViewport();t.from==t.to||a.from-t.to>20||t.from-a.to>20?l(e):e.operation((function(){a.from<t.from&&(i(e,a.from,t.from),t.from=a.from),a.to>t.to&&(i(e,t.to,a.to),t.to=a.to)}))}),a.updateViewportTimeSpan||400)}}function f(e,t){var a=e.state.foldGutter;if(a){var n=t.line;n>=a.from&&n<a.to&&i(e,n,n+1)}}}))},d5e0:function(e,t,a){(function(e){e(a("56b3"))})((function(e){"use strict";var t={autoSelfClosers:{area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0,menuitem:!0},implicitlyClosed:{dd:!0,li:!0,optgroup:!0,option:!0,p:!0,rp:!0,rt:!0,tbody:!0,td:!0,tfoot:!0,th:!0,tr:!0},contextGrabbers:{dd:{dd:!0,dt:!0},dt:{dd:!0,dt:!0},li:{li:!0},option:{option:!0,optgroup:!0},optgroup:{optgroup:!0},p:{address:!0,article:!0,aside:!0,blockquote:!0,dir:!0,div:!0,dl:!0,fieldset:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,menu:!0,nav:!0,ol:!0,p:!0,pre:!0,section:!0,table:!0,ul:!0},rp:{rp:!0,rt:!0},rt:{rp:!0,rt:!0},tbody:{tbody:!0,tfoot:!0},td:{td:!0,th:!0},tfoot:{tbody:!0},th:{td:!0,th:!0},thead:{tbody:!0,tfoot:!0},tr:{tr:!0}},doNotIndent:{pre:!0},allowUnquoted:!0,allowMissing:!0,caseFold:!0},a={autoSelfClosers:{},implicitlyClosed:{},contextGrabbers:{},doNotIndent:{},allowUnquoted:!1,allowMissing:!1,allowMissingTagName:!1,caseFold:!1};e.defineMode("xml",(function(n,r){var o,i,s=n.indentUnit,l={},c=r.htmlMode?t:a;for(var u in c)l[u]=c[u];for(var u in r)l[u]=r[u];function p(e,t){function a(a){return t.tokenize=a,a(e,t)}var n,r=e.next();return"<"==r?e.eat("!")?e.eat("[")?e.match("CDATA[")?a(h("atom","]]>")):null:e.match("--")?a(h("comment","--\x3e")):e.match("DOCTYPE",!0,!0)?(e.eatWhile(/[\w\._\-]/),a(g(1))):null:e.eat("?")?(e.eatWhile(/[\w\._\-]/),t.tokenize=h("meta","?>"),"meta"):(o=e.eat("/")?"closeTag":"openTag",t.tokenize=d,"tag bracket"):"&"==r?(n=e.eat("#")?e.eat("x")?e.eatWhile(/[a-fA-F\d]/)&&e.eat(";"):e.eatWhile(/[\d]/)&&e.eat(";"):e.eatWhile(/[\w\.\-:]/)&&e.eat(";"),n?"atom":"error"):(e.eatWhile(/[^&<]/),null)}function d(e,t){var a=e.next();if(">"==a||"/"==a&&e.eat(">"))return t.tokenize=p,o=">"==a?"endTag":"selfcloseTag","tag bracket";if("="==a)return o="equals",null;if("<"==a){t.tokenize=p,t.state=w,t.tagName=t.tagStart=null;var n=t.tokenize(e,t);return n?n+" tag error":"tag error"}return/[\'\"]/.test(a)?(t.tokenize=f(a),t.stringStartCol=e.column(),t.tokenize(e,t)):(e.match(/^[^\s\u00a0=<>\"\']*[^\s\u00a0=<>\"\'\/]/),"word")}function f(e){var t=function(t,a){while(!t.eol())if(t.next()==e){a.tokenize=d;break}return"string"};return t.isInAttribute=!0,t}function h(e,t){return function(a,n){while(!a.eol()){if(a.match(t)){n.tokenize=p;break}a.next()}return e}}function g(e){return function(t,a){var n;while(null!=(n=t.next())){if("<"==n)return a.tokenize=g(e+1),a.tokenize(t,a);if(">"==n){if(1==e){a.tokenize=p;break}return a.tokenize=g(e-1),a.tokenize(t,a)}}return"meta"}}function m(e){return e&&e.toLowerCase()}function v(e,t,a){this.prev=e.context,this.tagName=t||"",this.indent=e.indented,this.startOfLine=a,(l.doNotIndent.hasOwnProperty(t)||e.context&&e.context.noIndent)&&(this.noIndent=!0)}function b(e){e.context&&(e.context=e.context.prev)}function y(e,t){var a;while(1){if(!e.context)return;if(a=e.context.tagName,!l.contextGrabbers.hasOwnProperty(m(a))||!l.contextGrabbers[m(a)].hasOwnProperty(m(t)))return;b(e)}}function w(e,t,a){return"openTag"==e?(a.tagStart=t.column(),I):"closeTag"==e?x:w}function I(e,t,a){return"word"==e?(a.tagName=t.current(),i="tag",R):l.allowMissingTagName&&"endTag"==e?(i="tag bracket",R(e,t,a)):(i="error",I)}function x(e,t,a){if("word"==e){var n=t.current();return a.context&&a.context.tagName!=n&&l.implicitlyClosed.hasOwnProperty(m(a.context.tagName))&&b(a),a.context&&a.context.tagName==n||!1===l.matchClosing?(i="tag",M):(i="tag error",k)}return l.allowMissingTagName&&"endTag"==e?(i="tag bracket",M(e,t,a)):(i="error",k)}function M(e,t,a){return"endTag"!=e?(i="error",M):(b(a),w)}function k(e,t,a){return i="error",M(e,t,a)}function R(e,t,a){if("word"==e)return i="attribute",N;if("endTag"==e||"selfcloseTag"==e){var n=a.tagName,r=a.tagStart;return a.tagName=a.tagStart=null,"selfcloseTag"==e||l.autoSelfClosers.hasOwnProperty(m(n))?y(a,n):(y(a,n),a.context=new v(a,n,r==a.indented)),w}return i="error",R}function N(e,t,a){return"equals"==e?D:(l.allowMissing||(i="error"),R(e,t,a))}function D(e,t,a){return"string"==e?S:"word"==e&&l.allowUnquoted?(i="string",R):(i="error",R(e,t,a))}function S(e,t,a){return"string"==e?S:R(e,t,a)}return p.isInText=!0,{startState:function(e){var t={tokenize:p,state:w,indented:e||0,tagName:null,tagStart:null,context:null};return null!=e&&(t.baseIndent=e),t},token:function(e,t){if(!t.tagName&&e.sol()&&(t.indented=e.indentation()),e.eatSpace())return null;o=null;var a=t.tokenize(e,t);return(a||o)&&"comment"!=a&&(i=null,t.state=t.state(o||a,e,t),i&&(a="error"==i?a+" error":i)),a},indent:function(t,a,n){var r=t.context;if(t.tokenize.isInAttribute)return t.tagStart==t.indented?t.stringStartCol+1:t.indented+s;if(r&&r.noIndent)return e.Pass;if(t.tokenize!=d&&t.tokenize!=p)return n?n.match(/^(\s*)/)[0].length:0;if(t.tagName)return!1!==l.multilineTagIndentPastTag?t.tagStart+t.tagName.length+2:t.tagStart+s*(l.multilineTagIndentFactor||1);if(l.alignCDATA&&/<!\[CDATA\[/.test(a))return 0;var o=a&&/^<(\/)?([\w_:\.-]*)/.exec(a);if(o&&o[1])while(r){if(r.tagName==o[2]){r=r.prev;break}if(!l.implicitlyClosed.hasOwnProperty(m(r.tagName)))break;r=r.prev}else if(o)while(r){var i=l.contextGrabbers[m(r.tagName)];if(!i||!i.hasOwnProperty(m(o[2])))break;r=r.prev}while(r&&r.prev&&!r.startOfLine)r=r.prev;return r?r.indent+s:t.baseIndent||0},electricInput:/<\/[\s\w:]+>$/,blockCommentStart:"\x3c!--",blockCommentEnd:"--\x3e",configuration:l.htmlMode?"html":"xml",helperType:l.htmlMode?"html":"xml",skipAttribute:function(e){e.state==D&&(e.state=R)},xmlCurrentTag:function(e){return e.tagName?{name:e.tagName,close:"closeTag"==e.type}:null},xmlCurrentContext:function(e){for(var t=[],a=e.context;a;a=a.prev)t.push(a.tagName);return t.reverse()}}})),e.defineMIME("text/xml","xml"),e.defineMIME("application/xml","xml"),e.mimeModes.hasOwnProperty("text/html")||e.defineMIME("text/html",{name:"xml",htmlMode:!0})}))},d81d:function(e,t,a){"use strict";var n=a("23e7"),r=a("b727").map,o=a("1dde"),i=a("ae40"),s=o("map"),l=i("map");n({target:"Array",proto:!0,forced:!s||!l},{map:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}})},d9fd:function(e,t,a){"use strict";a("b79c")},fcc1:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Row",{attrs:{gutter:10}},[a("Col",{attrs:{span:"10"}},[a("Input",{attrs:{prefix:"ios-search",placeholder:"请输入集群名"},on:{"on-enter":function(t){return e.showMore([e.queryParam.mhaNames],!0)}},model:{value:e.queryParam.mhaNames,callback:function(t){e.$set(e.queryParam,"mhaNames",t)},expression:"queryParam.mhaNames"}})],1),a("Col",{attrs:{span:"10"}},[a("Col",{attrs:{span:"3"}},[a("Button",{attrs:{type:"primary",icon:"ios-search",loading:e.dataLoading},on:{click:function(t){return e.showMore([e.queryParam.mhaNames],!0)}}},[e._v("查询所有")])],1)],1)],1),a("div",{ref:"myPage",staticStyle:{height:"calc(100vh - 35vh)",width:"calc(100vw - 20vw)"},on:{click:function(t){e.graphData.isShowNodeMenuPanel=!1,e.graphData.isShowNodeTipsPanel=!1,e.graphData.nodeMenuPanelPosition.fixed=!1}}},[a("RelationGraph",{ref:"seeksRelationGraph",attrs:{options:e.graphOptions,"on-node-click":e.onNodeClick,"on-line-click":e.onLineClick},scopedSlots:e._u([{key:"node",fn:function(t){var n=t.node;return a("div",{},[a("Tag",{staticStyle:{position:"absolute",width:"auto",height:"25px","margin-top":"-10px","margin-left":"15px","text-align":"center","font-size":"15px"},attrs:{color:"success"}},[e._v(e._s(n.data.mha.regionName))]),a("div",{staticStyle:{"font-weight":"bold",position:"absolute",width:"auto",height:"auto",left:"50%",top:"50%","-webkit-transform":"translate(-50%, -50%)",transform:"translate(-50%, -50%)","text-align":"center"}},[e._v(e._s(n.data.mha.name))])],1)}}])})],1),e.graphData.isShowNodeTipsPanel?a("div",{staticStyle:{"z-index":"999",padding:"10px","background-color":"#ffffff",border:"#eeeeee solid 1px","box-shadow":"0px 0px 8px #cccccc",position:"absolute"},style:{left:e.graphData.nodeMenuPanelPosition.x+"px",top:e.graphData.nodeMenuPanelPosition.y+"px"}},[a("div",{staticClass:"c-node-menu-item"},[e._v("名称: "+e._s(e.current.node.mha.name))]),a("div",{staticClass:"c-node-menu-item"},[e._v("部门: "+e._s(e.current.node.mha.buName))]),a("div",{staticClass:"c-node-menu-item"},[e._v("地域: "+e._s(e.current.node.mha.regionName))])]):e._e(),a("div",{directives:[{name:"show",rawName:"v-show",value:e.graphData.isShowNodeMenuPanel,expression:"graphData.isShowNodeMenuPanel"}],staticStyle:{"z-index":"999",padding:"10px","background-color":"#ffffff",border:"#eeeeee solid 1px","box-shadow":"0px 0px 8px #cccccc",position:"absolute"},style:{left:e.graphData.linkMenuPanelPosition.x+"px",top:e.graphData.linkMenuPanelPosition.y+"px"}},[a("div",{staticStyle:{"line-height":"25px","padding-left":"10px",color:"#888888","font-size":"12px"}},[e._v(e._s(e.current.link.srcMha.name+" -> "+e.current.link.dstMha.name))]),a("div",{staticStyle:{"line-height":"25px","padding-left":"10px",color:"#888888","font-size":"12px"}},[e._v("操作:")]),a("div",{attrs:{id:"operationsDiv"}},e._l(e.operations,(function(t,n){return a("div",{key:n},[a("div",{staticClass:"c-node-menu-item",on:{click:function(a){return a.stopPropagation(),t.method(e.current.link.srcMha.name,e.current.link.dstMha.name,e.current.link.replicationId)}}},[e._v(e._s(t.text))])])})),0)])],1)},r=[],o=(a("4de4"),a("a15b"),a("d81d"),a("b0c0"),a("4ec9"),a("d3b7"),a("6062"),a("3ca3"),a("c7cd"),a("9911"),a("159b"),a("ddb0"),a("a3b8")),i=a.n(o),s={name:"MhaGraph",components:{},props:{mhaIdList:Array,mhaNameList:Array,operations:Array},data:function(){return{dataLoading:!1,graphData:{graphInit:!1,graph:null,currentLink:null,mhaNameRequested:new Set,mhaNameShown:new Set,replicationIdShown:new Set,isShowNodeMenuPanel:!1,isShowNodeTipsPanel:!1,nodeMenuPanelPosition:{x:0,y:0,fixed:!1},linkMenuPanelPosition:{x:0,y:0},rootId:"",nodes:[],lines:[],clear:function(){this.nodes=[],this.lines=[]},reset:function(){this.graphInit=!1,this.mhaNameRequested.clear(),this.mhaNameShown.clear(),this.replicationIdShown.clear(),this.nodes=[],this.lines=[]},isEmpty:function(){return null==this.nodes||null==this.lines||0===this.nodes.length||0===this.lines.length},appendNode:function(e){this.mhaNameShown.has(e.name+"")||(this.mhaNameShown.add(e.name+""),this.nodes.push({id:e.id+"",text:e.name+"\n"+e.regionName,data:{mha:e},width:100,height:100,styleClass:"c-g-center"}))},appendLine:function(e){this.replicationIdShown.has(e.replicationId+"")||(this.replicationIdShown.add(e.replicationId+""),this.lines.push({from:e.srcMha.id+"",to:e.dstMha.id+"",selected:!0,color:"#2c2c2c",styleClass:"node-line",data:{replication:e}}))},appendDataToGraph:function(e){var t=this,a=this.graph;this.graphInit?a.appendJsonData(this,(function(e){console.log("refresh graph success")})):(this.graphInit=!0,a.setJsonData(this,(function(a){t.deepenClickedNode(null,e),console.log("init graph success")})))},hasShow:function(e){return!!this.mhaNameRequested.has(e)||(this.mhaNameRequested.add(e),!1)},deepenClickedNode:function(e,t){var a=this,n="rgb(0,166,81)";if(null!=e)e.color=n;else{var r=this.graph.getNodes();r.forEach((function(e){(t||a.mhaNameRequested.has(e.data.mha.name))&&(e.color=n)}))}}},graphOptions:{defaultLineColor:"#333333",defaultLineWidth:1,defaultNodeBorderWidth:1,defaultNodeShape:0,defaultNodeBorderColor:"rgb(194,194,194)",defaultNodeColor:"rgba(66,66,66)",allowSwitchLineShape:!0,allowSwitchNodeShape:!0,checkedLineColor:"rgba(30, 144, 255, 1)",defaultLineShape:1,moveToCenterWhenRefresh:!0,useAnimationWhenRefresh:!0,layouts:[{label:"自动布局",layoutName:"force",layoutClassName:"seeks-layout-force"}],defaultJunctionPoint:"border"},current:{node:{mha:{}},link:{srcMha:{},dstMha:{},replicationId:0}},queryParam:{mhaNames:""}}},mounted:function(){var e=this.mhaIdList,t=this.mhaNameList;console.log("mount mhaId: "+e),this.graphData.graph=this.$refs.seeksRelationGraph,this.graphData.rootId=e[0],this.showMore(t,!1)},methods:{showMore:function(e,t){var a=this;t?this.graphData.reset():this.graphData.clear();var n=e.filter((function(e){return!a.graphData.hasShow(e)}));if(null!=n&&0!==n.length){var r={relatedMhaNames:n.join(","),queryAll:t};this.dataLoading=!0,this.axios.get("/api/drc/v2/replication/queryMhaRelatedByNames",{params:r}).then((function(e){var n=e.data.data,r=null==n||!Array.isArray(n)||0===n.length;r?a.$Message.info("结果为空"):(n.forEach((function(e){a.graphData.appendNode(e.srcMha),a.graphData.appendNode(e.dstMha),a.graphData.appendLine(e)})),a.graphData.isEmpty()||(t&&a.$Message.success("查询成功"),a.graphData.appendDataToGraph(t),a.getDelay(n)))})).catch((function(e){console.log(e),a.$Message.error("查询异常: "+e)})).finally((function(){a.dataLoading=!1}))}},getDelay:function(e){var t=this,a={replicationIds:e.map((function(e){return e.replicationId})).join(",")};console.log(a),this.axios.get("/api/drc/v2/replication/delay",{params:a}).then((function(e){var a=e.data.data,n=null==a||!Array.isArray(a)||0===a.length;if(!n){var r=new Map(a.map((function(e){return[e.srcMha+"-"+e.dstMha,e.delay]}))),o=t.graphData.graph.getLinks();console.log(o),o.forEach((function(e){e.relations.forEach((function(e){var t=e.data.replication,a=r.get(t.srcMha.name+"-"+t.dstMha.name),n="rgb(3,119,63)",o=null;null!=a&&(console.log(a),o=i()(a,{compact:!0}),a>1e4&&(n="rgb(238,0,0)"),e.text=o,e.color=n)}))})),t.graphData.graph.getInstance().dataUpdated()}})).catch((function(e){console.log(e),t.$Message.error("查询延迟异常: "+e)}))},onNodeClick:function(e,t){var a=this;console.log("onNodeClick:",e,t),this.showMore([e.data.mha.name],!1),this.graphData.deepenClickedNode(e);var n=e.data.mha.name;this.$copyText(n).then((function(e){a.$Message.success("已复制 mha 名称: "+e.text),console.log(e)})),this.showNodeTips(e,t),this.graphData.nodeMenuPanelPosition.fixed=!0},onLineClick:function(e,t,a){console.log(e);var n=e.data.replication;this.current.link={srcMha:n.srcMha,dstMha:n.dstMha,replicationId:n.replicationId},this.showLineMenus(e,a)},showLineMenus:function(e,t){var a=this;if(null!=this.operations.length&&0!==this.operations.length){var n=this.$refs.myPage.getBoundingClientRect();this.graphData.linkMenuPanelPosition.x=t.clientX-n.x,this.graphData.linkMenuPanelPosition.y=t.clientY-n.y+30,console.log("showLineMenus:",t,n),setTimeout((function(){a.graphData.isShowNodeMenuPanel=!0}),10)}},showNodeTips:function(e,t){console.log("showNodeMenus:",e,t),this.current.node.mha=e.data.mha;var a=this.$refs.myPage.getBoundingClientRect();this.graphData.isShowNodeTipsPanel=!0,this.graphData.nodeMenuPanelPosition.x=t.clientX-a.x,this.graphData.nodeMenuPanelPosition.y=t.clientY-a.y+30},hideNodeTips:function(e,t){console.log("hideNodeTips:",e,t),this.graphData.nodeMenuPanelPosition.fixed||(this.graphData.isShowNodeTipsPanel=!1)}}},l=s,c=(a("d9fd"),a("2877")),u=Object(c["a"])(l,n,r,!1,null,"732eec18",null);t["default"]=u.exports}}]);
//# sourceMappingURL=chunk-e9adc6a8.edcb5fb2.js.map