(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8c014838"],{"25f0":function(e,t,a){"use strict";var i=a("6eeb"),r=a("825a"),s=a("d039"),l=a("ad6d"),o="toString",n=RegExp.prototype,u=n[o],c=s((function(){return"/a/b"!=u.call({source:"a",flags:"b"})})),d=u.name!=o;(c||d)&&i(RegExp.prototype,o,(function(){var e=r(this),t=String(e.source),a=e.flags,i=String(void 0===a&&e instanceof RegExp&&!("flags"in n)?l.call(e):a);return"/"+t+"/"+i}),{unsafe:!0})},"76b5":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("base-component",[a("Breadcrumb",{style:{margin:"15px 0 15px 185px",position:"fixed"}},[a("BreadcrumbItem",{attrs:{to:"/home"}},[e._v("首页")]),a("BreadcrumbItem",{attrs:{to:"/accessV2"}},[e._v("出海DRC")])],1),a("Content",{staticClass:"content",style:{padding:"10px",background:"#ffffff",margin:"50px 0 1px 185px",zIndex:"1",top:"500px"}},[[a("Steps",{staticStyle:{width:"90%","margin-left":"50px","margin-bottom":"15px","margin-top":"50px"},attrs:{current:e.current}},[a("Step",{style:{cursor:"pointer"},attrs:{title:"新建DRC集群",content:"新建复制集群"},nativeOn:{click:function(t){return e.jumpTo(0)}}}),a("Step",{style:{cursor:"pointer"},attrs:{title:"mha配置",content:"mha添加db信息"},nativeOn:{click:function(t){return e.jumpTo(1)}}}),a("Step",{style:{cursor:"pointer"},attrs:{title:"同步链路配置",content:"单双向链路"},nativeOn:{click:function(t){return e.jumpTo(2)}}}),a("Step",{style:{cursor:"pointer"},attrs:{title:"建立双向复制",content:"配置Replicator和Applier建立集群双向复制"},nativeOn:{click:function(t){return e.jumpTo(3)}}}),a("Step",{style:{cursor:"pointer"},attrs:{title:"完成",content:"已完成DRC接入"},nativeOn:{click:function(t){return e.jumpTo(4)}}})],1)],0===e.current?a("buildV2",e._b({on:{oldClusterChanged:e.updateOldCluster,newClusterChanged:e.updateNewCluster,newDrcZoneChanged:e.updateNewZone,oldDrcZoneChanged:e.updateOldZone}},"buildV2",e.clusterPair,!1)):e._e(),1===e.current?a("mhaConfig",e._b({on:{envChanged:e.updateEnv,oldClusterChanged:e.updateOldCluster,newClusterChanged:e.updateNewCluster}},"mhaConfig",e.clusterPair,!1)):e._e(),2===e.current?a("applierGroups",e._b({on:{subCurrentChange:e.updateSubCurrent}},"applierGroups",e.clusterPair,!1)):e._e(),3===e.current?a("drc",e._b({on:{envChanged:e.updateEnv,oldClusterChanged:e.updateOldCluster,newClusterChanged:e.updateNewCluster}},"drc",e.clusterPair,!1)):e._e(),4===e.current?a("complete"):e._e(),a("Divider"),a("div",{staticStyle:{padding:"1px 1px",height:"100px","margin-top":"75px"}},[a("div",[e.current>0&&2.1===e.subCurrent?a("Button",{staticStyle:{position:"absolute",left:"465px"},attrs:{type:"primary"},on:{click:e.prev}},[e._v(" 上一步 ")]):e._e(),e.current<6&&2.1===e.subCurrent?a("Button",{staticStyle:{position:"absolute",left:"790px"},attrs:{type:"primary"},on:{click:e.next}},[e._v(" 下一步 ")]):e._e()],1)])],2)],1)},r=[],s=(a("a9e3"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.hasResp?a("Alert",{staticStyle:{width:"65%","margin-left":"250px"},attrs:{type:e.status,"show-icon":""}},[e._v(" "+e._s(e.title)+" "),a("span",{attrs:{slot:"desc"},domProps:{innerHTML:e._s(e.message)},slot:"desc"})]):e._e(),a("Form",{ref:"build",staticStyle:{"margin-top":"50px"},attrs:{model:e.build,rules:e.ruleBuild,"label-width":250}},[a("FormItem",{staticStyle:{width:"600px"},attrs:{label:"源Mha集群名",prop:"oldClusterName"}},[a("Input",{attrs:{placeholder:"请输入源集群名"},on:{input:e.changeOldMha},model:{value:e.build.oldClusterName,callback:function(t){e.$set(e.build,"oldClusterName",t)},expression:"build.oldClusterName"}})],1),a("FormItem",{attrs:{label:"源集群机房区域",prop:"oldDrcZone"}},[a("Select",{staticStyle:{width:"200px"},attrs:{placeholder:"选择机房区域"},on:{input:e.changeOldZone},model:{value:e.build.oldDrcZone,callback:function(t){e.$set(e.build,"oldDrcZone",t)},expression:"build.oldDrcZone"}},e._l(e.build.drcZoneList,(function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])})),1)],1),a("FormItem",{staticStyle:{width:"600px"},attrs:{label:"新Mha集群名",prop:"newClusterName"}},[a("Input",{attrs:{placeholder:"请输入新集群名"},on:{input:e.changeNewMha},model:{value:e.build.newClusterName,callback:function(t){e.$set(e.build,"newClusterName",t)},expression:"build.newClusterName"}})],1),a("FormItem",{attrs:{label:"新集群机房区域",prop:"newDrcZone"}},[a("Select",{staticStyle:{width:"200px"},attrs:{placeholder:"选择机房区域"},on:{input:e.changeNewZone},model:{value:e.build.newDrcZone,callback:function(t){e.$set(e.build,"newDrcZone",t)},expression:"build.newDrcZone"}},e._l(e.build.drcZoneList,(function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])})),1)],1),a("FormItem",{staticStyle:{width:"600px"},attrs:{label:"BU名",prop:"bu"}},[a("Input",{attrs:{placeholder:"请输入BU名，自动绑定route策略"},on:{input:e.changeBu},model:{value:e.build.bu,callback:function(t){e.$set(e.build,"bu",t)},expression:"build.bu"}})],1),a("FormItem",{staticStyle:{width:"600px"},attrs:{label:"DAL Cluster名",prop:"dalclustername"}},[a("Input",{attrs:{placeholder:"请输入DAL Cluster名"},on:{input:e.changeDalClusterName},model:{value:e.build.dalclustername,callback:function(t){e.$set(e.build,"dalclustername",t)},expression:"build.dalclustername"}})],1),a("FormItem",{staticStyle:{width:"600px"},attrs:{label:"appid",prop:"appid"}},[a("Input",{attrs:{placeholder:"请输入appid"},on:{input:e.changeAppId},model:{value:e.build.appid,callback:function(t){e.$set(e.build,"appid",t)},expression:"build.appid"}})],1),a("FormItem",[a("Button",{on:{click:function(t){return e.handleReset("build")}}},[e._v("重置")]),a("Button",{staticStyle:{"margin-left":"150px"},attrs:{type:"primary"},on:{click:function(t){return e.changeModal("build")}}},[e._v("新建DRC同步集群")]),a("Modal",{attrs:{title:"创建DRC"},on:{"on-ok":function(t){return e.postBuild("build")}},model:{value:e.build.modal,callback:function(t){e.$set(e.build,"modal",t)},expression:"build.modal"}},[a("p",[e._v('确定创建新DRC "'+e._s(e.build.oldClusterName+e.build.newClusterName)+'" 吗？并且设置BU/DAL Cluster/appid为 "'+e._s(e.build.bu)+'"/"'+e._s(e.build.dalclustername)+'"/"'+e._s(e.build.appid)+'"')])])],1)],1)],1)}),l=[],o={name:"buildV2",props:{oldClusterName:String,newClusterName:String,oldDrcZone:String,newDrcZone:String},data:function(){return{status:"",title:"",message:"",hasResp:!1,build:{modal:!1,oldClusterName:this.oldClusterName,newClusterName:this.newClusterName,bu:"",dalclustername:"",appid:"",oldDrcZone:this.oldDrcZone,newDrcZone:this.newDrcZone,drcZoneList:[{value:"shaoy",label:"上海欧阳"},{value:"shaxy",label:"上海新源"},{value:"sharb",label:"上海日版"},{value:"shajq",label:"上海金桥"},{value:"shafq",label:"上海福泉"},{value:"shajz",label:"上海金钟"},{value:"ntgxh",label:"南通星湖大道"},{value:"fraaws",label:"法兰克福AWS"},{value:"shali",label:"上海阿里"},{value:"sinibuaws",label:"IBU-VPC"},{value:"sinaws",label:"新加坡AWS"}]},ruleBuild:{oldClusterName:[{required:!0,message:"源集群名不能为空",trigger:"blur"}],newClusterName:[{required:!0,message:"新集群名不能为空",trigger:"blur"}],oldDrcZone:[{required:!0,message:"选择源集群区域",trigger:"change"}],newDrcZone:[{required:!0,message:"选择新集群区域",trigger:"change"}],bu:[{required:!0,message:"BU名不能为空",trigger:"blur"}],dalclustername:[{required:!0,message:"DAL Cluster名不能为空",trigger:"blur"}],appid:[{required:!0,message:"cluster appid不能为空",trigger:"blur"}]}}},methods:{postBuild:function(e){var t=this,a=this;a.$refs[e].validate((function(e){e?(t.hasResp=!1,a.axios.post("/api/drc/v1/access/mha/standalone",{buName:t.build.bu,dalClusterName:t.build.dalclustername,appid:t.build.appid,originalMha:t.build.oldClusterName,originalMhaDc:t.build.oldDrcZone,newBuiltMha:t.build.newClusterName,newBuiltMhaDc:t.build.newDrcZone}).then((function(e){a.hasResp=!0,0===e.data.status?(a.status="success",a.title="集群创建完成!",a.message=e.data.message):(a.status="error",a.title="集群创建失败!",a.message=e.data.message)}))):a.$Message.error("仍有必填项未填!")}))},handleReset:function(e){this.$refs[e].resetFields()},changeOldMha:function(){this.$emit("oldClusterChanged",this.build.oldClusterName)},changeNewMha:function(){this.$emit("newClusterChanged",this.build.newClusterName)},changeOldZone:function(){this.$emit("oldDrcZoneChanged",this.build.oldDrcZone)},changeNewZone:function(){this.$emit("newDrcZoneChanged",this.build.newDrcZone)},changeBu:function(){this.$emit("buChanged",this.build.bu)},changeDalClusterName:function(){this.$emit("dalclusternameChanged",this.build.dalclustername)},changeAppId:function(){this.$emit("appidChanged",this.build.appid)},changeModal:function(e){var t=this;this.$refs[e].validate((function(e){e?t.build.modal=!0:t.$Message.error("仍有必填项未填!")}))}}},n=o,u=a("2877"),c=Object(u["a"])(n,s,l,!1,null,"27219880",null),d=c.exports,p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.hasResp?a("Alert",{staticStyle:{width:"65%","margin-left":"250px"},attrs:{type:e.status,"show-icon":""}},[e._v(" "+e._s(e.title)+" "),a("span",{attrs:{slot:"desc"},domProps:{innerHTML:e._s(e.message)},slot:"desc"})]):e._e(),a("Row",[a("i-col",{attrs:{span:"12"}},[a("Form",{ref:"oldMhaMachine",staticStyle:{float:"left","margin-top":"50px"},attrs:{model:e.oldMhaMachine,rules:e.ruleMhaMachine,"label-width":250}},[a("FormItem",{staticStyle:{width:"600px"},attrs:{label:"源集群名",prop:"mhaName"}},[a("Input",{attrs:{placeholder:"请输入源集群名"},on:{input:e.changeOldMha},model:{value:e.oldMhaMachine.mhaName,callback:function(t){e.$set(e.oldMhaMachine,"mhaName",t)},expression:"oldMhaMachine.mhaName"}})],1),a("FormItem",{attrs:{label:"添加Ip",prop:"ip"}},[a("Input",{attrs:{number:"",placeholder:"请输入录入DB的IP"},model:{value:e.oldMhaMachine.ip,callback:function(t){e.$set(e.oldMhaMachine,"ip",t)},expression:"oldMhaMachine.ip"}})],1),a("FormItem",{attrs:{label:"Port",prop:"port"}},[a("Input",{attrs:{placeholder:"请输入录入DB端口"},model:{value:e.oldMhaMachine.port,callback:function(t){e.$set(e.oldMhaMachine,"port",t)},expression:"oldMhaMachine.port"}})],1),a("FormItem",{attrs:{label:"DB机房",prop:"idc"}},[a("Select",{staticStyle:{width:"200px"},attrs:{placeholder:"选择db机房区域"},model:{value:e.oldMhaMachine.idc,callback:function(t){e.$set(e.oldMhaMachine,"idc",t)},expression:"oldMhaMachine.idc"}},e._l(e.selectOption.drcZoneList,(function(t){return a("Option",{key:t.key,attrs:{value:t.value}},[e._v(e._s(t.key))])})),1)],1),a("FormItem",{attrs:{label:"UUID",prop:"uuid"}},[a("Input",{attrs:{placeholder:"请输入录入DB的uuid"},model:{value:e.oldMhaMachine.uuid,callback:function(t){e.$set(e.oldMhaMachine,"uuid",t)},expression:"oldMhaMachine.uuid"}}),a("Button",{on:{click:e.queryOldMhaMachineUuid}},[e._v("连接查询")]),e.hasTest1?a("span",[a("Icon",{attrs:{type:e.testSuccess1?"ios-checkmark-circle":"ios-close-circle",color:e.testSuccess1?"green":"red"}}),e._v(" "+e._s(e.testSuccess1?"连接查询成功":"连接查询失败，请手动输入uuid")+" ")],1):e._e()],1),a("FormItem",{attrs:{label:"Master",prop:"master"}},[a("Select",{staticStyle:{width:"200px"},attrs:{placeholder:"是否为Master"},model:{value:e.oldMhaMachine.master,callback:function(t){e.$set(e.oldMhaMachine,"master",t)},expression:"oldMhaMachine.master"}},e._l(e.selectOption.isMaster,(function(t){return a("Option",{key:t.key,attrs:{value:t.value}},[e._v(e._s(t.key))])})),1)],1),a("FormItem",[a("Button",{attrs:{type:"primary"},on:{click:function(t){e.preCheckOldMhaMachine("oldMhaMachine")}}},[e._v("录入DB")]),a("br"),a("br")],1)],1)],1),a("i-col",{attrs:{span:"12"}},[a("Form",{ref:"newMhaMachine",staticStyle:{float:"left","margin-top":"50px"},attrs:{model:e.newMhaMachine,rules:e.ruleMhaMachine,"label-width":250}},[a("FormItem",{staticStyle:{width:"600px"},attrs:{label:"新集群名",prop:"mhaName"}},[a("Input",{attrs:{placeholder:"请输入源集群名"},on:{input:e.changeNewMha},model:{value:e.newMhaMachine.mhaName,callback:function(t){e.$set(e.newMhaMachine,"mhaName",t)},expression:"newMhaMachine.mhaName"}})],1),a("FormItem",{attrs:{label:"添加Ip",prop:"ip"}},[a("Input",{attrs:{placeholder:"请输入录入DB的IP"},model:{value:e.newMhaMachine.ip,callback:function(t){e.$set(e.newMhaMachine,"ip",t)},expression:"newMhaMachine.ip"}})],1),a("FormItem",{attrs:{label:"Port",prop:"port"}},[a("Input",{attrs:{number:"",placeholder:"请输入录入DB端口"},model:{value:e.newMhaMachine.port,callback:function(t){e.$set(e.newMhaMachine,"port",t)},expression:"newMhaMachine.port"}})],1),a("FormItem",{attrs:{label:"DB机房",prop:"idc"}},[a("Select",{staticStyle:{width:"200px"},attrs:{placeholder:"选择db机房区域"},model:{value:e.newMhaMachine.idc,callback:function(t){e.$set(e.newMhaMachine,"idc",t)},expression:"newMhaMachine.idc"}},e._l(e.selectOption.drcZoneList,(function(t){return a("Option",{key:t.key,attrs:{boolean:"",value:t.value}},[e._v(e._s(t.key))])})),1)],1),a("FormItem",{attrs:{label:"UUID",prop:"uuid"}},[a("Input",{attrs:{placeholder:"请输入录入DB的uuid"},model:{value:e.newMhaMachine.uuid,callback:function(t){e.$set(e.newMhaMachine,"uuid",t)},expression:"newMhaMachine.uuid"}}),a("Button",{on:{click:e.queryNewMhaMachineUuid}},[e._v("连接查询")]),e.hasTest2?a("span",[a("Icon",{attrs:{type:e.testSuccess2?"ios-checkmark-circle":"ios-close-circle",color:e.testSuccess2?"green":"red"}}),e._v(" "+e._s(e.testSuccess2?"连接查询成功":"连接查询失败，请手动输入uuid")+" ")],1):e._e()],1),a("FormItem",{attrs:{label:"Master",prop:"master"}},[a("Select",{staticStyle:{width:"200px"},attrs:{placeholder:"是否为Master"},model:{value:e.newMhaMachine.master,callback:function(t){e.$set(e.newMhaMachine,"master",t)},expression:"newMhaMachine.master"}},e._l(e.selectOption.isMaster,(function(t){return a("Option",{key:t.key,attrs:{value:t.value}},[e._v(e._s(t.key))])})),1)],1),a("FormItem",[a("Button",{attrs:{type:"primary"},on:{click:function(t){e.preCheckNewMhaMachine("newMhaMachine")}}},[e._v("录入DB")]),a("br"),a("br")],1)],1)],1)],1),a("Modal",{attrs:{title:"录入左侧Mha Db信息"},on:{"on-ok":e.submitOldMhaMachine},model:{value:e.oldMhaMachine.modal,callback:function(t){e.$set(e.oldMhaMachine,"modal",t)},expression:"oldMhaMachine.modal"}},[a("p",[e._v("Mha: "+e._s(e.oldMhaMachine.mhaName)+" ")]),a("p",[e._v(" db信息 [host: "+e._s(e.oldMhaMachine.ip)+":"+e._s(e.oldMhaMachine.port)+"]")]),a("p",[e._v(" db信息 [isMaster:"+e._s(e.oldMhaMachine.master)+"]")]),a("p",[e._v(" db信息 [idc:"+e._s(e.oldMhaMachine.idc)+"]")]),a("p",[e._v(" db信息 [uuid:"+e._s(e.oldMhaMachine.uuid)+"]")])]),a("Modal",{attrs:{title:"录入右侧Mha Db信息"},on:{"on-ok":e.submitNewMhaMachine},model:{value:e.newMhaMachine.modal,callback:function(t){e.$set(e.newMhaMachine,"modal",t)},expression:"newMhaMachine.modal"}},[a("p",[e._v("Mha: "+e._s(e.newMhaMachine.mhaName)+" ")]),a("p",[e._v(" db信息 [host: "+e._s(e.newMhaMachine.ip)+":"+e._s(e.newMhaMachine.port)+"]")]),a("p",[e._v(" db信息 [isMaster:"+e._s(e.newMhaMachine.master)+"]")]),a("p",[e._v(" db信息 [idc:"+e._s(e.newMhaMachine.idc)+"]")]),a("p",[e._v(" db信息 [uuid:"+e._s(e.newMhaMachine.uuid)+"]")])])],1)},h=[],m={name:"mhaConfig",props:{oldClusterName:String,newClusterName:String,oldDrcZone:String,newDrcZone:String},data:function(){var e=function(e,t,a){if(!/^[0-9]+$/.test(t))return a(new Error("请填写整数port"));a()},t=function(e,t,a){if(!/0|1/.test(t))return a(new Error("请填写整数port"));a()};return{result:"",status:"",title:"",message:"",hasResp:!1,hasTest1:!1,testSuccess1:!1,hasTest2:!1,testSuccess2:!1,oldMhaMachine:{modal:!1,mhaName:this.oldClusterName,zoneId:this.oldDrcZone,ip:"",port:"",idc:this.oldDrcZone,uuid:"",master:1},newMhaMachine:{modal:!1,mhaName:this.newClusterName,zoneId:this.newDrcZone,ip:"",port:"",idc:this.newDrcZone,uuid:"",master:1},ruleMhaMachine:{mhaName:[{required:!0,message:"mha集群名不能为空",trigger:"blur"}],ip:[{required:!0,message:"ip不能为空",trigger:"blur"}],port:[{required:!0,validator:e,trigger:"blur"}],idc:[{required:!0,message:"选择db区域",trigger:"blur"}],uuid:[{required:!0,message:"uuid不能为空",trigger:"blur"}],master:[{required:!0,validator:t,trigger:"blur"}]},selectOption:{isMaster:[{key:"Master",value:1},{key:"Slave",value:0}],drcZoneList:[{value:"shaoy",key:"上海欧阳"},{value:"shaxy",key:"上海新源"},{value:"sharb",key:"上海日版"},{value:"shajq",key:"上海金桥"},{value:"shafq",key:"上海福泉"},{value:"shajz",key:"上海金钟"},{value:"ntgxh",key:"南通星湖大道"},{value:"ntgxy",key:"南通xy"},{value:"fraaws",key:"法兰克福AWS"},{value:"shali",key:"上海阿里"},{value:"sinibuaws",key:"IBU-VPC"},{value:"sinaws",key:"新加坡AWS"}]}}},methods:{changeOldMha:function(){this.$emit("oldClusterChanged",this.oldMhaMachine.mhaName)},changeNewMha:function(){this.$emit("newClusterChanged",this.newMhaMachine.mhaName)},queryOldMhaMachineUuid:function(){var e=this,t=this;console.log("/api/drc/v1/mha/"+this.oldMhaMachine.mhaName+","+this.newMhaMachine.mhaName+"/uuid/"+this.oldMhaMachine.ip+"/"+this.oldMhaMachine.port+"/"+this.oldMhaMachine.master),t.axios.get("/api/drc/v1/mha/"+this.oldMhaMachine.mhaName+","+this.newMhaMachine.mhaName+"/uuid/"+this.oldMhaMachine.ip+"/"+this.oldMhaMachine.port+"/"+this.oldMhaMachine.master).then((function(t){e.hasTest1=!0,0===t.data.status?(e.oldMhaMachine.uuid=t.data.data,e.testSuccess1=!0):e.testSuccess1=!1}))},queryNewMhaMachineUuid:function(){var e=this,t=this;t.axios.get("/api/drc/v1/mha/"+this.oldMhaMachine.mhaName+","+this.newMhaMachine.mhaName+"/uuid/"+this.newMhaMachine.ip+"/"+this.newMhaMachine.port+"/"+this.oldMhaMachine.master).then((function(t){e.hasTest2=!0,0===t.data.status?(e.newMhaMachine.uuid=t.data.data,e.testSuccess2=!0):e.testSuccess2=!1}))},preCheckOldMhaMachine:function(e){var t=this;this.$refs[e].validate((function(e){e?t.oldMhaMachine.modal=!0:t.$Message.error("仍有必填项未填!")}))},submitOldMhaMachine:function(){var e=this,t=this;t.axios.post("/api/drc/v1/access/mha/machineInfo",{mhaName:this.oldMhaMachine.mhaName,master:this.oldMhaMachine.master,mySQLInstance:{ip:this.oldMhaMachine.ip,port:this.oldMhaMachine.port,idc:this.oldMhaMachine.idc,uuid:this.oldMhaMachine.uuid}}).then((function(a){t.hasResp=!0,0===a.data.status?(t.status="success",t.title="mha:"+e.oldMhaMachine.mhaName+"录入db成功!",t.message=a.data.message):(t.status="error",t.title="mha:"+e.oldMhaMachine.mhaName+"录入db失败!",t.message=a.data.message)}))},preCheckNewMhaMachine:function(e){var t=this;this.$refs[e].validate((function(e){e?t.newMhaMachine.modal=!0:t.$Message.error("仍有必填项未填!")}))},submitNewMhaMachine:function(){var e=this,t=this;t.axios.post("/api/drc/v1/access/mha/machineInfo",{mhaName:this.newMhaMachine.mhaName,master:this.newMhaMachine.master,mySQLInstance:{ip:this.newMhaMachine.ip,port:this.newMhaMachine.port,idc:this.newMhaMachine.idc,uuid:this.newMhaMachine.uuid}}).then((function(a){t.hasResp=!0,0===a.data.status?(t.status="success",t.title="mha:"+e.newMhaMachine.mhaName+"录入db成功!",t.message=a.data.message):(t.status="error",t.title="mha:"+e.newMhaMachine.mhaName+"录入db失败!",t.message=a.data.message)}))}}},M=m,b=Object(u["a"])(M,p,h,!1,null,"cc60209e",null),g=b.exports,w=a("39ba"),f=a("e537"),F=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.display.applierGroupTables?[a("span",{staticStyle:{"margin-right":"5px"}},[e._v("同步链路")]),a("Button",{attrs:{type:"primary"},on:{click:e.goToCreateApplierGroup}},[e._v("添加")]),a("br"),a("br"),a("Table",{attrs:{stripe:"",columns:e.columns,data:e.applierGroupsData,border:""},scopedSlots:e._u([{key:"action",fn:function(t){var i=t.row,r=t.index;return[a("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"primary",size:"small"},on:{click:function(t){return e.goToUpdateApplierGroup(i,r)}}},[e._v("修改")])]}},{key:"rowsFilterMappings",fn:function(t){var i=t.row,r=t.index;return[a("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"success",size:"small"},on:{click:function(t){return e.goToShowRowsFilterMappings(i,r)}}},[e._v("详情")])]}}],null,!1,803146770)})]:e._e(),e.display.applierGroupForm?a("Form",{ref:"applierGroupConfig",staticStyle:{"margin-top":"50px"},attrs:{model:e.applierGroupConfig,"label-width":250}},[a("FormItem",{staticStyle:{width:"600px"},attrs:{label:"源mha"}},[a("Select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择源集群名"},model:{value:e.applierGroupConfig.srcMha,callback:function(t){e.$set(e.applierGroupConfig,"srcMha",t)},expression:"applierGroupConfig.srcMha"}},[a("Option",{key:e.oldClusterName,attrs:{value:e.oldClusterName}},[e._v(e._s(e.oldClusterName))]),a("Option",{key:e.newClusterName,attrs:{value:e.newClusterName}},[e._v(e._s(e.newClusterName))])],1)],1),a("FormItem",{staticStyle:{width:"600px"},attrs:{label:"目标mha"}},[a("Select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择源集群名"},model:{value:e.applierGroupConfig.destMha,callback:function(t){e.$set(e.applierGroupConfig,"destMha",t)},expression:"applierGroupConfig.destMha"}},[a("Option",{key:e.newClusterName,attrs:{value:e.newClusterName}},[e._v(e._s(e.newClusterName))]),a("Option",{key:e.oldClusterName,attrs:{value:e.oldClusterName}},[e._v(e._s(e.oldClusterName))])],1)],1),a("FormItem",[a("Button",{attrs:{type:"primary"},on:{click:e.submitApplierGroupConfig}},[e._v("提交")]),a("Button",{staticStyle:{"margin-left":"50px"},on:{click:e.goToApplierGroups}},[e._v("返回")])],1)],1):e._e(),e.display.rowsFilterMap?a("rowsFilterMap",e._b({on:{closeRowsFilterMap:e.closeRowsFilterMap}},"rowsFilterMap",e.applierGroupConfig,!1)):e._e()],2)},y=[],v=(a("d3b7"),a("25f0"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.display.rowsFilterMapsTable?[a("span",{staticStyle:{"margin-right":"5px"}},[e._v("同步链路>行过滤")]),a("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"primary"},on:{click:e.goToAddMap}},[e._v("添加")]),a("Button",{staticStyle:{"margin-right":"5px"},on:{click:e.returnToApplierGroups}},[e._v("返回")]),a("br"),a("br"),a("Table",{attrs:{stripe:"",columns:e.columns,data:e.rowsFilterMappingsData,border:""},scopedSlots:e._u([{key:"action",fn:function(t){var i=t.row,r=t.index;return[a("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"primary",size:"small"},on:{click:function(t){return e.goToUpdateMapping(i,r)}}},[e._v("修改")]),a("Button",{staticStyle:{"margin-right":"10px"},attrs:{type:"error",size:"small"},on:{click:function(t){return e.goToDeleteRule(i,r)}}},[e._v("删除")])]}}],null,!1,1126015916)})]:e._e(),e.display.rowsFilterMapForm?a("Form",{ref:"mappingForSubmit",staticStyle:{"margin-top":"50px"},attrs:{model:e.mappingForSubmit,"label-width":250}},[a("FormItem",{staticStyle:{width:"600px"},attrs:{label:"逻辑表"}},[a("Row",[a("Col",{attrs:{span:"18"}},[a("Input",{attrs:{readonly:"",placeholder:"请选择逻辑表"},model:{value:e.mappingForSubmit.dataMediaId,callback:function(t){e.$set(e.mappingForSubmit,"dataMediaId",t)},expression:"mappingForSubmit.dataMediaId"}})],1),a("Col",{attrs:{span:"4"}},[a("Button",{staticStyle:{"margin-left":"50px"},attrs:{type:"primary"},on:{click:e.goToChoseDataMedia}},[e._v("选择")])],1)],1)],1),a("FormItem",{staticStyle:{width:"600px"},attrs:{label:"行过滤规则"}},[a("Row",[a("Col",{attrs:{span:"18"}},[a("Input",{attrs:{readonly:"",placeholder:"请选择行过滤规则,不选默认无行过滤"},model:{value:e.mappingForSubmit.rowsFilter.name,callback:function(t){e.$set(e.mappingForSubmit.rowsFilter,"name",t)},expression:"mappingForSubmit.rowsFilter.name"}})],1),a("Col",{attrs:{span:"4"}},[a("Button",{staticStyle:{"margin-left":"50px"},attrs:{type:"primary"},on:{click:e.goToChoseRowsFilter}},[e._v("选择")])],1)],1)],1),a("FormItem",[a("Button",{attrs:{type:"primary"},on:{click:e.submitRowsFilterMappingConfig}},[e._v("提交")]),a("Button",{staticStyle:{"margin-left":"50px"},on:{click:e.cancel}},[e._v("返回")])],1)],1):e._e(),e.display.dataMedia?a("dataMedia",e._b({on:{dataMediaChose:e.dataMediaIdChose,closeDataMedia:e.closeDataMedia}},"dataMedia",e.propsForDataMedia,!1)):e._e(),e.display.rowsFilter?a("rowsFilter",{on:{rowsFilterChose:e.rowsFilterChose,closeRowsFilter:e.closeRowsFilter}}):e._e()],2)}),S=[],C=(a("b0c0"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.display.dataMediasTable?[a("span",{staticStyle:{"margin-right":"5px"}},[e._v("同步链路>行过滤>datMedia")]),a("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"primary"},on:{click:e.goToCreateDataMedia}},[e._v("创建")]),a("Button",{staticStyle:{"margin-right":"5px"},on:{click:e.returnToMapping}},[e._v("返回")]),a("br"),a("br"),a("Table",{attrs:{stripe:"",columns:e.columns,data:e.dataMediasData,border:""},scopedSlots:e._u([{key:"action",fn:function(t){var i=t.row,r=t.index;return[a("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"primary",size:"small"},on:{click:function(t){return e.choseDataMedia(i,r)}}},[e._v("选择")]),a("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"success",size:"small"},on:{click:function(t){return e.showDataMedia(i,r)}}},[e._v("查看")])]}}],null,!1,1809813093)})]:e._e(),e.display.dataMediaForm?a("Form",{ref:"dataMediaForSubmit",staticStyle:{"margin-top":"50px"},attrs:{model:e.dataMediaForSubmit,"label-width":250}},[a("FormItem",{staticStyle:{width:"600px"},attrs:{label:"逻辑库"}},[a("Input",{attrs:{placeholder:"请输入逻辑库名，支持正则"},model:{value:e.dataMediaForSubmit.namespace,callback:function(t){e.$set(e.dataMediaForSubmit,"namespace",t)},expression:"dataMediaForSubmit.namespace"}})],1),a("FormItem",{staticStyle:{width:"720px"},attrs:{label:"逻辑表"}},[a("Row",[a("Col",{attrs:{span:"18"}},[a("Input",{attrs:{placeholder:"请输入逻辑表名，支持正则"},model:{value:e.dataMediaForSubmit.name,callback:function(t){e.$set(e.dataMediaForSubmit,"name",t)},expression:"dataMediaForSubmit.name"}})],1),a("Col",{attrs:{span:"4"}},[a("Button",{staticStyle:{"margin-left":"50px"},attrs:{type:"primary"},on:{click:e.checkTable}},[e._v("匹配校验")])],1)],1)],1),a("FormItem",{staticStyle:{width:"600px"},attrs:{label:"数据源"}},[a("Input",{attrs:{readonly:""},model:{value:e.dataMediaForSubmit.dataMediaSourceName,callback:function(t){e.$set(e.dataMediaForSubmit,"dataMediaSourceName",t)},expression:"dataMediaForSubmit.dataMediaSourceName"}})],1),a("FormItem",[e.display.checkBeforeSubmit?a("Button",{attrs:{type:"primary"},on:{click:e.submitDataMediaConfig}},[e._v("提交")]):e._e(),a("Button",{staticStyle:{"margin-left":"50px"},on:{click:e.cancelSubmit}},[e._v("返回")])],1)],1):e._e(),e.display.checkBeforeSubmit?a("Table",{attrs:{stripe:"",columns:e.columnsForTableCheck,data:e.tableData,border:""}}):e._e()],2)}),x=[],k={name:"dataMedia",props:{srcMha:String,destMha:String,srcDc:String,destDc:String,applierGroupId:String},data:function(){return{display:{dataMediasTable:!0,dataMediaForm:!1,checkBeforeSubmit:!1},dataMediasData:[],columns:[{title:"序号",key:"id",width:60},{title:"数据源",key:"dataMediaSourceName"},{title:"逻辑库",key:"namespace"},{title:"逻辑表",key:"name"},{title:"操作",slot:"action",align:"center"}],tableData:[],columnsForTableCheck:[{title:"序号",width:75,align:"center",render:function(e,t){return e("span",t.index+1)}},{title:"库名",key:"schema"},{title:"表名",key:"name"}],dataMediaForSubmit:{namespace:null,name:null,type:null,dataMediaSourceId:null,dataMediaSourceName:null},applierGroupConfig:{srcMha:null,destMha:null,srcDc:null,destDc:null,applierGroupId:null}}},methods:{getDataMediasData:function(){var e=this;this.axios.get("/api/drc/v1/build/dataMedias/"+this.applierGroupId+"/"+this.srcMha).then((function(t){1===t.data.status?window.alert("查询dataMedias 失败"):e.dataMediasData=t.data.data}))},goToCreateDataMedia:function(){console.log("创建"),this.dataMediaForSubmit.dataMediaSourceName=this.srcMha,this.display={dataMediasTable:!1,dataMediaForm:!0,checkBeforeSubmit:!1}},checkTable:function(){var e=this;this.axios.get("/api/drc/v1/build/dataMedia/check/"+this.dataMediaForSubmit.namespace+"/"+this.dataMediaForSubmit.name+"/"+this.srcDc+"/"+this.dataMediaForSubmit.dataMediaSourceName+"/0").then((function(t){e.display.checkBeforeSubmit=!0,1===t.data.status?window.alert("查询匹配表失败"):(console.log(t.data.data),e.tableData=t.data.data,0===e.tableData.length&&window.alert("无匹配表 或 查询匹配表失败"))}))},goToUpdateDataMedia:function(e,t){},submitDataMediaConfig:function(){var e=this;0!==this.tableData.length?this.axios.post("/api/drc/v1/meta/dataMedia",{namespace:this.dataMediaForSubmit.namespace,name:this.dataMediaForSubmit.name,type:0,dataMediaSourceName:this.dataMediaForSubmit.dataMediaSourceName}).then((function(t){1===t.data.status?window.alert("提交失败!"):(e.getDataMediasData(),window.alert("提交成功！"))})):window.alert("没有匹配的表,禁止提交！")},cancelSubmit:function(){this.display={dataMediasTable:!0,dataMediaForm:!1,checkBeforeSubmit:!1}},removeDataMediaConfig:function(e,t){},showDataMedia:function(e,t){this.dataMediaForSubmit={namespace:e.namespace,name:e.name,type:0,dataMediaSourceName:this.srcMha},this.display={dataMediasTable:!1,dataMediaForm:!0,checkBeforeSubmit:!1}},choseDataMedia:function(e,t){this.resetDisplay(),this.$emit("dataMediaChose",e.id)},returnToMapping:function(){this.resetDisplay(),this.$emit("closeDataMedia")},resetDisplay:function(){this.display={dataMediasTable:!0,dataMediaForm:!1,checkBeforeSubmit:!1}}},created:function(){this.getDataMediasData()}},_=k,D=Object(u["a"])(_,C,x,!1,null,"1a520ce0",null),I=D.exports,N=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.display.rowsFiltersTable?[a("span",{staticStyle:{"margin-right":"5px"}},[e._v("同步链路>行过滤>RowsFilter")]),a("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"primary"},on:{click:e.goToCreateRowsFiltersTable}},[e._v("创建")]),a("Button",{staticStyle:{"margin-right":"5px"},on:{click:e.returnToMapping}},[e._v("返回")]),a("br"),a("br"),a("Table",{attrs:{stripe:"",columns:e.columns,data:e.rowsFiltersData,border:""},scopedSlots:e._u([{key:"action",fn:function(t){var i=t.row,r=t.index;return[a("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"primary",size:"small"},on:{click:function(t){return e.choseRowsFilter(i,r)}}},[e._v("选择")]),a("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"success",size:"small"},on:{click:function(t){return e.showRowsFilter(i,r)}}},[e._v("查看")])]}}],null,!1,920640325)})]:e._e(),e.display.rowsFilterForm?a("Form",{ref:"rowsFilterForSubmit",staticStyle:{"margin-top":"50px"},attrs:{model:e.rowsFilterForSubmit,"label-width":250}},[a("FormItem",{staticStyle:{width:"600px"},attrs:{label:"规则名"}},[a("Input",{staticStyle:{width:"300px"},attrs:{placeholder:"请为该规则命名"},model:{value:e.rowsFilterForSubmit.name,callback:function(t){e.$set(e.rowsFilterForSubmit,"name",t)},expression:"rowsFilterForSubmit.name"}})],1),a("FormItem",{staticStyle:{width:"600px"},attrs:{label:"模式"}},[a("Select",{staticStyle:{width:"300px"},attrs:{placeholder:"选择行过滤模式"},model:{value:e.rowsFilterForSubmit.mode,callback:function(t){e.$set(e.rowsFilterForSubmit,"mode",t)},expression:"rowsFilterForSubmit.mode"}},e._l(e.modesForChose,(function(t){return a("Option",{key:t,attrs:{value:t}},[e._v(e._s(t))])})),1)],1),a("FormItem",{staticStyle:{width:"600px"},attrs:{label:"选择列名"}},[a("Select",{staticStyle:{width:"300px"},attrs:{multiple:"",placeholder:"选择相关列"},model:{value:e.rowsFilterForSubmit.columns,callback:function(t){e.$set(e.rowsFilterForSubmit,"columns",t)},expression:"rowsFilterForSubmit.columns"}},e._l(e.columnsForChose,(function(t){return a("Option",{key:t,attrs:{value:t}},[e._v(e._s(t))])})),1)],1),a("FormItem",{staticStyle:{width:"720px"},attrs:{label:"手动添加列名"}},[a("Row",[a("Col",{attrs:{span:"18"}},[a("Input",{attrs:{placeholder:"手动添加列"},model:{value:e.columnForAdd,callback:function(t){e.columnForAdd=t},expression:"columnForAdd"}})],1),a("Col",{attrs:{span:"4"}},[a("Button",{staticStyle:{"margin-left":"50px"},attrs:{type:"primary"},on:{click:e.addColumn}},[e._v("添加")])],1)],1)],1),a("FormItem",{staticStyle:{width:"600px"},attrs:{label:"规则内容"}},[a("Input",{staticStyle:{width:"300px"},attrs:{type:"textarea",placeholder:"请输入行过滤内容"},model:{value:e.rowsFilterForSubmit.content,callback:function(t){e.$set(e.rowsFilterForSubmit,"content",t)},expression:"rowsFilterForSubmit.content"}})],1),a("FormItem",[a("Button",{attrs:{type:"primary"},on:{click:e.submitRowsFilter}},[e._v("提交")]),a("Button",{staticStyle:{"margin-left":"50px"},on:{click:e.cancelSubmit}},[e._v("返回")])],1)],1):e._e()],2)},T=[],G={name:"rowsFilter",data:function(){return{display:{rowsFiltersTable:!0,rowsFilterForm:!1},rowsFiltersData:[],columns:[{title:"序号",key:"id",width:60},{title:"规则名",key:"name"},{title:"模式",key:"mode"},{title:"列名",key:"columns"},{title:"内容",key:"content"},{title:"操作",slot:"action",align:"center"}],rowsFilterForSubmit:{id:null,name:null,mode:null,columns:[],content:null},modesForChose:["aviator_regex","java_regex","trip_uid","custom"],columnsForChose:["columnA","columnB"],columnForAdd:null}},methods:{getAllRowsFilters:function(){var e=this;this.axios.get("/api/drc/v1/build/rowsFilters").then((function(t){1===t.data.status?window.alert("查询RowsFilters 失败"):(console.log(t.data.data),e.rowsFiltersData=t.data.data)}))},goToCreateRowsFiltersTable:function(){console.log("创建"),this.rowsFilterForSubmit={id:null,name:null,mode:null,columns:[],content:null},this.display={rowsFiltersTable:!1,rowsFilterForm:!0}},showRowsFilter:function(e,t){this.columnsForChose=e.columns,this.rowsFilterForSubmit={id:e.id,name:e.name,mode:e.mode,columns:e.columns,content:e.content},this.display={rowsFiltersTable:!1,rowsFilterForm:!0}},addColumn:function(){this.columnsForChose.push(this.columnForAdd),this.rowsFilterForSubmit.columns.push(this.columnForAdd)},submitRowsFilter:function(){var e=this,t=this.rowsFilterForSubmit;null!==t.name&&null!==t.mode?this.axios.post("/api/drc/v1/meta/rowsFilter",t).then((function(t){1===t.data.status?window.alert("提交失败!"):(window.alert("提交成功！"),e.dataMediasData=t.data.data,e.getAllRowsFilters())})):window.alert("参数缺失，禁止提交！")},cancelSubmit:function(){this.display={rowsFiltersTable:!0,rowsFilterForm:!1}},choseRowsFilter:function(e,t){this.resetDisplay(),console.log(e.id),console.log(e.name),this.$emit("rowsFilterChose",[e.id,e.name])},returnToMapping:function(){this.resetDisplay(),this.$emit("closeRowsFilter")},resetDisplay:function(){this.display={rowsFiltersTable:!0,rowsFilterForm:!1}}},created:function(){this.getAllRowsFilters()}},B=G,$=Object(u["a"])(B,N,T,!1,null,"d53916e2",null),R=$.exports,Z={components:{dataMedia:I,rowsFilter:R},name:"rowsFilterMap",props:{srcMha:String,destMha:String,srcDc:String,destDc:String,applierGroupId:String},data:function(){var e=this;return{display:{rowsFilterMapsTable:!0,rowsFilterMapForm:!1,dataMedia:!1,rowsFilter:!1},rowsFilterMappingsData:[],columns:[{title:"序号",key:"id",width:"50"},{title:"数据源",width:200,align:"center",render:function(t,a){return t("span",e.srcMha)}},{title:"逻辑库",key:"namespace"},{title:"逻辑表",key:"name"},{title:"行过滤规则",key:"rowsFilterName"},{title:"操作",slot:"action",align:"center"}],mappingForSubmit:{id:null,dataMediaId:null,rowsFilter:{id:null,name:null}},propsForDataMedia:{srcMha:this.srcMha,destMha:this.destMha,srcDc:this.srcDc,destDc:this.destDc,applierGroupId:this.applierGroupId}}},methods:{getRowsFilterMappings:function(){var e=this;console.log("getRowsFilterMappings/api/drc/v1/build/RowsFilterMappings/"+this.applierGroupId),this.axios.get("/api/drc/v1/build/RowsFilterMappings/"+this.applierGroupId).then((function(t){1===t.data.status?window.alert("查询dataMedias 失败"):(console.log(t.data.data),e.rowsFilterMappingsData=t.data.data)}))},goToAddMap:function(){this.mappingForSubmit={id:null,dataMediaId:null,rowsFilter:{id:null,name:null}},this.display={rowsFilterMapsTable:!1,rowsFilterMapForm:!0,dataMedia:!1,rowsFilter:!1}},goToUpdateMapping:function(e,t){console.log(e),this.mappingForSubmit={id:e.id,dataMediaId:e.dataMediaId,rowsFilter:{id:e.rowsFilterId,name:e.rowsFilterName}},this.display={rowsFilterMapsTable:!1,rowsFilterMapForm:!0,dataMedia:!1,rowsFilter:!1}},goToDeleteRule:function(e,t){var a=this;this.axios.post("/api/drc/v1/meta/rowsFilterMapping/delete",{id:e.id,applierGroupId:this.applierGroupId,dataMediaId:e.dataMediaId,rowsFilterId:e.rowsFilterId}).then((function(e){console.log(e.data),console.log(e.data.data),0===e.data.status?(alert("删除成功！"),a.getRowsFilterMappings()):alert("操作失败！")}))},submitRowsFilterMappingConfig:function(){var e=this;this.axios.post("/api/drc/v1/meta/rowsFilterMapping",{id:this.mappingForSubmit.id,applierGroupId:this.applierGroupId,dataMediaId:this.mappingForSubmit.dataMediaId,rowsFilterId:this.mappingForSubmit.rowsFilter.id}).then((function(t){1===t.data.status?window.alert("失败！"+t.data.data):(e.getRowsFilterMappings(),window.alert("成功！"+t.data.data))}))},cancel:function(){this.display={rowsFilterMapsTable:!0,rowsFilterMapForm:!1,dataMedia:!1,rowsFilter:!1}},goToChoseDataMedia:function(){this.display={rowsFilterMapsTable:!1,rowsFilterMapForm:!1,dataMedia:!0,rowsFilter:!1}},dataMediaIdChose:function(e){this.display={rowsFilterMapsTable:!1,rowsFilterMapForm:!0,dataMedia:!1,rowsFilter:!1},this.mappingForSubmit.dataMediaId=e},closeDataMedia:function(){this.display={rowsFilterMapsTable:!1,rowsFilterMapForm:!0,dataMedia:!1,rowsFilter:!1}},goToChoseRowsFilter:function(){null!==this.mappingForSubmit.dataMediaId?this.display={rowsFilterMapsTable:!1,rowsFilterMapForm:!1,dataMedia:!1,rowsFilter:!0}:window.alert("请先选择逻辑表！")},rowsFilterChose:function(e){this.display={rowsFilterMapsTable:!1,rowsFilterMapForm:!0,dataMedia:!1,rowsFilter:!1},console.log("map"+e),this.mappingForSubmit.rowsFilter.id=e[0],this.mappingForSubmit.rowsFilter.name=e[1]},closeRowsFilter:function(){this.display={rowsFilterMapsTable:!1,rowsFilterMapForm:!0,dataMedia:!1,rowsFilter:!1}},returnToApplierGroups:function(){this.$emit("closeRowsFilterMap")}},created:function(){this.getRowsFilterMappings()}},O=Z,A=Object(u["a"])(O,v,S,!1,null,"680f2286",null),q=A.exports,j={components:{rowsFilterMap:q},name:"applierGroups",props:{oldClusterName:String,newClusterName:String,oldDrcZone:String,newDrcZone:String},data:function(){return{display:{applierGroupTables:!0,applierGroupForm:!1,rowsFilterMap:!1},columns:[{title:"序号",key:"applierGroupId",width:60},{title:"源集群",key:"srcMha"},{title:"目标集群",key:"destMha"},{title:"方向",key:"direction",width:260,align:"center",render:function(e,t){var a=t.row,i="blue",r=a.srcDc+" ==> "+a.destDc;return e("Tag",{props:{color:i}},r)}},{title:"行过滤",slot:"rowsFilterMappings",align:"center"},{title:"操作",slot:"action",align:"center"}],applierGroupsData:[],applierGroupConfig:{srcMha:null,destMha:null,srcDc:null,destDc:null,applierGroupId:null},hasResp:!1}},methods:{subCurrentChange:function(){this.$emit("subCurrentChange",this.subCurrent)},getApplierGroupsData:function(){var e=this;this.axios.get("/api/drc/v1/build/applierGroups/"+this.oldClusterName+"/"+this.newClusterName).then((function(t){1===t.data.status?window.alert("查询同步链路信息失败！"):e.applierGroupsData=t.data.data}))},goToCreateApplierGroup:function(){this.display={applierGroupTables:!1,applierGroupForm:!0,rowsFilterMap:!1}},goToApplierGroups:function(){this.display.applierGroupTables=!0,this.display.applierGroupForm=!1},goToShowRowsFilterMappings:function(e,t){this.applierGroupConfig.srcMha=e.srcMha,this.applierGroupConfig.destMha=e.destMha,this.applierGroupConfig.srcDc=e.srcDc,this.applierGroupConfig.destDc=e.destDc,this.applierGroupConfig.applierGroupId=e.applierGroupId.toString(),this.display.applierGroupTables=!1,this.display.applierGroupForm=!1,this.display.rowsFilterMap=!0},submitApplierGroupConfig:function(){var e=this;null!==this.applierGroupConfig.srcMha&&null!==this.applierGroupConfig.destMha&&this.applierGroupConfig.srcMha!==this.applierGroupConfig.destMha&&2!==this.applierGroupsData.size?(console.log("post build"),this.axios.post("/api/drc/v1/build/simplexDrc",{srcMha:this.applierGroupConfig.srcMha,destMha:this.applierGroupConfig.destMha}).then((function(t){e.hasResp=!0,0===t.data.status?(e.status="success",e.title="创建单向同步通道成功!",e.applierGroupConfig.applierGroupId=t.data.data.applierGroupId,e.getApplierGroupsData()):(e.status="error",e.title="创建单向同步通道失败!",e.message=t.data.message)}))):(console.log("forbid post build"),this.hasResp=!0,this.status="error",this.title="无效配置，禁止创建!")},handleReset:function(e){this.$refs[e].resetFields()},goToUpdateApplierGroup:function(e,t){this.applierGroupConfig.srcMha=e.srcMha,this.applierGroupConfig.destMha=e.destMha,this.applierGroupConfig.srcDc=e.srcDc,this.applierGroupConfig.destDc=e.destDc,this.applierGroupConfig.applierGroupId=e.applierGroupId,console.log(e.applierGroupId),this.goToCreateApplierGroup()},removeApplierGroup:function(e,t){},closeRowsFilterMap:function(){this.display={applierGroupTables:!0,applierGroupForm:!1,rowsFilterMap:!1}}},created:function(){this.getApplierGroupsData()}},U=j,P=Object(u["a"])(U,F,y,!1,null,"1ca1326e",null),E=P.exports,z={components:{applierGroups:E,buildV2:d,mhaConfig:g,drc:w["a"],complete:f["a"]},data:function(){return{current:0,clusterPair:{oldClusterName:this.$route.query.clustername,newClusterName:this.$route.query.newclustername,env:"",oldDrcZone:"",newDrcZone:""},subCurrent:2.1}},methods:{jumpTo:function(e){this.current=e,this.hasResp=!1},next:function(){this.current=this.current+1,this.hasResp=!1},prev:function(){this.current=this.current-1,this.hasResp=!1},updateOldCluster:function(e){this.clusterPair.oldClusterName=e},updateNewCluster:function(e){this.clusterPair.newClusterName=e},updateOldZone:function(e){this.clusterPair.oldDrcZone=e},updateNewZone:function(e){this.clusterPair.newDrcZone=e},updateEnv:function(e){this.clusterPair.env=e},updateSubCurrent:function(e){this.subCurrent=e}},created:function(){var e=this.$route.query.step;"undefined"===typeof e?console.log("curStep undefined, do nothing"):this.jumpTo(Number(e))}},L=z,V=Object(u["a"])(L,i,r,!1,null,"5dc43f40",null);t["default"]=V.exports},ad6d:function(e,t,a){"use strict";var i=a("825a");e.exports=function(){var e=i(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}}}]);
//# sourceMappingURL=chunk-8c014838.247ca3c6.js.map