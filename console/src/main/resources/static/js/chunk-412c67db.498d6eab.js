(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-412c67db"],{1431:function(a,t,e){"use strict";e.r(t);var i=function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("base-component",[e("Breadcrumb",{style:{margin:"15px 0 15px 185px",position:"fixed"}},[e("BreadcrumbItem",{attrs:{to:"/home"}},[a._v("首页")]),e("BreadcrumbItem",{attrs:{to:"/applicationForm"}},[a._v("DRC审批")]),e("BreadcrumbItem",[a._v("DRC申请")])],1),e("Content",{staticClass:"content",style:{padding:"10px",background:"#fff",margin:"50px 0 1px 185px",zIndex:"1"}},[e("div",{staticStyle:{padding:"1px 1px"}},[e("Form",{ref:"buildParam",attrs:{model:a.buildParam,rules:a.ruleValidate,"label-width":140,disabled:a.showDetail}},[e("FormItem",{attrs:{label:"同步DB",prop:"dbName"}},[e("Input",{attrs:{placeholder:"输入同步DB"},model:{value:a.buildParam.dbName,callback:function(t){a.$set(a.buildParam,"dbName",t)},expression:"buildParam.dbName"}})],1),e("FormItem",{attrs:{label:"同步表",prop:"tableName"}},[e("Input",{attrs:{type:"textarea",autosize:{minRows:1,maxRows:5},placeholder:"输入同步表,多表用,分隔; 不填默认同步所有表"},model:{value:a.buildParam.tableName,callback:function(t){a.$set(a.buildParam,"tableName",t)},expression:"buildParam.tableName"}})],1),e("FormItem",{attrs:{label:"同步方向",required:!0}},[e("Row",[e("Col",{attrs:{span:"11"}},[e("Card",{attrs:{bordered:!0},scopedSlots:a._u([{key:"title",fn:function(){return[e("Icon",{attrs:{type:"ios-pin"}}),a._v(" 源 region ")]},proxy:!0}])},[e("FormItem",{attrs:{prop:"srcRegion"}},[e("Select",{attrs:{filterable:"",clearable:"",placeholder:"地域"},model:{value:a.buildParam.srcRegion,callback:function(t){a.$set(a.buildParam,"srcRegion",t)},expression:"buildParam.srcRegion"}},a._l(a.regionOptions,(function(t){return e("Option",{key:t,attrs:{value:t,label:t}},[a._v(" "+a._s(t)+" ")])})),1)],1)],1)],1),e("Col",{staticStyle:{"text-align":"center"},attrs:{span:"2"}},[e("Button",{attrs:{size:"middle",shape:"circle",type:"default"},on:{click:function(t){return a.reverseRegion()}}},[a._v(" -> ")])],1),e("Col",{attrs:{span:"11"}},[e("Card",{attrs:{bordered:!0},scopedSlots:a._u([{key:"title",fn:function(){return[e("Icon",{attrs:{type:"ios-pin"}}),a._v(" 目标 region ")]},proxy:!0}])},[e("FormItem",{attrs:{prop:"dstRegion"}},[e("Select",{attrs:{filterable:"",clearable:"",placeholder:"地域",prop:"dstRegion"},model:{value:a.buildParam.dstRegion,callback:function(t){a.$set(a.buildParam,"dstRegion",t)},expression:"buildParam.dstRegion"}},a._l(a.regionOptions,(function(t){return e("Option",{key:t,attrs:{value:t,label:t}},[a._v(" "+a._s(t)+" ")])})),1)],1)],1)],1)],1)],1),e("FormItem",{attrs:{label:"过滤方式",prop:"filterType"}},[e("Select",{model:{value:a.buildParam.filterType,callback:function(t){a.$set(a.buildParam,"filterType",t)},expression:"buildParam.filterType"}},a._l(a.filterTypeOpts,(function(t){return e("Option",{key:t,attrs:{value:t}},[a._v(a._s(t))])})),1)],1),e("FormItem",{attrs:{label:"BU",prop:"buName"}},[e("Select",{attrs:{filterable:"",prefix:"ios-home",placeholder:"部门"},on:{"on-change":a.autoSetTag},model:{value:a.buildParam.buName,callback:function(t){a.$set(a.buildParam,"buName",t)},expression:"buildParam.buName"}},a._l(a.bus,(function(t){return e("Option",{key:t.buName,attrs:{value:t.buName}},[a._v(a._s(t.buName))])})),1)],1),e("FormItem",{attrs:{label:"Tag",prop:"tag"}},[e("Select",{attrs:{filterable:"","allow-create":""},on:{"on-create":a.handleCreateTag},model:{value:a.buildParam.tag,callback:function(t){a.$set(a.buildParam,"tag",t)},expression:"buildParam.tag"}},a._l(a.tags,(function(t){return e("Option",{key:t,attrs:{value:t}},[a._v(a._s(t))])})),1)],1),e("FormItem",{attrs:{label:"是否刷存量数据",prop:"flushExistingData"}},[e("RadioGroup",{model:{value:a.buildParam.flushExistingData,callback:function(t){a.$set(a.buildParam,"flushExistingData",t)},expression:"buildParam.flushExistingData"}},[e("Radio",{attrs:{label:"0"}},[a._v("否")]),e("Radio",{attrs:{label:"1"}},[a._v("是")])],1)],1),e("FormItem",{attrs:{label:"是否订单相关",prop:"orderRelated"}},[e("RadioGroup",{model:{value:a.buildParam.orderRelated,callback:function(t){a.$set(a.buildParam,"orderRelated",t)},expression:"buildParam.orderRelated"}},[e("Radio",{attrs:{label:"0"}},[a._v("否")]),e("Radio",{attrs:{label:"1"}},[a._v("是")])],1)],1),e("FormItem",{attrs:{label:"同步开始位点",prop:"gtidInit"}},[e("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:"输入同步开始位点"},model:{value:a.buildParam.gtidInit,callback:function(t){a.$set(a.buildParam,"gtidInit",t)},expression:"buildParam.gtidInit"}})],1),e("FormItem",{attrs:{label:"中断影响",prop:"disruptionImpact"}},[e("Input",{attrs:{type:"textarea",autosize:{minRows:1,maxRows:2},placeholder:"中断影响"},model:{value:a.buildParam.disruptionImpact,callback:function(t){a.$set(a.buildParam,"disruptionImpact",t)},expression:"buildParam.disruptionImpact"}})],1),e("FormItem",{attrs:{label:"tps",prop:"tps"}},[e("Input",{attrs:{placeholder:"tps"},model:{value:a.buildParam.tps,callback:function(t){a.$set(a.buildParam,"tps",t)},expression:"buildParam.tps"}})],1),e("FormItem",{attrs:{label:"申请人",prop:"applicant"}},[e("Input",{attrs:{placeholder:"申请人"},model:{value:a.buildParam.applicant,callback:function(t){a.$set(a.buildParam,"applicant",t)},expression:"buildParam.applicant"}})],1),e("FormItem",{attrs:{label:"备注",prop:"remark"}},[e("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:"备注"},model:{value:a.buildParam.remark,callback:function(t){a.$set(a.buildParam,"remark",t)},expression:"buildParam.remark"}})],1),a.showDetail?a._e():e("FormItem",[e("Button",{attrs:{type:"primary"},on:{click:function(t){return a.handleSubmit("buildParam")}}},[a._v("提交")]),e("Button",{staticStyle:{"margin-left":"20px"},on:{click:function(t){return a.handleReset("buildParam")}}},[a._v("重置")])],1)],1),a.showDetail?e("Button",{staticStyle:{"margin-left":"80px"},attrs:{type:"primary"},on:{click:function(t){return a.toDrcBuild()}}},[a._v("审批")]):a._e()],1)])],1)},r=[],s=(e("a4d3"),e("e01a"),e("caad"),e("2532"),{name:"applicationBuild",data:function(){return{applicationFormId:null,buildLoading:!1,showDetail:!1,bus:[],tags:this.constant.tagList,regionOptions:[],filterTypeOpts:["ALL","UDL"],replicationTypeOpts:[{name:"单向同步",val:0},{name:"双向同步",val:1}],buildParam:{dbName:"",tableName:"",srcRegion:"",dstRegion:"",filterType:"ALL",buName:"",tps:"",description:"",disruptionImpact:"",tag:"",flushExistingData:"0",orderRelated:"0",gtidInit:"",remark:"",applicant:""},ruleValidate:{dbName:[{required:!0,message:"请输入同步DB",trigger:"blur"}],applicant:[{required:!0,message:"请输入申请人",trigger:"blur"}],filterType:[{required:!0,message:"请选择过滤类型",trigger:"change"}],flushExistingData:[{required:!0,message:"请选择是否刷存量数据",trigger:"change"}],orderRelated:[{required:!0,message:"请选择是否订单相关",trigger:"change"}],srcRegion:[{required:!0,message:"请选择源region",trigger:"change"}],dstRegion:[{required:!0,message:"请选择目标region",trigger:"change"}],buName:[{required:!0,message:"请选择BU",trigger:"change"}],tag:[{required:!0,message:"请选择tag",trigger:"change"}]}}},methods:{handleCreateTag:function(a){this.constant.tagList.push(a),this.tags.push(a)},reverseRegion:function(){var a=this.buildParam.srcRegion;this.buildParam.srcRegion=this.buildParam.dstRegion,this.buildParam.dstRegion=a},getRegions:function(){var a=this;this.axios.get("/api/drc/v2/autoconfig/region/all").then((function(t){a.regionOptions=t.data.data}))},autoSetTag:function(){"FLT"===this.buildParam.buName?this.buildParam.tag="FLT":"HTL"===this.buildParam.buName?this.buildParam.tag="HTL":this.buildParam.tag="COMMON"},getBus:function(){var a=this;this.axios.get("/api/drc/v2/meta/bus/all").then((function(t){a.bus=t.data.data}))},toDrcBuild:function(){var a=this;this.axios.post("/api/drc/v2/application/approve?applicationFormId="+this.applicationFormId).then((function(t){1===t.data.status?a.$Message.error(t.data.message):a.$router.push({path:"/drcBuild",query:{dalClusterName:a.buildParam.dbName+"_dalcluster",tableName:a.changeTableName(a.buildParam.tableName),srcRegion:a.buildParam.srcRegion,dstRegion:a.buildParam.dstRegion,filterType:a.buildParam.filterType,buName:a.buildParam.buName,tag:a.buildParam.tag,flushExistingData:a.buildParam.flushExistingData,gtidInit:a.buildParam.gtidInit,applicationFormId:a.applicationFormId}})}))},changeTableName:function(a){return null===a||""===a?".*":a.includes(",")?"("+a.replaceAll(",","|")+")":a},handleSubmit:function(a){this.validate(a),console.log(this.buildParam)},submit:function(){var a=this;this.dataLoading=!0;var t={dbName:this.buildParam.dbName,tableName:this.buildParam.tableName,srcRegion:this.buildParam.srcRegion,dstRegion:this.buildParam.dstRegion,filterType:this.buildParam.filterType,buName:this.buildParam.buName,tps:this.buildParam.tps,description:this.buildParam.description,disruptionImpact:this.buildParam.disruptionImpact,tag:this.buildParam.tag,flushExistingData:this.buildParam.flushExistingData,orderRelated:this.buildParam.orderRelated,gtidInit:this.buildParam.gtidInit,remark:this.buildParam.remark,applicant:this.buildParam.applicant};this.axios.post("/api/drc/v2/application/",t).then((function(t){a.dataLoading=!1,1===t.data.status?a.$Message.error({content:"提交失败! "+t.data.message,duration:2}):a.$Message.success("提交成功！")}))},validate:function(a){var t=this;this.$refs[a].validate((function(a){a?t.submit():t.$Message.error("仍有必填项未填!")}))},handleReset:function(a){this.$refs[a].resetFields()},init:function(){this.showDetail=this.$route.query.showDetail,this.buildParam={dbName:this.$route.query.dbName,tableName:this.$route.query.tableName,srcRegion:this.$route.query.srcRegion,dstRegion:this.$route.query.dstRegion,filterType:this.$route.query.filterType,buName:this.$route.query.buName,tps:this.$route.query.tps,description:this.$route.query.description,disruptionImpact:this.$route.query.disruptionImpact,tag:this.$route.query.tag,flushExistingData:this.$route.query.flushExistingData,orderRelated:this.$route.query.orderRelated,gtidInit:this.$route.query.gtidInit,remark:this.$route.query.remark,applicant:this.$route.query.applicant},this.applicationFormId=this.$route.query.applicationFormId}},created:function(){this.getBus(),this.getRegions(),this.init()}}),l=s,n=e("2877"),o=Object(n["a"])(l,i,r,!1,null,"6c718dfc",null);t["default"]=o.exports},2532:function(a,t,e){"use strict";var i=e("23e7"),r=e("5a34"),s=e("1d80"),l=e("ab13");i({target:"String",proto:!0,forced:!l("includes")},{includes:function(a){return!!~String(s(this)).indexOf(r(a),arguments.length>1?arguments[1]:void 0)}})},"44e7":function(a,t,e){var i=e("861d"),r=e("c6b6"),s=e("b622"),l=s("match");a.exports=function(a){var t;return i(a)&&(void 0!==(t=a[l])?!!t:"RegExp"==r(a))}},"5a34":function(a,t,e){var i=e("44e7");a.exports=function(a){if(i(a))throw TypeError("The method doesn't accept regular expressions");return a}},ab13:function(a,t,e){var i=e("b622"),r=i("match");a.exports=function(a){var t=/./;try{"/./"[a](t)}catch(e){try{return t[r]=!1,"/./"[a](t)}catch(i){}}return!1}}}]);
//# sourceMappingURL=chunk-412c67db.498d6eab.js.map