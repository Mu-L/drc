(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0c203f"],{4904:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("base-component",[r("Breadcrumb",{style:{margin:"15px 0 15px 185px",position:"fixed"}},[r("BreadcrumbItem",{attrs:{to:"/home"}},[e._v("首页")]),r("BreadcrumbItem",{attrs:{to:"/proxyRouteCluster"}},[e._v("路由列表")])],1),r("Content",{staticClass:"content",style:{padding:"10px",background:"#fff",margin:"50px 0 1px 185px",zIndex:"1"}},[r("div",{staticStyle:{padding:"1px 1px"}},[r("Card",[e._v(" BU名："),r("Input",{style:{width:"120px",marginRight:"10px"},model:{value:e.searchCondition.routeOrgName,callback:function(t){e.$set(e.searchCondition,"routeOrgName",t)},expression:"searchCondition.routeOrgName"}}),e._v(" 源端（Applier）机房："),r("Input",{style:{width:"120px",marginRight:"10px"},model:{value:e.searchCondition.srcDcName,callback:function(t){e.$set(e.searchCondition,"srcDcName",t)},expression:"searchCondition.srcDcName"}}),e._v(" 目标（Replicator）机房："),r("Input",{style:{width:"120px",marginRight:"10px"},model:{value:e.searchCondition.dstDcName,callback:function(t){e.$set(e.searchCondition,"dstDcName",t)},expression:"searchCondition.dstDcName"}}),e._v(" tag："),r("Input",{style:{width:"120px",marginRight:"10px"},model:{value:e.searchCondition.tag,callback:function(t){e.$set(e.searchCondition,"tag",t)},expression:"searchCondition.tag"}}),e._v(" deleted："),r("Select",{staticStyle:{width:"200px"},attrs:{placeholder:"inUse"},on:{"on-change":e.getRoutes},model:{value:e.searchCondition.deleted,callback:function(t){e.$set(e.searchCondition,"deleted",t)},expression:"searchCondition.deleted"}},e._l(e.searchOption.deleteOptions,(function(t){return r("Option",{key:t.key,attrs:{value:t.value}},[e._v(e._s(t.key))])})),1),r("Button",{style:{marginLeft:"10px"},attrs:{type:"primary"},on:{click:e.getRoutes}},[e._v("查询")]),r("Button",{style:{marginLeft:"10px"},attrs:{type:"primary"},on:{click:e.goToRouteManagementLink}},[e._v("添加路由")]),r("Table",{attrs:{stripe:"",columns:e.columns,data:e.dataWithPage},scopedSlots:e._u([{key:"action",fn:function(t){var a=t.row,o=t.index;return[0===a.deleted?r("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"error",size:"small"},on:{click:function(t){return e.goToDelete(a,o)}}},[e._v("下线")]):e._e(),0===a.deleted?r("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"primary",size:"small"},on:{click:function(t){return e.goToLink(a,o)}}},[e._v("修改")]):e._e(),1===a.deleted?r("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"warning",size:"small"},on:{click:function(t){return e.goToRecover(a,o)}}},[e._v("回滚")]):e._e()]}}])}),r("div",{staticStyle:{"text-align":"center",margin:"16px 0"}},[r("Page",{attrs:{transfer:!0,total:e.routes.length,current:e.current,"show-sizer":"","show-elevator":""},on:{"update:current":function(t){e.current=t},"on-page-size-change":e.handleChangeSize}})],1)],1)],1)])],1)},o=[],i=r("2909"),n=(r("fb6a"),{name:"proxyRouteCluster",data:function(){var e=this;return{columns:[{title:"序号",width:75,align:"center",render:function(t,r){return t("span",r.index+1+(e.current-1)*e.size)}},{title:"BU",key:"routeOrgName"},{title:"源端机房",key:"srcDcName",renderHeader:function(e,t){var r="Applier<br/>源端机房";return e("div",{domProps:{innerHTML:r}})}},{title:"目标机房",key:"dstDcName",renderHeader:function(e,t){var r="Replicator<br/>目标机房";return e("div",{domProps:{innerHTML:r}})}},{title:"源Region",key:"srcRegionName",renderHeader:function(e,t){var r="Applier<br/>源Region";return e("div",{domProps:{innerHTML:r}})}},{title:"目标Region",key:"dstRegionName",renderHeader:function(e,t){var r="Replicator<br/>目标Region";return e("div",{domProps:{innerHTML:r}})}},{title:"源端Proxy",key:"srcProxyUris"},{title:"目标Proxy",key:"dstProxyUris"},{title:"中继Proxy",key:"relayProxyUris"},{title:"tag",key:"tag"},{title:"状态",key:"deleted",align:"center",resizable:!0,render:function(e,t){var r=t.row,a=0===r.deleted?"blue":"volcano",o=0===r.deleted?"inUse":"discard";return e("Tag",{props:{color:a}},o)}},{title:"操作",slot:"action",align:"center",width:200}],searchCondition:{routeOrgName:"",srcDcName:"",dstDcName:"",tag:"",deleted:0},routes:[],total:0,current:1,size:10,searchOption:{deleteOptions:[{value:0,key:"inUse"},{value:1,key:"discard"}]}}},computed:{dataWithPage:function(){var e=this.routes,t=this.current*this.size-this.size,r=t+this.size;return Object(i["a"])(e).slice(t,r)}},methods:{getRoutes:function(){var e=this,t="/api/drc/v1/meta/routes",r=!1;""!==this.searchCondition.routeOrgName&&(!1===r?(t=t+"?routeOrgName="+this.searchCondition.routeOrgName,r=!0):t=t+"&routeOrgName="+this.searchCondition.routeOrgName),""!==this.searchCondition.srcDcName&&(!1===r?(t=t+"?srcDcName="+this.searchCondition.srcDcName,r=!0):t=t+"&srcDcName="+this.searchCondition.srcDcName),""!==this.searchCondition.dstDcName&&(!1===r?(t=t+"?dstDcName="+this.searchCondition.dstDcName,r=!0):t=t+"&dstDcName="+this.searchCondition.dstDcName),""!==this.searchCondition.tag&&(!1===r?(t=t+"?tag="+this.searchCondition.tag,r=!0):t=t+"&tag="+this.searchCondition.tag),!1===r?(t=t+"?deleted="+this.searchCondition.deleted,r=!0):t=t+"&deleted="+this.searchCondition.deleted,console.log("uri: {}",t),e.axios.get(t).then((function(t){console.log(t),e.total=t.data.data.length,e.routes=t.data.data}))},handleChangeSize:function(e){this.size=e},goToLink:function(e,t){1===e.deleted?alert("已经下线，请先回滚！"):(console.log("go to manage route for"+e.routeOrgName+"-"+e.tag+", from "+e.srcDcName+" to "+e.dstDcName),this.$router.push({path:"/proxyRouteManagement",query:{routeOrgName:e.routeOrgName,srcDcName:e.srcDcName,dstDcName:e.dstDcName,tag:e.tag,srcProxyUris:e.srcProxyUris,relayProxyUris:e.relayProxyUris,dstProxyUris:e.dstProxyUris,updateStatus:!0}}))},goToDelete:function(e,t){var r=this;1===e.deleted?alert("已经下线，无需操作！"):this.axios.post("/api/drc/v1/meta/routes",{id:0,routeOrgName:e.routeOrgName,srcDcName:e.srcDcName,dstDcName:e.dstDcName,srcProxyUris:e.srcProxyUris,relayProxyUris:e.relayProxyUris,dstProxyUris:e.dstProxyUris,tag:e.tag,deleted:1}).then((function(e){console.log(e.data),console.log(e.data.data),0===e.data.status?(alert("下线成功！"),r.searchCondition.deleted=1,r.getRoutes()):alert("操作失败！")}))},goToRecover:function(e,t){var r=this;0===e.deleted?alert("正在使用中无需回滚！"):this.axios.post("/api/drc/v1/meta/routes",{id:0,routeOrgName:e.routeOrgName,srcDcName:e.srcDcName,dstDcName:e.dstDcName,srcProxyUris:e.srcProxyUris,relayProxyUris:e.relayProxyUris,dstProxyUris:e.dstProxyUris,tag:e.tag,deleted:0}).then((function(e){console.log(e.data),console.log(e.data.data),0===e.data.status?(alert("回滚成功！"),r.searchCondition.deleted=0,r.getRoutes()):alert("操作失败！")}))},goToRouteManagementLink:function(){console.log("go to manage route"),this.$router.push({path:"/proxyRouteManagement",query:{updateStatus:!1,srcProxyUris:[],relayProxyUris:[],dstProxyUris:[]}})}},created:function(){var e=this;this.axios.get("/api/drc/v2/permission/resource/route").then((function(t){403!==t.data.status?e.getRoutes():e.$router.push("/nopermission")}))}}),s=n,c=r("2877"),d=Object(c["a"])(s,a,o,!1,null,"1a9dd59a",null);t["default"]=d.exports}}]);
//# sourceMappingURL=chunk-2d0c203f.613a9f77.js.map