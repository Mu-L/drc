(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f880963a"],{1431:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("base-component",[a("Breadcrumb",{style:{margin:"15px 0 15px 185px",position:"fixed"}},[a("BreadcrumbItem",{attrs:{to:"/home"}},[t._v("首页")]),a("BreadcrumbItem",{attrs:{to:"/applicationForm"}},[t._v("DRC审批")]),a("BreadcrumbItem",[t._v("DRC申请")])],1),a("Content",{staticClass:"content",style:{padding:"10px",background:"#fff",margin:"50px 0 1px 185px",zIndex:"1"}},[a("div",{staticStyle:{padding:"1px 1px"}},[a("Form",{ref:"buildParam",attrs:{model:t.buildParam,rules:t.ruleValidate,"label-width":140,disabled:t.showDetail}},[a("FormItem",{attrs:{label:"同步DB",prop:"dbName"}},[a("Input",{attrs:{placeholder:"输入同步DB"},model:{value:t.buildParam.dbName,callback:function(e){t.$set(t.buildParam,"dbName",e)},expression:"buildParam.dbName"}})],1),a("FormItem",{attrs:{label:"同步表",prop:"tableName"}},[a("Input",{attrs:{type:"textarea",autosize:{minRows:1,maxRows:5},placeholder:"输入同步表,多表用,分隔; 不填默认同步所有表"},model:{value:t.buildParam.tableName,callback:function(e){t.$set(t.buildParam,"tableName",e)},expression:"buildParam.tableName"}})],1),a("FormItem",{attrs:{label:"同步方向",required:!0}},[a("Row",[a("Col",{attrs:{span:"11"}},[a("Card",{attrs:{bordered:!0},scopedSlots:t._u([{key:"title",fn:function(){return[a("Icon",{attrs:{type:"ios-pin"}}),t._v(" 源 region ")]},proxy:!0}])},[a("FormItem",{attrs:{prop:"srcRegion"}},[a("Select",{attrs:{filterable:"",clearable:"",placeholder:"地域"},model:{value:t.buildParam.srcRegion,callback:function(e){t.$set(t.buildParam,"srcRegion",e)},expression:"buildParam.srcRegion"}},t._l(t.regionOptions,(function(e){return a("Option",{key:e,attrs:{value:e,label:e}},[t._v(" "+t._s(e)+" ")])})),1)],1)],1)],1),a("Col",{staticStyle:{"text-align":"center"},attrs:{span:"2"}},[a("Button",{attrs:{size:"middle",shape:"circle",type:"default"},on:{click:function(e){return t.reverseRegion()}}},[t._v(" -> ")])],1),a("Col",{attrs:{span:"11"}},[a("Card",{attrs:{bordered:!0},scopedSlots:t._u([{key:"title",fn:function(){return[a("Icon",{attrs:{type:"ios-pin"}}),t._v(" 目标 region ")]},proxy:!0}])},[a("FormItem",{attrs:{prop:"dstRegion"}},[a("Select",{attrs:{filterable:"",clearable:"",placeholder:"地域",prop:"dstRegion"},model:{value:t.buildParam.dstRegion,callback:function(e){t.$set(t.buildParam,"dstRegion",e)},expression:"buildParam.dstRegion"}},t._l(t.regionOptions,(function(e){return a("Option",{key:e,attrs:{value:e,label:e}},[t._v(" "+t._s(e)+" ")])})),1)],1)],1)],1)],1)],1),a("FormItem",{attrs:{label:"过滤方式",prop:"filterType"}},[a("Select",{model:{value:t.buildParam.filterType,callback:function(e){t.$set(t.buildParam,"filterType",e)},expression:"buildParam.filterType"}},t._l(t.filterTypeOpts,(function(e){return a("Option",{key:e,attrs:{value:e}},[t._v(t._s(e))])})),1)],1),a("FormItem",{attrs:{label:"BU",prop:"buName"}},[a("Select",{attrs:{filterable:"",prefix:"ios-home",placeholder:"部门"},on:{"on-change":t.autoSetTag},model:{value:t.buildParam.buName,callback:function(e){t.$set(t.buildParam,"buName",e)},expression:"buildParam.buName"}},t._l(t.bus,(function(e){return a("Option",{key:e.buName,attrs:{value:e.buName}},[t._v(t._s(e.buName))])})),1)],1),a("FormItem",{attrs:{label:"Tag",prop:"tag"}},[a("Select",{attrs:{filterable:"","allow-create":""},on:{"on-create":t.handleCreateTag},model:{value:t.buildParam.tag,callback:function(e){t.$set(t.buildParam,"tag",e)},expression:"buildParam.tag"}},t._l(t.tags,(function(e){return a("Option",{key:e,attrs:{value:e}},[t._v(t._s(e))])})),1)],1),a("FormItem",{attrs:{label:"是否刷存量数据",prop:"flushExistingData"}},[a("RadioGroup",{model:{value:t.buildParam.flushExistingData,callback:function(e){t.$set(t.buildParam,"flushExistingData",e)},expression:"buildParam.flushExistingData"}},[a("Radio",{attrs:{label:"0"}},[t._v("否")]),a("Radio",{attrs:{label:"1"}},[t._v("是")])],1)],1),a("FormItem",{attrs:{label:"是否订单相关",prop:"orderRelated"}},[a("RadioGroup",{model:{value:t.buildParam.orderRelated,callback:function(e){t.$set(t.buildParam,"orderRelated",e)},expression:"buildParam.orderRelated"}},[a("Radio",{attrs:{label:"0"}},[t._v("否")]),a("Radio",{attrs:{label:"1"}},[t._v("是")])],1)],1),a("FormItem",{attrs:{label:"同步开始位点",prop:"gtidInit"}},[a("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:"输入同步开始位点"},model:{value:t.buildParam.gtidInit,callback:function(e){t.$set(t.buildParam,"gtidInit",e)},expression:"buildParam.gtidInit"}})],1),a("FormItem",{attrs:{label:"中断影响",prop:"disruptionImpact"}},[a("Input",{attrs:{type:"textarea",autosize:{minRows:1,maxRows:2},placeholder:"中断影响"},model:{value:t.buildParam.disruptionImpact,callback:function(e){t.$set(t.buildParam,"disruptionImpact",e)},expression:"buildParam.disruptionImpact"}})],1),a("FormItem",{attrs:{label:"tps",prop:"tps"}},[a("Input",{attrs:{placeholder:"tps"},model:{value:t.buildParam.tps,callback:function(e){t.$set(t.buildParam,"tps",e)},expression:"buildParam.tps"}})],1),a("FormItem",{attrs:{label:"申请人",prop:"applicant"}},[a("Input",{attrs:{placeholder:"申请人"},model:{value:t.buildParam.applicant,callback:function(e){t.$set(t.buildParam,"applicant",e)},expression:"buildParam.applicant"}})],1),a("FormItem",{attrs:{label:"备注",prop:"remark"}},[a("Input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:"备注"},model:{value:t.buildParam.remark,callback:function(e){t.$set(t.buildParam,"remark",e)},expression:"buildParam.remark"}})],1),t.showDetail?t._e():a("FormItem",[a("Button",{attrs:{type:"primary"},on:{click:function(e){return t.handleSubmit("buildParam")}}},[t._v("提交")]),a("Button",{staticStyle:{"margin-left":"20px"},on:{click:function(e){return t.handleReset("buildParam")}}},[t._v("重置")])],1)],1),t.showDetail?a("Button",{staticStyle:{"margin-left":"80px"},attrs:{type:"primary"},on:{click:function(e){return t.toDrcBuild()}}},[t._v("审批")]):t._e()],1)])],1)},i=[],n=(a("a4d3"),a("e01a"),a("caad"),a("ac1f"),a("2532"),a("5319"),a("ad9d"),{name:"applicationBuild",data:function(){return{applicationFormId:null,buildLoading:!1,showDetail:!1,bus:[],tags:this.constant.tagList,regionOptions:[],filterTypeOpts:["ALL","UDL"],replicationTypeOpts:[{name:"单向同步",val:0},{name:"双向同步",val:1}],buildParam:{dbName:"",tableName:"",srcRegion:"",dstRegion:"",filterType:"ALL",buName:"",tps:"",description:"",disruptionImpact:"",tag:"",flushExistingData:"0",orderRelated:"0",gtidInit:"",remark:"",applicant:""},ruleValidate:{dbName:[{required:!0,message:"请输入同步DB",trigger:"blur"}],applicant:[{required:!0,message:"请输入申请人",trigger:"blur"}],filterType:[{required:!0,message:"请选择过滤类型",trigger:"change"}],flushExistingData:[{required:!0,message:"请选择是否刷存量数据",trigger:"change"}],orderRelated:[{required:!0,message:"请选择是否订单相关",trigger:"change"}],srcRegion:[{required:!0,message:"请选择源region",trigger:"change"}],dstRegion:[{required:!0,message:"请选择目标region",trigger:"change"}],buName:[{required:!0,message:"请选择BU",trigger:"change"}],tag:[{required:!0,message:"请选择tag",trigger:"change"}]}}},methods:{handleCreateTag:function(t){this.constant.tagList.push(t),this.tags.push(t)},reverseRegion:function(){var t=this.buildParam.srcRegion;this.buildParam.srcRegion=this.buildParam.dstRegion,this.buildParam.dstRegion=t},getRegions:function(){var t=this;this.axios.get("/api/drc/v2/autoconfig/region/all").then((function(e){t.regionOptions=e.data.data}))},autoSetTag:function(){"FLT"===this.buildParam.buName?this.buildParam.tag="FLT":"HTL"===this.buildParam.buName?this.buildParam.tag="HTL":this.buildParam.tag="COMMON"},getBus:function(){var t=this;this.axios.get("/api/drc/v2/meta/bus/all").then((function(e){t.bus=e.data.data}))},toDrcBuild:function(){var t=this;this.axios.post("/api/drc/v2/application/approve?applicationFormId="+this.applicationFormId).then((function(e){1===e.data.status?t.$Message.error(e.data.message):t.$router.push({path:"/drcBuild",query:{dalClusterName:t.buildParam.dbName+"_dalcluster",tableName:t.changeTableName(t.buildParam.tableName),srcRegion:t.buildParam.srcRegion,dstRegion:t.buildParam.dstRegion,filterType:t.buildParam.filterType,buName:t.buildParam.buName,tag:t.buildParam.tag,flushExistingData:t.buildParam.flushExistingData,gtidInit:t.buildParam.gtidInit,applicationFormId:t.applicationFormId}})}))},changeTableName:function(t){return null===t||""===t?".*":t.includes(",")?"("+t.replaceAll(",","|")+")":t},handleSubmit:function(t){this.validate(t),console.log(this.buildParam)},submit:function(){var t=this;this.dataLoading=!0;var e={dbName:this.buildParam.dbName,tableName:this.buildParam.tableName,srcRegion:this.buildParam.srcRegion,dstRegion:this.buildParam.dstRegion,filterType:this.buildParam.filterType,buName:this.buildParam.buName,tps:this.buildParam.tps,description:this.buildParam.description,disruptionImpact:this.buildParam.disruptionImpact,tag:this.buildParam.tag,flushExistingData:this.buildParam.flushExistingData,orderRelated:this.buildParam.orderRelated,gtidInit:this.buildParam.gtidInit,remark:this.buildParam.remark,applicant:this.buildParam.applicant};this.axios.post("/api/drc/v2/application/",e).then((function(e){t.dataLoading=!1,1===e.data.status?t.$Message.error({content:"提交失败! "+e.data.message,duration:2}):t.$Message.success("提交成功！")}))},validate:function(t){var e=this;this.$refs[t].validate((function(t){t?e.submit():e.$Message.error("仍有必填项未填!")}))},handleReset:function(t){this.$refs[t].resetFields()},init:function(){this.showDetail=this.$route.query.showDetail,this.buildParam={dbName:this.$route.query.dbName,tableName:this.$route.query.tableName,srcRegion:this.$route.query.srcRegion,dstRegion:this.$route.query.dstRegion,filterType:this.$route.query.filterType,buName:this.$route.query.buName,tps:this.$route.query.tps,description:this.$route.query.description,disruptionImpact:this.$route.query.disruptionImpact,tag:this.$route.query.tag,flushExistingData:this.$route.query.flushExistingData,orderRelated:this.$route.query.orderRelated,gtidInit:this.$route.query.gtidInit,remark:this.$route.query.remark,applicant:this.$route.query.applicant},this.applicationFormId=this.$route.query.applicationFormId}},created:function(){this.getBus(),this.getRegions(),this.init()}}),l=n,o=a("2877"),s=Object(o["a"])(l,r,i,!1,null,"6c718dfc",null);e["default"]=s.exports},"14c3":function(t,e,a){var r=a("c6b6"),i=a("9263");t.exports=function(t,e){var a=t.exec;if("function"===typeof a){var n=a.call(t,e);if("object"!==typeof n)throw TypeError("RegExp exec method returned something other than an Object or null");return n}if("RegExp"!==r(t))throw TypeError("RegExp#exec called on incompatible receiver");return i.call(t,e)}},2532:function(t,e,a){"use strict";var r=a("23e7"),i=a("5a34"),n=a("1d80"),l=a("ab13");r({target:"String",proto:!0,forced:!l("includes")},{includes:function(t){return!!~String(n(this)).indexOf(i(t),arguments.length>1?arguments[1]:void 0)}})},"44e7":function(t,e,a){var r=a("861d"),i=a("c6b6"),n=a("b622"),l=n("match");t.exports=function(t){var e;return r(t)&&(void 0!==(e=t[l])?!!e:"RegExp"==i(t))}},5319:function(t,e,a){"use strict";var r=a("d784"),i=a("825a"),n=a("7b0b"),l=a("50c4"),o=a("a691"),s=a("1d80"),u=a("8aa5"),c=a("14c3"),d=Math.max,p=Math.min,m=Math.floor,b=/\$([$&'`]|\d\d?|<[^>]*>)/g,g=/\$([$&'`]|\d\d?)/g,h=function(t){return void 0===t?t:String(t)};r("replace",2,(function(t,e,a,r){var f=r.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,v=r.REPLACE_KEEPS_$0,P=f?"$":"$0";return[function(a,r){var i=s(this),n=void 0==a?void 0:a[t];return void 0!==n?n.call(a,i,r):e.call(String(i),a,r)},function(t,r){if(!f&&v||"string"===typeof r&&-1===r.indexOf(P)){var n=a(e,t,this,r);if(n.done)return n.value}var s=i(t),m=String(this),b="function"===typeof r;b||(r=String(r));var g=s.global;if(g){var R=s.unicode;s.lastIndex=0}var y=[];while(1){var I=c(s,m);if(null===I)break;if(y.push(I),!g)break;var $=String(I[0]);""===$&&(s.lastIndex=u(m,l(s.lastIndex),R))}for(var E="",N=0,_=0;_<y.length;_++){I=y[_];for(var k=String(I[0]),S=d(p(o(I.index),m.length),0),T=[],w=1;w<I.length;w++)T.push(h(I[w]));var D=I.groups;if(b){var F=[k].concat(T,S,m);void 0!==D&&F.push(D);var q=String(r.apply(void 0,F))}else q=x(k,m,S,T,D,r);S>=N&&(E+=m.slice(N,S)+q,N=S+k.length)}return E+m.slice(N)}];function x(t,a,r,i,l,o){var s=r+t.length,u=i.length,c=g;return void 0!==l&&(l=n(l),c=b),e.call(o,c,(function(e,n){var o;switch(n.charAt(0)){case"$":return"$";case"&":return t;case"`":return a.slice(0,r);case"'":return a.slice(s);case"<":o=l[n.slice(1,-1)];break;default:var c=+n;if(0===c)return e;if(c>u){var d=m(c/10);return 0===d?e:d<=u?void 0===i[d-1]?n.charAt(1):i[d-1]+n.charAt(1):e}o=i[c-1]}return void 0===o?"":o}))}}))},"5a34":function(t,e,a){var r=a("44e7");t.exports=function(t){if(r(t))throw TypeError("The method doesn't accept regular expressions");return t}},"8aa5":function(t,e,a){"use strict";var r=a("6547").charAt;t.exports=function(t,e,a){return e+(a?r(t,e).length:1)}},ab13:function(t,e,a){var r=a("b622"),i=r("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(a){try{return e[i]=!1,"/./"[t](e)}catch(r){}}return!1}},ad9d:function(t,e,a){"use strict";var r=a("23e7"),i=a("1d80"),n=a("44e7"),l=a("ad6d"),o=a("b622"),s=a("c430"),u=o("replace"),c=RegExp.prototype;r({target:"String",proto:!0},{replaceAll:function t(e,a){var r,o,d,p,m,b,g,h,f,v=i(this);if(null!=e){if(r=n(e),r&&(o=String(i("flags"in c?e.flags:l.call(e))),!~o.indexOf("g")))throw TypeError("`.replaceAll` does not allow non-global regexes");if(d=e[u],void 0!==d)return d.call(e,v,a);if(s&&r)return String(v).replace(e,a)}if(p=String(v),m=String(e),""===m)return t.call(p,/(?:)/g,a);if(b=p.split(m),"function"!==typeof a)return b.join(String(a));for(g=b[0],h=g.length,f=1;f<b.length;f++)g+=String(a(m,h,p)),h+=m.length+b[f].length,g+=b[f];return g}})},d784:function(t,e,a){"use strict";a("ac1f");var r=a("6eeb"),i=a("d039"),n=a("b622"),l=a("9263"),o=a("9112"),s=n("species"),u=!i((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")})),c=function(){return"$0"==="a".replace(/./,"$0")}(),d=n("replace"),p=function(){return!!/./[d]&&""===/./[d]("a","$0")}(),m=!i((function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var a="ab".split(t);return 2!==a.length||"a"!==a[0]||"b"!==a[1]}));t.exports=function(t,e,a,d){var b=n(t),g=!i((function(){var e={};return e[b]=function(){return 7},7!=""[t](e)})),h=g&&!i((function(){var e=!1,a=/a/;return"split"===t&&(a={},a.constructor={},a.constructor[s]=function(){return a},a.flags="",a[b]=/./[b]),a.exec=function(){return e=!0,null},a[b](""),!e}));if(!g||!h||"replace"===t&&(!u||!c||p)||"split"===t&&!m){var f=/./[b],v=a(b,""[t],(function(t,e,a,r,i){return e.exec===l?g&&!i?{done:!0,value:f.call(e,a,r)}:{done:!0,value:t.call(a,e,r)}:{done:!1}}),{REPLACE_KEEPS_$0:c,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:p}),P=v[0],x=v[1];r(String.prototype,t,P),r(RegExp.prototype,b,2==e?function(t,e){return x.call(t,this,e)}:function(t){return x.call(t,this)})}d&&o(RegExp.prototype[b],"sham",!0)}}}]);
//# sourceMappingURL=chunk-f880963a.e3ab539f.js.map