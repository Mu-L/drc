(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-03d1f6cc"],{"06c5":function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));n("a630"),n("fb6a"),n("b0c0"),n("d3b7"),n("ac1f"),n("25f0"),n("3ca3");var a=n("6b75");function r(t,e){if(t){if("string"==typeof t)return Object(a["a"])(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Object(a["a"])(t,e):void 0}}},2532:function(t,e,n){"use strict";var a=n("23e7"),r=n("5a34"),i=n("1d80"),o=n("ab13");a({target:"String",proto:!0,forced:!o("includes")},{includes:function(t){return!!~String(i(this)).indexOf(r(t),arguments.length>1?arguments[1]:void 0)}})},"25f0":function(t,e,n){"use strict";var a=n("6eeb"),r=n("825a"),i=n("d039"),o=n("ad6d"),s="toString",c=RegExp.prototype,l=c[s],u=i((function(){return"/a/b"!=l.call({source:"a",flags:"b"})})),d=l.name!=s;(u||d)&&a(RegExp.prototype,s,(function(){var t=r(this),e=String(t.source),n=t.flags,a=String(void 0===n&&t instanceof RegExp&&!("flags"in c)?o.call(t):n);return"/"+e+"/"+a}),{unsafe:!0})},2909:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var a=n("6b75");function r(t){if(Array.isArray(t))return Object(a["a"])(t)}n("a4d3"),n("e01a"),n("d28b"),n("a630"),n("e260"),n("d3b7"),n("3ca3"),n("ddb0");function i(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}var o=n("06c5");function s(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(t){return r(t)||i(t)||Object(o["a"])(t)||s()}},"44e7":function(t,e,n){var a=n("861d"),r=n("c6b6"),i=n("b622"),o=i("match");t.exports=function(t){var e;return a(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==r(t))}},"4df4":function(t,e,n){"use strict";var a=n("0366"),r=n("7b0b"),i=n("9bdd"),o=n("e95a"),s=n("50c4"),c=n("8418"),l=n("35a1");t.exports=function(t){var e,n,u,d,p,f,h=r(t),b="function"==typeof this?this:Array,g=arguments.length,m=g>1?arguments[1]:void 0,v=void 0!==m,y=l(h),x=0;if(v&&(m=a(m,g>2?arguments[2]:void 0,2)),void 0==y||b==Array&&o(y))for(e=s(h.length),n=new b(e);e>x;x++)f=v?m(h[x],x):h[x],c(n,x,f);else for(d=y.call(h),p=d.next,n=new b;!(u=p.call(d)).done;x++)f=v?i(d,m,[u.value,x],!0):u.value,c(n,x,f);return n.length=x,n}},"4ec9":function(t,e,n){"use strict";var a=n("6d61"),r=n("6566");t.exports=a("Map",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),r)},"4fad":function(t,e,n){var a=n("23e7"),r=n("6f53").entries;a({target:"Object",stat:!0},{entries:function(t){return r(t)}})},"5a34":function(t,e,n){var a=n("44e7");t.exports=function(t){if(a(t))throw TypeError("The method doesn't accept regular expressions");return t}},6062:function(t,e,n){"use strict";var a=n("6d61"),r=n("6566");t.exports=a("Set",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),r)},6566:function(t,e,n){"use strict";var a=n("9bf2").f,r=n("7c73"),i=n("e2cc"),o=n("0366"),s=n("19aa"),c=n("2266"),l=n("7dd0"),u=n("2626"),d=n("83ab"),p=n("f183").fastKey,f=n("69f3"),h=f.set,b=f.getterFor;t.exports={getConstructor:function(t,e,n,l){var u=t((function(t,a){s(t,u,e),h(t,{type:e,index:r(null),first:void 0,last:void 0,size:0}),d||(t.size=0),void 0!=a&&c(a,t[l],t,n)})),f=b(e),g=function(t,e,n){var a,r,i=f(t),o=m(t,e);return o?o.value=n:(i.last=o={index:r=p(e,!0),key:e,value:n,previous:a=i.last,next:void 0,removed:!1},i.first||(i.first=o),a&&(a.next=o),d?i.size++:t.size++,"F"!==r&&(i.index[r]=o)),t},m=function(t,e){var n,a=f(t),r=p(e);if("F"!==r)return a.index[r];for(n=a.first;n;n=n.next)if(n.key==e)return n};return i(u.prototype,{clear:function(){var t=this,e=f(t),n=e.index,a=e.first;while(a)a.removed=!0,a.previous&&(a.previous=a.previous.next=void 0),delete n[a.index],a=a.next;e.first=e.last=void 0,d?e.size=0:t.size=0},delete:function(t){var e=this,n=f(e),a=m(e,t);if(a){var r=a.next,i=a.previous;delete n.index[a.index],a.removed=!0,i&&(i.next=r),r&&(r.previous=i),n.first==a&&(n.first=r),n.last==a&&(n.last=i),d?n.size--:e.size--}return!!a},forEach:function(t){var e,n=f(this),a=o(t,arguments.length>1?arguments[1]:void 0,3);while(e=e?e.next:n.first){a(e.value,e.key,this);while(e&&e.removed)e=e.previous}},has:function(t){return!!m(this,t)}}),i(u.prototype,n?{get:function(t){var e=m(this,t);return e&&e.value},set:function(t,e){return g(this,0===t?0:t,e)}}:{add:function(t){return g(this,t=0===t?0:t,t)}}),d&&a(u.prototype,"size",{get:function(){return f(this).size}}),u},setStrong:function(t,e,n){var a=e+" Iterator",r=b(e),i=b(a);l(t,e,(function(t,e){h(this,{type:a,target:t,state:r(t),kind:e,last:void 0})}),(function(){var t=i(this),e=t.kind,n=t.last;while(n&&n.removed)n=n.previous;return t.target&&(t.last=n=n?n.next:t.state.first)?"keys"==e?{value:n.key,done:!1}:"values"==e?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:(t.target=void 0,{value:void 0,done:!0})}),n?"entries":"values",!n,!0),u(e)}}},"6b75":function(t,e,n){"use strict";function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=Array(e);n<e;n++)a[n]=t[n];return a}n.d(e,"a",(function(){return a}))},"6d61":function(t,e,n){"use strict";var a=n("23e7"),r=n("da84"),i=n("94ca"),o=n("6eeb"),s=n("f183"),c=n("2266"),l=n("19aa"),u=n("861d"),d=n("d039"),p=n("1c7e"),f=n("d44e"),h=n("7156");t.exports=function(t,e,n){var b=-1!==t.indexOf("Map"),g=-1!==t.indexOf("Weak"),m=b?"set":"add",v=r[t],y=v&&v.prototype,x=v,w={},I=function(t){var e=y[t];o(y,t,"add"==t?function(t){return e.call(this,0===t?0:t),this}:"delete"==t?function(t){return!(g&&!u(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return g&&!u(t)?void 0:e.call(this,0===t?0:t)}:"has"==t?function(t){return!(g&&!u(t))&&e.call(this,0===t?0:t)}:function(t,n){return e.call(this,0===t?0:t,n),this})};if(i(t,"function"!=typeof v||!(g||y.forEach&&!d((function(){(new v).entries().next()})))))x=n.getConstructor(e,t,b,m),s.REQUIRED=!0;else if(i(t,!0)){var D=new x,M=D[m](g?{}:-0,1)!=D,A=d((function(){D.has(1)})),S=p((function(t){new v(t)})),k=!g&&d((function(){var t=new v,e=5;while(e--)t[m](e,e);return!t.has(-0)}));S||(x=e((function(e,n){l(e,x,t);var a=h(new v,e,x);return void 0!=n&&c(n,a[m],a,b),a})),x.prototype=y,y.constructor=x),(A||k)&&(I("delete"),I("has"),b&&I("get")),(k||M)&&I(m),g&&y.clear&&delete y.clear}return w[t]=x,a({global:!0,forced:x!=v},w),f(x,t),g||n.setStrong(x,t,b),x}},"6f53":function(t,e,n){var a=n("83ab"),r=n("df75"),i=n("fc6a"),o=n("d1e7").f,s=function(t){return function(e){var n,s=i(e),c=r(s),l=c.length,u=0,d=[];while(l>u)n=c[u++],a&&!o.call(s,n)||d.push(t?[n,s[n]]:s[n]);return d}};t.exports={entries:s(!0),values:s(!1)}},7156:function(t,e,n){var a=n("861d"),r=n("d2bb");t.exports=function(t,e,n){var i,o;return r&&"function"==typeof(i=e.constructor)&&i!==n&&a(o=i.prototype)&&o!==n.prototype&&r(t,o),t}},9263:function(t,e,n){"use strict";var a=n("ad6d"),r=n("9f7f"),i=RegExp.prototype.exec,o=String.prototype.replace,s=i,c=function(){var t=/a/,e=/b*/g;return i.call(t,"a"),i.call(e,"a"),0!==t.lastIndex||0!==e.lastIndex}(),l=r.UNSUPPORTED_Y||r.BROKEN_CARET,u=void 0!==/()??/.exec("")[1],d=c||u||l;d&&(s=function(t){var e,n,r,s,d=this,p=l&&d.sticky,f=a.call(d),h=d.source,b=0,g=t;return p&&(f=f.replace("y",""),-1===f.indexOf("g")&&(f+="g"),g=String(t).slice(d.lastIndex),d.lastIndex>0&&(!d.multiline||d.multiline&&"\n"!==t[d.lastIndex-1])&&(h="(?: "+h+")",g=" "+g,b++),n=new RegExp("^(?:"+h+")",f)),u&&(n=new RegExp("^"+h+"$(?!\\s)",f)),c&&(e=d.lastIndex),r=i.call(p?n:d,g),p?r?(r.input=r.input.slice(b),r[0]=r[0].slice(b),r.index=d.lastIndex,d.lastIndex+=r[0].length):d.lastIndex=0:c&&r&&(d.lastIndex=d.global?r.index+r[0].length:e),u&&r&&r.length>1&&o.call(r[0],n,(function(){for(s=1;s<arguments.length-2;s++)void 0===arguments[s]&&(r[s]=void 0)})),r}),t.exports=s},"99af":function(t,e,n){"use strict";var a=n("23e7"),r=n("d039"),i=n("e8b5"),o=n("861d"),s=n("7b0b"),c=n("50c4"),l=n("8418"),u=n("65f0"),d=n("1dde"),p=n("b622"),f=n("2d00"),h=p("isConcatSpreadable"),b=9007199254740991,g="Maximum allowed index exceeded",m=f>=51||!r((function(){var t=[];return t[h]=!1,t.concat()[0]!==t})),v=d("concat"),y=function(t){if(!o(t))return!1;var e=t[h];return void 0!==e?!!e:i(t)},x=!m||!v;a({target:"Array",proto:!0,forced:x},{concat:function(t){var e,n,a,r,i,o=s(this),d=u(o,0),p=0;for(e=-1,a=arguments.length;e<a;e++)if(i=-1===e?o:arguments[e],y(i)){if(r=c(i.length),p+r>b)throw TypeError(g);for(n=0;n<r;n++,p++)n in i&&l(d,p,i[n])}else{if(p>=b)throw TypeError(g);l(d,p++,i)}return d.length=p,d}})},"9bf1":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("base-component",[n("Breadcrumb",{style:{margin:"15px 0 15px 185px",position:"fixed"}},[n("BreadcrumbItem",{attrs:{to:{path:"/v2/mhaReplications",query:{srcMhaName:this.initInfo.srcMhaName,dstMhaName:this.initInfo.dstMhaName,preciseSearchMode:!0}}}},[t._v("首页 ")]),n("BreadcrumbItem",{attrs:{to:"/v2/mhaDbReplications"}},[t._v("DB 复制链路")]),n("BreadcrumbItem",{attrs:{to:{path:"/drcV2",query:{step:3,srcMhaName:this.initInfo.srcMhaName,dstMhaName:this.initInfo.dstMhaName,srcDc:this.initInfo.srcDc,dstDc:this.initInfo.dstDc,order:this.initInfo.order}}}},[t._v("DRC-MHA 配置 ")]),n("BreadcrumbItem",[t._v("Db Applier 配置")])],1),n("Content",{staticClass:"content",style:{padding:"10px",background:"#fff",margin:"50px 0 1px 185px",zIndex:"1"}},[n("Row",[n("Col",{attrs:{span:"8"}},[n("span",{staticStyle:{"margin-top":"10px",color:"#464c5b","font-weight":"600"}},[t._v(t._s(t.initInfo.srcMhaName)+"("+t._s(t.initInfo.srcDc)+")==>"+t._s(t.initInfo.dstMhaName)+"("+t._s(t.initInfo.dstDc)+")")])])],1),n("Row",{staticStyle:{"margin-top":"20px",background:"#fdfdff",border:"1px solid #e8eaec","justify-content":"space-between"}},[n("Col",{staticStyle:{display:"flex",float:"left",margin:"5px"},attrs:{span:"2"}},[t.submitted?t._e():n("Button",{staticStyle:{"text-align":"right"},attrs:{loading:t.dataLoading,type:"default"},on:{click:function(e){return t.preBatchUpdate()}}},[t._v(" 批量修改 ")])],1),n("Col",{staticStyle:{display:"flex",float:"left",margin:"5px"},attrs:{span:"2"}},[t.submitted?t._e():n("Button",{staticStyle:{"text-align":"right"},attrs:{icon:"md-arrow-up",loading:t.dataLoading,type:"primary"},on:{click:function(e){return t.preSubmit()}}},[t._v("提交 ")]),t.submitted?t._e():n("Button",{staticStyle:{"margin-left":"20px","text-align":"right"},attrs:{icon:"md-swap",loading:t.dataLoading,type:"primary"},on:{click:function(e){return t.preSwitchAppliers()}}},[t._v(" 一键自动切换 ")])],1)],1),n("Table",{ref:"multipleTable",staticStyle:{"margin-top":"0px"},attrs:{stripe:"",columns:t.columns,data:t.tableData,loading:t.dataLoading,border:""},on:{"on-selection-change":t.changeSelection},scopedSlots:t._u([{key:"applier",fn:function(e){var a=e.row,r=e.index;return[t.showSelectOptionComponent?n("Select",{key:t.applierShowRefreshCounter,staticStyle:{width:"300px"},attrs:{transfer:!0,multiple:"",placeholder:"选择源集群Applier"},model:{value:t.tableData[r].ips,callback:function(e){t.$set(t.tableData[r],"ips",e)},expression:"tableData[index].ips"}},t._l(t.applierResourceList,(function(e){return n("Option",{key:e.ip,attrs:{value:e.ip}},[t._v(t._s(e.ip)+" —— "+t._s(e.az)+" "+t._s(t.getRole(e.ip,t.currentInstances.get(t.tableData[r].dbName)))+" ")])})),1):t._e(),t.showSelectOptionComponent?n("Button",{staticStyle:{"margin-left":"10px"},attrs:{loading:t.applierDataLoading[r],type:"success",size:"small"},on:{click:function(e){return t.autoConfigApplier(a,r)}}},[t._v("自动录入 ")]):t._e(),t.showSelectOptionComponent?t._e():n("span",[t._v(" "+t._s(t.tableData[r].ips.join(", ")))])]}},{key:"gtidInit",fn:function(e){e.row;var a=e.index;return[n("Input",{staticStyle:{width:"80%"},attrs:{border:!1,placeholder:"请输入binlog拉取位点"},model:{value:t.tableData[a].gtidInit,callback:function(e){t.$set(t.tableData[a],"gtidInit",e)},expression:"tableData[index].gtidInit"}})]}},{key:"concurrency",fn:function(e){e.row;var a=e.index;return[n("InputNumber",{staticStyle:{width:"90%"},attrs:{max:150,min:1,placeholder:""},model:{value:t.tableData[a].concurrency,callback:function(e){t.$set(t.tableData[a],"concurrency",e)},expression:"tableData[index].concurrency"}})]}}])}),n("Modal",{attrs:{title:"请设置 Applier",width:"1200px"},on:{"on-ok":t.batchUpdateAppliers},model:{value:t.batchUpdateModal,callback:function(e){t.batchUpdateModal=e},expression:"batchUpdateModal"}},[n("div",{style:{padding:"1px 1px",height:"100%"}},[n("Form",{attrs:{"label-position":"left","label-width":100}},[n("FormItem",{attrs:{label:"Applier"}},[n("Select",{staticStyle:{width:"250px"},attrs:{transfer:!0,multiple:"",placeholder:"选择源集群Applier"},model:{value:t.target.ips,callback:function(e){t.$set(t.target,"ips",e)},expression:"target.ips"}},t._l(t.applierResourceList,(function(e){return n("Option",{key:e.ip,attrs:{value:e.ip}},[t._v(t._s(e.ip)+" —— "+t._s(e.az)+" ")])})),1)],1),n("FormItem",{attrs:{label:"初始同步位点"}},[n("Input",{staticStyle:{width:"80%"},attrs:{border:!1,placeholder:"请输入binlog拉取位点"},model:{value:t.target.gtid,callback:function(e){t.$set(t.target,"gtid",e)},expression:"target.gtid"}})],1)],1),n("p",[n("span",[t._v("共 ")]),n("span",{staticStyle:{color:"red","font-size":"16px","word-break":"break-all","word-wrap":"break-word"}},[t._v(t._s(this.updateData.length))]),n("span",[t._v(" 行数据")])]),[n("Table",{staticStyle:{"margin-top":"20px"},attrs:{stripe:"",columns:t.updateColumns,data:t.updateData,border:""}})]],2)])],1)],1)},r=[],i=n("2909"),o=n("c7eb"),s=n("1da1"),c=n("53ca"),l=n("b85c"),u=(n("99af"),n("caad"),n("a15b"),n("d81d"),n("4ec9"),n("4fad"),n("d3b7"),n("6062"),n("2532"),n("3ca3"),n("159b"),n("ddb0"),n("2b0e")),d={name:"tables",data:function(){var t=this;return{initInfo:{srcMhaName:"",srcMhaId:0,dstMhaName:"",dbReplicationId:0,multiData:[],srcDc:"",dstDc:"",order:!0},dataLoading:!1,applierDataLoading:[],submitted:!1,applierResourceList:[],batchUpdateModal:!1,rollbackModal:!1,gtidCheck:{mhaApplied:"",dbApplied:[],mhaTarget:""},mhaApplierInitGtid:null,deleteData:[],filters:[],filterMap:{0:"行过滤",1:"字段过滤"},target:{gtid:"",ips:[]},columns:[{type:"selection",width:60,align:"center"},{title:"库名",key:"dbName",width:200},{title:"Applier",slot:"applier",width:500,renderHeader:function(e,n){return e("span",[e("span","Applier 配置 -- "),e("Button",{props:{type:"success",size:"small"},on:{click:function(){t.batchAutoConfigure()}}},"自动录入")])},filters:[{label:"空",value:null},{label:"非空",value:"not null"}],filterMultiple:!1,filterMethod:function(t,e){return t?e.ips&&e.ips.length>0:!e.ips||0===e.ips.length}},{title:"初始同步位点",slot:"gtidInit"},{title:"并发数",width:200,slot:"concurrency"}],updateColumns:[{title:"库名",key:"dbName",width:200},{title:"applier 配置",key:"applier",width:300,render:function(t,e){var n=e.row,a=n.ips;return null===a||0===a.length?t("Tag",{props:{color:"blue"}},"无"):t("span",n.ips.join(", "))}},{title:"初始同步位点",key:"gtidInit",render:function(t,e){var n=e.row,a=n.gtidInit;return null===a||0===a.length?t("Tag",{props:{color:"blue"}},"无"):t("span",a)}}],dbGtidColumns:[{title:"库名",key:"dbName",width:200},{title:"当前同步位点",key:"gtidInit",render:function(t,e){var n=e.row,a=n.gtidInit;return null===a||0===a.length?t("Tag",{props:{color:"blue"}},"无"):t("span",a)}}],updateData:[],propertiesJson:{},tableData:[],dbApplierDtos:[],currentInstances:new Map,applierShowRefreshCounter:0,total:0,size:5,pageSizeOpts:[5,10,20,100]}},methods:{getSwitchParams:function(){return[{srcMhaName:this.initInfo.srcMhaName,dstMhaName:this.initInfo.dstMhaName,dbNames:this.dbApplierDtos.map((function(t){return t.dbName}))}]},switchAppliers:function(){var t=this,e=this.getSwitchParams();this.dataLoading=!0,this.axios.post("/api/drc/v2/autoconfig/switchAppliers",e).then((function(e){var n=e.data,a=0===n.status;a?(t.submitted=!0,t.$Message.success("提交成功")):t.$Message.warning("提交失败: "+n.message)})).catch((function(e){t.$Message.error("提交异常: "+e)})).finally((function(){t.$Modal.remove(),t.dataLoading=!1,t.getDbAppliers()}))},getFilterText:function(t){},changeSelection:function(t){this.initInfo.multiData=t,console.log(this.initInfo.multiData)},getRole:function(t,e){if(!e||0===e.length)return"";var n,a=Object(l["a"])(e);try{for(a.s();!(n=a.n()).done;){var r=n.value;if(r.ip===t)return" — "+(r.master?"Master":"Slave")}}catch(i){a.e(i)}finally{a.f()}return""},flattenObj:function(t){var e={};for(var n in t)if("object"!==Object(c["a"])(t[n])||Array.isArray(t[n]))e[n]=t[n];else{var a=this.flattenObj(t[n]);for(var r in a)e[n+"."+r]=a[r]}return e},getFilteredData:function(){return this.$refs.multipleTable.makeDataWithSortAndFilter()},autoConfigApplier:function(t,e){var n=this;u["default"].set(this.applierDataLoading,e,!0),this.axios.get("/api/drc/v2/resource/db/auto",{params:{dstMhaName:this.initInfo.dstMhaName,type:1,selectedIps:t.ips?t.ips.join(","):null}}).then((function(a){t.ips=[],a.data.data.forEach((function(e){return t.ips.push(e.ip)})),u["default"].set(n.tableData,e,t)})).catch((function(t){n.$Message.error("提交异常: "+t)})).finally((function(){u["default"].set(n.applierDataLoading,e,!1)}))},preSubmit:function(){var t=this;this.$Modal.confirm({title:"提交确认",content:"您确定要提交么？",onOk:function(){t.submitDbAppliers()}})},preSwitchAppliers:function(){var t=this;this.$Modal.confirm({title:"自动切换Applier",content:"<p>请确认</p>",loading:!0,onOk:function(){t.switchAppliers()}})},submitDbAppliers:function(){var t=this,e={srcBuildParam:{mhaName:this.initInfo.srcMhaName,dbApplierDtos:[]},dstBuildParam:{mhaName:this.initInfo.dstMhaName,dbApplierDtos:this.getFilteredData(),applierInitGtid:this.gtidCheck.mhaTarget}};this.dataLoading=!0,this.axios.post("/api/drc/v2/config/db/applier",e).then(function(){var e=Object(s["a"])(Object(o["a"])().mark((function e(n){var a,r;return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=n.data,r=1!==a.status,!r){e.next=9;break}return t.submitted=!0,t.$Message.success("提交成功"),e.next=7,t.getDbAppliers();case 7:e.next=10;break;case 9:t.$Message.warning("提交失败: "+a.message);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){t.$Message.error("提交异常: "+e)})).finally((function(){t.gtidCheck.mhaTarget=null,t.dataLoading=!1}))},batchAutoConfigure:function(){var t=this;return Object(s["a"])(Object(o["a"])().mark((function e(){return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.tableData.map((function(e,n){return t.autoConfigApplier(e,n)}));case 1:case"end":return e.stop()}}),e)})))()},getResources:function(){var t=this;this.axios.get("/api/drc/v2/resource/db/all",{params:{srcMhaName:this.initInfo.srcMhaName,dstMhaName:this.initInfo.dstMhaName,type:1}}).then((function(e){t.applierResourceList=e.data.data}))},getDbAppliers:function(){var t=this;return Object(s["a"])(Object(o["a"])().mark((function e(){return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.dataLoading=!0,t.axios.get("/api/drc/v2/config/mha/dbApplier",{params:{srcMhaName:t.initInfo.srcMhaName,dstMhaName:t.initInfo.dstMhaName}}).then((function(e){1===e.data.status?t.$Message.error("查询 db applier 失败!"):(t.tableData=e.data.data,t.dbApplierDtos=e.data.data,t.applierShowRefreshCounter++,t.getDbApplierInstances())})).finally((function(){t.dataLoading=!1}));case 2:case"end":return e.stop()}}),e)})))()},extractApplierIps:function(){var t=[];return this.dbApplierDtos.forEach((function(e){t=t.concat(e.ips)})),Object(i["a"])(new Set(t))},getDbApplierInstances:function(){var t=this,e=this.extractApplierIps();this.axios.get("/api/drc/v2/remote/resource/dbApplierInstances",{params:{src:this.initInfo.srcMhaName,mhaName:this.initInfo.dstMhaName,ips:e.join(",")}}).then((function(e){1===e.data.status?t.$Message.warning("查询 db applier 实例状态失败"):(t.currentInstances=new Map(Object.entries(e.data.data)),t.applierShowRefreshCounter++)}))},preBatchUpdate:function(){var t=this.$refs.multipleTable.getSelection();void 0!==t&&null!==t&&0!==t.length?(this.batchUpdateModal=!0,this.updateData=t,this.target.ips=[],this.target.gtid=""):this.$Message.warning("请勾选！")},batchUpdateAppliers:function(){var t=this,e=this.$refs.multipleTable.getSelection().map((function(t){return t.dbName}));this.tableData.forEach((function(n){e.includes(n.dbName)&&(n.ips=t.target.ips,t.target.gtid&&(n.gtidInit=t.target.gtid))})),this.$Message.warning("修改成功！共修改"+e.length+"行")},clearDeleteDbReplication:function(t,e){this.deleteData=[],this.batchDeleteModal=!1},deleteDbReplication:function(){var t=this,e=[];this.deleteData.forEach((function(t){return e.push(t.dbReplicationId)})),this.axios.delete("/api/drc/v2/config/dbReplications?dbReplicationIds="+e).then((function(e){1===e.data.status?t.$Message.error("删除失败!"+e.data.message):(t.$Message.success("删除成功!"),t.getDbAppliers(),t.initInfo.multiData=[])}))}},created:function(){var t=this;this.axios.get("/api/drc/v2/permission/meta/mhaReplication/modify").then((function(e){403!==e.data.status?(t.initInfo={srcMhaName:t.$route.query.srcMhaName,srcMhaId:t.$route.query.srcMhaId,dstMhaName:t.$route.query.dstMhaName,applierGroupId:t.$route.query.applierGroupId,srcDc:t.$route.query.srcDc,dstDc:t.$route.query.dstDc,order:t.$route.query.order},t.getResources(),t.getDbAppliers()):t.$router.push("/nopermission")}))},computed:{showSelectOptionComponent:function(){return this.tableData.length<=50}}},p=d,f=n("2877"),h=Object(f["a"])(p,a,r,!1,null,"4106d973",null);e["default"]=h.exports},"9f7f":function(t,e,n){"use strict";var a=n("d039");function r(t,e){return RegExp(t,e)}e.UNSUPPORTED_Y=a((function(){var t=r("a","y");return t.lastIndex=2,null!=t.exec("abcd")})),e.BROKEN_CARET=a((function(){var t=r("^r","gy");return t.lastIndex=2,null!=t.exec("str")}))},a15b:function(t,e,n){"use strict";var a=n("23e7"),r=n("44ad"),i=n("fc6a"),o=n("a640"),s=[].join,c=r!=Object,l=o("join",",");a({target:"Array",proto:!0,forced:c||!l},{join:function(t){return s.call(i(this),void 0===t?",":t)}})},a630:function(t,e,n){var a=n("23e7"),r=n("4df4"),i=n("1c7e"),o=!i((function(t){Array.from(t)}));a({target:"Array",stat:!0,forced:o},{from:r})},ab13:function(t,e,n){var a=n("b622"),r=a("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[r]=!1,"/./"[t](e)}catch(a){}}return!1}},ac1f:function(t,e,n){"use strict";var a=n("23e7"),r=n("9263");a({target:"RegExp",proto:!0,forced:/./.exec!==r},{exec:r})},ad6d:function(t,e,n){"use strict";var a=n("825a");t.exports=function(){var t=a(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},b85c:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));n("a4d3"),n("e01a"),n("d28b"),n("e260"),n("d3b7"),n("3ca3"),n("ddb0");var a=n("06c5");function r(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=Object(a["a"])(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){c=!0,o=t},f:function(){try{s||null==n["return"]||n["return"]()}finally{if(c)throw o}}}}},bb2f:function(t,e,n){var a=n("d039");t.exports=!a((function(){return Object.isExtensible(Object.preventExtensions({}))}))},d81d:function(t,e,n){"use strict";var a=n("23e7"),r=n("b727").map,i=n("1dde"),o=n("ae40"),s=i("map"),c=o("map");a({target:"Array",proto:!0,forced:!s||!c},{map:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}})},f183:function(t,e,n){var a=n("d012"),r=n("861d"),i=n("5135"),o=n("9bf2").f,s=n("90e3"),c=n("bb2f"),l=s("meta"),u=0,d=Object.isExtensible||function(){return!0},p=function(t){o(t,l,{value:{objectID:"O"+ ++u,weakData:{}}})},f=function(t,e){if(!r(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!i(t,l)){if(!d(t))return"F";if(!e)return"E";p(t)}return t[l].objectID},h=function(t,e){if(!i(t,l)){if(!d(t))return!0;if(!e)return!1;p(t)}return t[l].weakData},b=function(t){return c&&g.REQUIRED&&d(t)&&!i(t,l)&&p(t),t},g=t.exports={REQUIRED:!1,fastKey:f,getWeakData:h,onFreeze:b};a[l]=!0}}]);
//# sourceMappingURL=chunk-03d1f6cc.56f3da0c.js.map