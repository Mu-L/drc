(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-60394b31"],{"25f0":function(e,t,a){"use strict";var r=a("6eeb"),i=a("825a"),n=a("d039"),o=a("ad6d"),s="toString",l=RegExp.prototype,c=l[s],p=n((function(){return"/a/b"!=c.call({source:"a",flags:"b"})})),u=c.name!=s;(p||u)&&r(RegExp.prototype,s,(function(){var e=i(this),t=String(e.source),a=e.flags,r=String(void 0===a&&e instanceof RegExp&&!("flags"in l)?o.call(e):a);return"/"+t+"/"+r}),{unsafe:!0})},2909:function(e,t,a){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,a=new Array(e.length);t<e.length;t++)a[t]=e[t];return a}}a.d(t,"a",(function(){return o}));a("a4d3"),a("e01a"),a("d28b"),a("a630"),a("e260"),a("d3b7"),a("25f0"),a("3ca3"),a("ddb0");function i(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function n(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function o(e){return r(e)||i(e)||n()}},"4df4":function(e,t,a){"use strict";var r=a("0366"),i=a("7b0b"),n=a("9bdd"),o=a("e95a"),s=a("50c4"),l=a("8418"),c=a("35a1");e.exports=function(e){var t,a,p,u,d,g,f=i(e),h="function"==typeof this?this:Array,m=arguments.length,I=m>1?arguments[1]:void 0,v=void 0!==I,b=c(f),y=0;if(v&&(I=r(I,m>2?arguments[2]:void 0,2)),void 0==b||h==Array&&o(b))for(t=s(f.length),a=new h(t);t>y;y++)g=v?I(f[y],y):f[y],l(a,y,g);else for(u=b.call(f),d=u.next,a=new h;!(p=d.call(u)).done;y++)g=v?n(u,I,[p.value,y],!0):p.value,l(a,y,g);return a.length=y,a}},"5c86":function(e,t,a){"use strict";a("692d")},"692d":function(e,t,a){},8418:function(e,t,a){"use strict";var r=a("c04e"),i=a("9bf2"),n=a("5c6c");e.exports=function(e,t,a){var o=r(t);o in e?i.f(e,o,n(0,a)):e[o]=a}},"9a28":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("base-component",[a("Breadcrumb",{style:{margin:"15px 0 15px 185px",position:"fixed"}},[a("BreadcrumbItem",{attrs:{to:"/home"}},[e._v("首页")])],1),a("Content",{staticClass:"content",style:{padding:"10px",background:"#fff",margin:"50px 0 1px 185px",zIndex:"1"}},[a("div",{staticStyle:{padding:"1px 1px"}},[a("Row",{attrs:{gutter:10,align:"middle"}},[a("Col",{attrs:{span:"16"}},[a("Card",{attrs:{padding:5},scopedSlots:e._u([{key:"title",fn:function(){return[e._v("查询条件")]},proxy:!0}])},[a("Row",{attrs:{gutter:10}},[a("Col",{attrs:{span:"8"}},[a("Input",{attrs:{prefix:"ios-search",placeholder:"ip"},on:{"on-enter":e.getResources},model:{value:e.queryParam.ip,callback:function(t){e.$set(e.queryParam,"ip",t)},expression:"queryParam.ip"}})],1),a("Col",{attrs:{span:"4"}},[a("Select",{attrs:{filterable:"",clearable:"",placeholder:"类型"},on:{"on-change":e.getResources},model:{value:e.queryParam.type,callback:function(t){e.$set(e.queryParam,"type",t)},expression:"queryParam.type"}},e._l(e.typeList,(function(t){return a("Option",{key:t.val,attrs:{value:t.val}},[e._v(e._s(t.name))])})),1)],1),a("Col",{attrs:{span:"4"}},[a("Select",{attrs:{filterable:"",clearable:"",placeholder:"地域"},on:{"on-change":e.getResources},model:{value:e.queryParam.region,callback:function(t){e.$set(e.queryParam,"region",t)},expression:"queryParam.region"}},e._l(e.regions,(function(t){return a("Option",{key:t.regionName,attrs:{value:t.regionName}},[e._v(" "+e._s(t.regionName)+" ")])})),1)],1),a("Col",{attrs:{span:"4"}},[a("Select",{attrs:{filterable:"",clearable:"","allow-create":"",placeholder:"tag"},on:{"on-change":e.getResources,"on-create":e.handleAddTag},model:{value:e.queryParam.tag,callback:function(t){e.$set(e.queryParam,"tag",t)},expression:"queryParam.tag"}},e._l(e.tagList,(function(t){return a("Option",{key:t,attrs:{value:t}},[e._v(e._s(t))])})),1)],1),a("Col",{attrs:{span:"4"}},[a("Select",{attrs:{filterable:"",clearable:"",placeholder:"启用状态"},on:{"on-change":e.getResources},model:{value:e.queryParam.active,callback:function(t){e.$set(e.queryParam,"active",t)},expression:"queryParam.active"}},e._l(e.activeList,(function(t){return a("Option",{key:t.val,attrs:{value:t.val}},[e._v(e._s(t.name))])})),1)],1)],1)],1)],1),a("Col",{attrs:{span:"1"}},[a("Button",{attrs:{type:"primary",icon:"ios-search",loading:e.dataLoading},on:{click:e.getResources}},[e._v("查询")]),a("Button",{staticStyle:{"margin-top":"20px"},attrs:{icon:"md-refresh",loading:e.dataLoading},on:{click:e.resetParam}},[e._v("重置")])],1)],1),a("br"),a("Row",{staticStyle:{background:"#fdfdff",border:"1px solid #e8eaec"}},[a("Col",{staticStyle:{display:"flex",float:"left",margin:"5px"},attrs:{span:"2"}},[a("Dropdown",{attrs:{placement:"bottom-start"},scopedSlots:e._u([{key:"list",fn:function(){return[a("DropdownMenu",[a("DropdownItem",{nativeOn:{click:function(t){return function(){e.$router.push({path:"/drcResource"})}.apply(null,arguments)}}},[e._v("资源录入")])],1)]},proxy:!0}])},[a("Button",{attrs:{type:"default",icon:"ios-hammer"}},[e._v(" 操作 "),a("Icon",{attrs:{type:"ios-arrow-down"}})],1)],1)],1)],1),a("Table",{attrs:{stripe:"",border:"",columns:e.columns,data:e.resources},scopedSlots:e._u([{key:"action",fn:function(t){var r=t.row,i=t.index;return[a("Dropdown",{attrs:{transfer:!0,placement:"bottom-start"},scopedSlots:e._u([{key:"list",fn:function(){return[a("DropdownMenu",[a("DropdownItem",[a("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"success",size:"small"},on:{click:function(t){return e.showMigrateInfo(r,i)}}},[e._v(" 实例迁移 ")])],1),a("DropdownItem",[a("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"error",size:"small"},on:{click:function(t){return e.preDeleteResource(r,i)}}},[e._v(" 下线 ")])],1)],1)]},proxy:!0}],null,!0)},[a("Button",{attrs:{type:"default",icon:"ios-hammer"}},[e._v(" 操作 "),a("Icon",{attrs:{type:"ios-arrow-down"}})],1)],1)]}}])}),a("div",{staticStyle:{"text-align":"center",margin:"16px 0"}},[a("Page",{attrs:{transfer:!0,total:e.total,current:e.current,"page-size-opts":[10,20,50,100],"page-size":10,"show-total":"","show-sizer":"","show-elevator":""},on:{"update:current":function(t){e.current=t},"on-change":e.getResources,"on-page-size-change":e.handleChangeSize}})],1),a("Modal",{attrs:{title:"确认删除以下机器资源"},on:{"on-ok":e.deleteResource,"on-cancel":e.clearDeleteResource},model:{value:e.deleteResourceModal,callback:function(t){e.deleteResourceModal=t},expression:"deleteResourceModal"}},[a("p",[e._v('ip: "'+e._s(e.deleteResourceInfo.ip)+'" ,tag: "'+e._s(e.deleteResourceInfo.tag)+'" az: "'+e._s(e.deleteResourceInfo.az)+'"')]),a("p",[a("span",[e._v("部署实例数量: ")]),a("span",{staticStyle:{color:"red","font-size":"20px"}},[e._v(e._s(e.deleteResourceInfo.instanceNum))])])]),a("Modal",{attrs:{title:1===e.migrateApplierInfo.oldIpInfo.type?"applier实例迁移":"messenger实例迁移","footer-hide":!0,width:"900px",scrollable:!0,draggable:!0},model:{value:e.migrateApplierInfo.modal,callback:function(t){e.$set(e.migrateApplierInfo,"modal",t)},expression:"migrateApplierInfo.modal"}},[a("Row",{attrs:{gutter:10}},[a("Col",{attrs:{span:"4"}},[a("span",[e._v("当前ip: ")]),a("span",{staticStyle:{color:"red","font-size":"15px"}},[e._v(e._s(e.migrateApplierInfo.oldIpInfo.ip))])]),a("Col",{attrs:{span:"4"}},[a("span",[e._v("  tag: ")]),a("span",{staticStyle:{color:"red","font-size":"15px"}},[e._v(e._s(e.migrateApplierInfo.oldIpInfo.tag))])]),a("Col",{attrs:{span:"4"}},[a("span",[e._v("  AZ: ")]),a("span",{staticStyle:{color:"red","font-size":"15px"}},[e._v(e._s(e.migrateApplierInfo.oldIpInfo.az))])])],1),a("Form",[a("FormItem",{attrs:{label:"选择目标ip"}},[a("Select",{staticStyle:{width:"400px"},attrs:{filterable:"",clearable:"",placeholder:"目标ip"},model:{value:e.migrateApplierInfo.newIp,callback:function(t){e.$set(e.migrateApplierInfo,"newIp",t)},expression:"migrateApplierInfo.newIp"}},e._l(e.migrateApplierInfo.ipChooseList,(function(t){return a("Option",{key:t,attrs:{value:t}},[e._v(" "+e._s(t)+" ")])})),1),a("Button",{staticStyle:{"margin-left":"100px"},attrs:{type:"primary",loading:e.migrateApplierInfo.loading2},on:{click:e.migrateAllApplierOrMessenger}},[e._v("全部实例迁移")])],1),a("FormItem",[a("Table",{ref:"multipleTable",attrs:{stripe:"",border:"",columns:e.migrateApplierInfo.columns,data:e.aDataWithPage},on:{"on-selection-change":e.changeSelectionA}}),a("div",[a("Page",{attrs:{transfer:!0,total:e.migrateApplierInfo.tableData.length,current:e.migrateApplierInfo.current,"page-size-opts":e.migrateApplierInfo.pageSizeOpts,"page-size":this.migrateApplierInfo.size,"show-total":"","show-sizer":"","show-elevator":""},on:{"update:current":function(t){return e.$set(e.migrateApplierInfo,"current",t)},"on-page-size-change":e.aHandleChangeSize}})],1)],1),a("FormItem",[a("Button",{attrs:{type:"primary",loading:e.migrateApplierInfo.loading},on:{click:e.migrateApplierOrMessenger}},[e._v("迁移")]),a("Button",{staticStyle:{"margin-left":"100px"},attrs:{type:"success"},on:{click:e.refreshMigrateApplier}},[e._v("刷新")])],1)],1)],1),a("Modal",{attrs:{title:"replicator实例迁移","footer-hide":!0,width:"900px",scrollable:!0,draggable:!0},model:{value:e.migrateReplicatorInfo.modal,callback:function(t){e.$set(e.migrateReplicatorInfo,"modal",t)},expression:"migrateReplicatorInfo.modal"}},[a("Row",{attrs:{gutter:10}},[a("Col",{attrs:{span:"4"}},[a("span",[e._v("当前ip: ")]),a("span",{staticStyle:{color:"red","font-size":"15px"}},[e._v(e._s(e.migrateReplicatorInfo.oldIpInfo.ip))])]),a("Col",{attrs:{span:"4"}},[a("span",[e._v("  tag: ")]),a("span",{staticStyle:{color:"red","font-size":"15px"}},[e._v(e._s(e.migrateReplicatorInfo.oldIpInfo.tag))])]),a("Col",{attrs:{span:"4"}},[a("span",[e._v("  AZ: ")]),a("span",{staticStyle:{color:"red","font-size":"15px"}},[e._v(e._s(e.migrateReplicatorInfo.oldIpInfo.az))])])],1),a("Form",[a("FormItem",{attrs:{label:"选择目标ip"}},[a("Select",{staticStyle:{width:"400px"},attrs:{filterable:"",clearable:"",placeholder:"目标ip"},model:{value:e.migrateReplicatorInfo.newIp,callback:function(t){e.$set(e.migrateReplicatorInfo,"newIp",t)},expression:"migrateReplicatorInfo.newIp"}},e._l(e.migrateReplicatorInfo.ipChooseList,(function(t){return a("Option",{key:t,attrs:{value:t}},[e._v(" "+e._s(t)+" ")])})),1)],1),a("FormItem",[a("Table",{ref:"multipleTable",attrs:{stripe:"",border:"",columns:e.migrateReplicatorInfo.columns,data:e.rDataWithPage},on:{"on-selection-change":e.changeSelectionR}}),a("div",[a("Page",{attrs:{transfer:!0,total:e.migrateReplicatorInfo.tableData.length,current:e.migrateReplicatorInfo.current,"page-size-opts":e.migrateReplicatorInfo.pageSizeOpts,"page-size":this.migrateReplicatorInfo.size,"show-total":"","show-sizer":"","show-elevator":""},on:{"update:current":function(t){return e.$set(e.migrateReplicatorInfo,"current",t)},"on-page-size-change":e.rHandleChangeSize}})],1)],1),a("FormItem",[a("Button",{attrs:{type:"primary",loading:e.migrateReplicatorInfo.loading},on:{click:e.migrateReplicator}},[e._v("迁移")]),a("Button",{staticStyle:{"margin-left":"100px"},attrs:{type:"success"},on:{click:e.refreshMigrateReplicator}},[e._v("刷新")])],1)],1)],1),a("Modal",{attrs:{title:"关联mha",width:"900px",scrollable:!0,draggable:!0},model:{value:e.relatedMhaData.modal,callback:function(t){e.$set(e.relatedMhaData,"modal",t)},expression:"relatedMhaData.modal"}},[a("Table",{attrs:{stripe:"",border:"",columns:e.relatedMhaData.columns,data:e.relatedMhaData.tableData}})],1),a("Modal",{attrs:{title:"关联复制链路",width:"900px",scrollable:!0,draggable:!0},model:{value:e.relatedReplicationData.modal,callback:function(t){e.$set(e.relatedReplicationData,"modal",t)},expression:"relatedReplicationData.modal"}},[a("Table",{attrs:{stripe:"",border:"",columns:e.relatedReplicationData.columns,data:e.relatedReplicationData.tableData}})],1)],1)])],1)},i=[],n=(a("4160"),a("fb6a"),a("d3b7"),a("159b"),a("53ca")),o=a("2909"),s=(a("fcc1"),a("7a7a"),a("d5e0"),a("697e"),a("cbc8"),{name:"resourceV2",data:function(){var e=this;return{columns:[{title:"类型",key:"type",width:80,render:function(t,a){var r=a.row,i="none",n="error",o=!1;switch(r.type){case 0:i="R",n="info";break;case 1:i="A",n="success";break;case 7:i="M",n="warning";break;default:i="无",o=!0;break}return t("Button",{props:{type:n,size:"small",disabled:o},on:{click:function(){e.showModal(r)}}},i)}},{title:"ip",key:"ip"},{title:"tag",key:"tag"},{title:"AZ",key:"az",sortable:!0},{title:"部署实例数量",key:"instanceNum",sortable:!0},{title:"启用状态",key:"active",sortable:!0,align:"center",render:function(t,a){var r=a.row;return t("i-switch",{props:{size:"large",value:1===r.active,beforeChange:e.handleBeforeChange},scopedSlots:{open:function(){return t("span","开启")},close:function(){return t("span","关闭")}},on:{"on-change":function(){e.switchActiveStatus(r.resourceId,r.active)}}})}},{title:"操作",slot:"action",align:"center"}],total:0,current:1,size:10,resources:[],typeList:[{name:"Replicator",val:0},{name:"Applier",val:1},{name:"Messenger",val:7}],activeList:[{name:"启用",val:1},{name:"停用",val:0}],regions:[],tagList:this.constant.tagList,deleteResourceModal:!1,relatedReplicationData:{tableData:[],modal:!1,columns:[{title:"序号",width:75,align:"center",render:function(e,t){return e("span",t.index+1)}},{title:"类型",key:"type",width:150,render:function(t,a){var r=a.row,i="none",n="error",o=!1;switch(r.type){case 1:i="Applier",n="info";break;case 2:i="DbApplier",n="success";break;case 3:i="Messenger",n="warning";break;case 4:i="DbMessenger",n="primary";break;default:i="无",o=!0;break}return t("Button",{props:{type:n,size:"small",disabled:o},on:{click:function(){e.showModal(r)}}},i)}},{title:"同步链路",key:"relatedId",render:function(t,a){var r=a.row,i=r.type,n="";return 1===i?n=r.srcMhaName+"("+r.srcDcName+") => "+r.dstMhaName+"("+r.dstDcName+")":2===i?n=r.srcMhaName+"("+r.srcDcName+") => "+r.dstMhaName+"("+r.dstDcName+") db: "+r.dbName:3===i?n=r.srcMhaName+"("+r.srcDcName+")":4===i&&(n=r.srcMhaName+"("+r.srcDcName+") db: "+r.dbName),t("a",{props:{type:"info",size:"small",disabled:!1},on:{click:function(){1===i?e.toMhaReplication(r):2===i?e.toMhaDbReplication(r):3===i&&e.toMessenger(r)}}},n)}}]},relatedMhaData:{tableData:[],modal:!1,columns:[{title:"序号",width:75,align:"center",render:function(e,t){return e("span",t.index+1)}},{title:"mha",key:"mhaName",render:function(t,a){var r=a.row,i=r.mhaName;return t("a",{props:{type:"info",size:"small",disabled:!1},on:{click:function(){e.toMhaReplicationByR(r)}}},i)}}]},migrateApplierInfo:{loading:!1,loading2:!1,modal:!1,newIp:"",ipChooseList:[],oldIpInfo:{ip:"",tag:"",az:"",resourceId:null,type:null},migrateDataList:[],tableData:[],columns:[{type:"selection",width:60,align:"center"},{title:"序号",width:75,align:"center",render:function(e,t){return e("span",t.index+1)}},{title:"类型",key:"type",width:150,render:function(t,a){var r=a.row,i="none",n="error",o=!1;switch(r.type){case 1:i="Applier",n="info";break;case 2:i="DbApplier",n="success";break;case 3:i="Messenger",n="warning";break;case 4:i="DbMessenger",n="primary";break;default:i="无",o=!0;break}return t("Button",{props:{type:n,size:"small",disabled:o},on:{click:function(){e.showModal(r)}}},i)}},{title:"同步链路",key:"relatedId",render:function(t,a){var r=a.row,i=r.type,n="";return 1===i?n=r.srcMhaName+"("+r.srcDcName+") => "+r.dstMhaName+"("+r.dstDcName+")":2===i?n=r.srcMhaName+"("+r.srcDcName+") => "+r.dstMhaName+"("+r.dstDcName+") db: "+r.dbName:3===i?n=r.srcMhaName+"("+r.srcDcName+")":4===i&&(n=r.srcMhaName+"("+r.srcDcName+") db: "+r.dbName),t("a",{props:{type:"info",size:"small",disabled:!1},on:{click:function(){1===i?e.toMhaReplication(r):2===i?e.toMhaDbReplication(r):3===i&&e.toMessenger(r)}}},n)}}],total:0,current:1,size:10,pageSizeOpts:[10,20,50,100]},migrateReplicatorInfo:{loading:!1,modal:!1,newIp:"",ipChooseList:[],oldIpInfo:{ip:"",tag:"",az:"",resourceId:null},migrateMhaList:[],tableData:[],columns:[{type:"selection",width:60,align:"center"},{title:"序号",width:75,align:"center",render:function(e,t){return e("span",t.index+1)}},{title:"mha",key:"mhaName",render:function(t,a){var r=a.row,i=r.mhaName;return t("a",{props:{type:"info",size:"small",disabled:!1},on:{click:function(){e.toMhaReplicationByR(r)}}},i)}}],total:0,current:1,size:10,pageSizeOpts:[10,20,50,100]},deleteResourceInfo:{resourceId:null,ip:"",tag:"",az:"",instanceNum:0},queryParam:{ip:"",type:null,tag:"",active:null,region:"",pageReq:{pageSize:10,pageIndex:1}},replicationDetail:{show:!1,data:null,darkMode:!0,lineWrap:!1,row:{}},dataLoading:!0}},computed:{rDataWithPage:function(){var e=this.migrateReplicatorInfo.tableData,t=this.migrateReplicatorInfo.current*this.migrateReplicatorInfo.size-this.migrateReplicatorInfo.size,a=t+this.migrateReplicatorInfo.size;return Object(o["a"])(e).slice(t,a)},aDataWithPage:function(){var e=this.migrateApplierInfo.tableData,t=this.migrateApplierInfo.current*this.migrateApplierInfo.size-this.migrateApplierInfo.size,a=t+this.migrateApplierInfo.size;return Object(o["a"])(e).slice(t,a)}},methods:{aHandleChangeSize:function(e){this.migrateApplierInfo.size=e},changeSelectionA:function(e){this.migrateApplierInfo.migrateDataList=e,console.log(this.migrateApplierInfo.migrateDataList)},rHandleChangeSize:function(e){this.migrateReplicatorInfo.size=e},changeSelectionR:function(e){this.migrateReplicatorInfo.migrateMhaList=e,console.log(this.migrateReplicatorInfo.migrateMhaList)},migrateAllApplierOrMessenger:function(){var e=this,t=this.migrateApplierInfo.newIp;if(null!==t&&""!==t){var a=this.migrateApplierInfo.tableData;if(0!==a.length){var r=this.migrateApplierInfo.oldIpInfo.ip;this.migrateApplierInfo.loading2=!0;var i=this.migrateApplierInfo.oldIpInfo.type;1===i?this.axios.post("/api/drc/v2/resource/migrate/applier?newIp="+t+"&oldIp="+r).then((function(t){0===t.data.status?(e.migrateApplierInfo.tableData=t.data.data,e.$Message.success("共迁移"+t.data.data+"个实例")):e.$Message.error("迁移失败"+t.data.message)})):7===i&&this.axios.post("/api/drc/v2/resource/migrate/messenger?newIp="+t+"&oldIp="+r).then((function(t){0===t.data.status?(e.migrateApplierInfo.tableData=t.data.data,e.$Message.success("共迁移"+t.data.data+"个实例")):e.$Message.error("迁移失败"+t.data.message)})),this.migrateApplierInfo.loading2=!1}else this.$Message.warning("没有相关实例")}else this.$Message.warning("请选择目标ip")},migrateApplierOrMessenger:function(){var e=this,t=this.migrateApplierInfo.migrateDataList;if(void 0!==t&&null!==t&&0!==t.length){var a=this.migrateApplierInfo.newIp;if(null!==a&&""!==a){var r=[];t.forEach((function(e){var t={relatedId:e.relatedId,type:e.type};r.push(t)}));var i={oldIp:this.migrateApplierInfo.oldIpInfo.ip,newIp:this.migrateApplierInfo.newIp,applierResourceDtos:r};this.migrateApplierInfo.loading=!0,1===this.migrateApplierInfo.oldIpInfo.type?this.axios.post("/api/drc/v2/resource/partialMigrate/applier",i).then((function(t){0===t.data.status?(e.migrateApplierInfo.tableData=t.data.data,e.$Message.success("共迁移"+t.data.data+"个实例")):e.$Message.error("迁移失败"+t.data.message)})):this.axios.post("/api/drc/v2/resource/partialMigrate/messenger",i).then((function(t){0===t.data.status?(e.migrateApplierInfo.tableData=t.data.data,e.$Message.success("共迁移"+t.data.data+"个实例")):e.$Message.error("迁移失败"+t.data.message)})),this.migrateApplierInfo.loading=!1}else this.$Message.warning("请选择目标ip")}else this.$Message.warning("请勾选！")},migrateReplicator:function(){var e=this,t=this.migrateReplicatorInfo.migrateMhaList;if(void 0!==t&&null!==t&&0!==t.length){var a=this.migrateReplicatorInfo.newIp;if(null!==a&&""!==a){var r=[];t.forEach((function(e){return r.push(e.mhaName)}));var i={oldIp:this.migrateReplicatorInfo.oldIpInfo.ip,newIp:this.migrateReplicatorInfo.newIp,mhaList:r};this.migrateReplicatorInfo.loading=!0,this.axios.post("/api/drc/v2/resource/partialMigrate/replicator",i).then((function(t){0===t.data.status?e.$Message.success("共迁移"+t.data.data+"个实例"):e.$Message.error("迁移失败"+t.data.message)})),this.migrateReplicatorInfo.loading=!1}else this.$Message.warning("请选择目标ip")}else this.$Message.warning("请勾选！")},refreshMigrateApplier:function(){var e=this;this.migrateApplierInfo.current=1;var t=this.migrateApplierInfo.oldIpInfo.resourceId;this.axios.get("/api/drc/v2/resource/mhaReplication?resourceId="+t).then((function(t){0===t.data.status?(e.migrateApplierInfo.tableData=t.data.data,console.log(e.migrateApplierInfo.tableData),e.$forceUpdate()):e.$Message.warning("查询异常")}))},refreshMigrateReplicator:function(){var e=this;this.migrateReplicatorInfo.current=1;var t=this.migrateReplicatorInfo.oldIpInfo.resourceId;this.axios.get("/api/drc/v2/resource/mha?resourceId="+t).then((function(t){0===t.data.status?(e.migrateReplicatorInfo.tableData=t.data.data,console.log(e.migrateReplicatorInfo.tableData),e.$forceUpdate()):e.$Message.warning("查询异常")}))},showMigrateInfo:function(e){0===e.type?this.showMigrateReplicator(e):(1===e.type||7===e.type)&&this.showMigrateApplier(e)},showMigrateApplier:function(e){var t=this;this.migrateApplierInfo.oldIpInfo={ip:e.ip,tag:e.tag,az:e.az,resourceId:e.resourceId,type:e.type},this.axios.get("/api/drc/v2/resource/mhaReplication?resourceId="+e.resourceId).then((function(e){0===e.data.status?t.migrateApplierInfo.tableData=e.data.data:t.$Message.warning("查询异常")})),this.axios.get("/api/drc/v2/resource/list?ip="+e.ip).then((function(e){t.migrateApplierInfo.ipChooseList=[],e.data.data.forEach((function(e){return t.migrateApplierInfo.ipChooseList.push(e.ip)})),console.log(t.migrateApplierInfo.ipChooseList)})),this.migrateApplierInfo.modal=!0},showMigrateReplicator:function(e){var t=this;this.migrateReplicatorInfo.oldIpInfo={ip:e.ip,tag:e.tag,az:e.az,resourceId:e.resourceId},this.axios.get("/api/drc/v2/resource/mha?resourceId="+e.resourceId).then((function(e){0===e.data.status?t.migrateReplicatorInfo.tableData=e.data.data:t.$Message.warning("查询异常")})),this.axios.get("/api/drc/v2/resource/list?ip="+e.ip).then((function(e){t.migrateReplicatorInfo.ipChooseList=[],e.data.data.forEach((function(e){return t.migrateReplicatorInfo.ipChooseList.push(e.ip)})),console.log(t.migrateReplicatorInfo.ipChooseList)})),this.migrateReplicatorInfo.modal=!0},toMessenger:function(e){var t=this.$router.resolve({path:"/v2/messengersV2",query:{mhaName:e.srcMhaName}});window.open(t.href,"_blank")},toDbMessenger:function(e){},toMhaReplication:function(e){var t=this.$router.resolve({path:"/v2/mhaReplications",query:{srcMhaName:e.srcMhaName,dstMhaName:e.dstMhaName,preciseSearchMode:!0}});window.open(t.href,"_blank")},toMhaDbReplication:function(e){var t=this.$router.resolve({path:"/v2/mhaDbReplications",query:{srcMhaName:e.srcMhaName,dstMhaName:e.dstMhaName,preciseSearchMode:!0,relatedDbName:e.dbName}});window.open(t.href,"_blank")},toMhaReplicationByR:function(e){var t=this.$router.resolve({path:"/v2/mhaReplications",query:{mhaName:e.mhaName,preciseSearchMode:!1}});window.open(t.href,"_blank")},showModal:function(e){0===e.type?this.getRelatedMha(e):(1===e.type||7===e.type)&&this.getRelatedMhaReplication(e)},getRegions:function(){var e=this;this.axios.get("/api/drc/v2/meta/regions/all").then((function(t){e.regions=t.data.data}))},resetParam:function(){this.queryParam={ip:"",type:null,tag:"",active:null,region:"",pageReq:{pageSize:10,pageIndex:1}},this.getResources()},getRelatedMha:function(e){var t=this;this.axios.get("/api/drc/v2/resource/mha?resourceId="+e.resourceId).then((function(e){0===e.data.status?t.relatedMhaData.tableData=e.data.data:(t.$Message.warning("查询异常"),t.relatedMhaData.tableData=[])})),this.relatedMhaData.modal=!0},getRelatedMhaReplication:function(e){var t=this;this.relatedReplicationData.tableData=[],this.axios.get("/api/drc/v2/resource/mhaReplication?resourceId="+e.resourceId).then((function(e){0===e.data.status?t.relatedReplicationData.tableData=e.data.data:(t.$Message.warning("查询异常"),t.relatedReplicationData.tableData=[])})),this.relatedReplicationData.modal=!0},getResources:function(){var e=this,t={ip:this.queryParam.ip,type:this.queryParam.type,tag:this.queryParam.tag,active:this.queryParam.active,region:this.queryParam.region,pageReq:{pageSize:this.size,pageIndex:this.current}},a=this.flattenObj(t);e.dataLoading=!0,e.axios.get("/api/drc/v2/resource/all",{params:a}).then((function(t){console.log("/api/drc/v2/resource/all response:"+t);var a=t.data,r=t.data.pageReq;1===a.status?e.$Message.error("查询异常: "+a.message):0===a.data.length||0===r.totalCount?(e.total=0,e.current=1,e.resources=[],e.$Message.warning("查询结果为空")):(e.total=r.totalCount,e.current=r.pageIndex,e.resources=a.data,e.$Message.success("查询成功"))})).catch((function(t){e.$Message.error("查询异常: "+t)})).finally((function(){e.dataLoading=!1}))},handleAddTag:function(e){this.constant.tagList.push(e)},handleChangeSize:function(e){var t=this;this.size=e,this.$nextTick((function(){t.getResources()}))},handleBeforeChange:function(){var e=this;return console.log("handleBeforeChange:",this.switchOneInfo),new Promise((function(t){e.$Modal.confirm({title:"切换确认",content:"您确认要切换开关状态吗？",onOk:function(){t()}})}))},preDeleteResource:function(e,t){this.deleteResourceInfo={resourceId:e.resourceId,ip:e.ip,tag:e.tag,az:e.az,instanceNum:e.instanceNum},this.deleteResourceModal=!0},clearDeleteResource:function(){this.deleteResourceInfo={resourceId:null,ip:"",tag:"",az:"",instanceNum:0}},deleteResource:function(e,t){var a=this;this.axios.delete("/api/drc/v2/resource/?resourceId="+this.deleteResourceInfo.resourceId).then((function(e){0===e.data.status?(a.$Message.success("删除成功"),a.getResources()):a.$Message.warning("下线失败 "+e.data.message)}))},switchActiveStatus:function(e,t){0===t?this.activeResource(e):this.deactivateResource(e)},deactivateResource:function(e){var t=this;this.axios.post("/api/drc/v2/resource/deactivate?resourceId="+e).then((function(e){0===e.data.status?t.$Message.success("已停用"):t.$Message.warning("停用失败"),t.getResources()}))},activeResource:function(e){var t=this;this.axios.post("/api/drc/v2/resource/active?resourceId="+e).then((function(e){0===e.data.status?t.$Message.success("已启用"):t.$Message.warning("启用失败"),t.getResources()}))},flattenObj:function(e){var t={};for(var a in e)if("object"!==Object(n["a"])(e[a])||Array.isArray(e[a]))t[a]=e[a];else{var r=this.flattenObj(e[a]);for(var i in r)t[a+"."+i]=r[i]}return t}},created:function(){var e=this;this.axios.get("/api/drc/v2/permission/resource/machine").then((function(t){403!==t.data.status?(console.log("still execute"),e.getResources(),e.getRegions()):e.$router.push("/nopermission")}))}}),l=s,c=(a("5c86"),a("2877")),p=Object(c["a"])(l,r,i,!1,null,"4f4e76a8",null);t["default"]=p.exports},a630:function(e,t,a){var r=a("23e7"),i=a("4df4"),n=a("1c7e"),o=!n((function(e){Array.from(e)}));r({target:"Array",stat:!0,forced:o},{from:i})},ad6d:function(e,t,a){"use strict";var r=a("825a");e.exports=function(){var e=r(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},fb6a:function(e,t,a){"use strict";var r=a("23e7"),i=a("861d"),n=a("e8b5"),o=a("23cb"),s=a("50c4"),l=a("fc6a"),c=a("8418"),p=a("b622"),u=a("1dde"),d=a("ae40"),g=u("slice"),f=d("slice",{ACCESSORS:!0,0:0,1:2}),h=p("species"),m=[].slice,I=Math.max;r({target:"Array",proto:!0,forced:!g||!f},{slice:function(e,t){var a,r,p,u=l(this),d=s(u.length),g=o(e,d),f=o(void 0===t?d:t,d);if(n(u)&&(a=u.constructor,"function"!=typeof a||a!==Array&&!n(a.prototype)?i(a)&&(a=a[h],null===a&&(a=void 0)):a=void 0,a===Array||void 0===a))return m.call(u,g,f);for(r=new(void 0===a?Array:a)(I(f-g,0)),p=0;g<f;g++,p++)g in u&&c(r,p,u[g]);return r.length=p,r}})}}]);
//# sourceMappingURL=chunk-60394b31.a72710ee.js.map