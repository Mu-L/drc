(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-65b5f204"],{"159b":function(t,e,i){var a=i("da84"),n=i("fdbc"),o=i("17c2"),r=i("9112");for(var s in n){var c=a[s],l=c&&c.prototype;if(l&&l.forEach!==o)try{r(l,"forEach",o)}catch(d){l.forEach=o}}},"17c2":function(t,e,i){"use strict";var a=i("b727").forEach,n=i("a640"),o=i("ae40"),r=n("forEach"),s=o("forEach");t.exports=r&&s?[].forEach:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}},2532:function(t,e,i){"use strict";var a=i("23e7"),n=i("5a34"),o=i("1d80"),r=i("ab13");a({target:"String",proto:!0,forced:!r("includes")},{includes:function(t){return!!~String(o(this)).indexOf(n(t),arguments.length>1?arguments[1]:void 0)}})},"44e7":function(t,e,i){var a=i("861d"),n=i("c6b6"),o=i("b622"),r=o("match");t.exports=function(t){var e;return a(t)&&(void 0!==(e=t[r])?!!e:"RegExp"==n(t))}},"5a34":function(t,e,i){var a=i("44e7");t.exports=function(t){if(a(t))throw TypeError("The method doesn't accept regular expressions");return t}},"7d9d":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("base-component",[i("Breadcrumb",{style:{margin:"15px 0 15px 185px",position:"fixed"}},[i("BreadcrumbItem",{attrs:{to:{path:"/v2/mhaReplications",query:{srcMhaName:this.initInfo.srcMhaName,dstMhaName:this.initInfo.dstMhaName,preciseSearchMode:!0}}}},[t._v("首页 ")]),i("BreadcrumbItem",{attrs:{to:{path:"/drcV2",query:{step:3,srcMhaName:this.initInfo.srcMhaName,dstMhaName:this.initInfo.dstMhaName,srcDc:this.initInfo.srcDc,dstDc:this.initInfo.dstDc,order:this.initInfo.order}}}},[t._v("DRC配置V2 ")]),i("BreadcrumbItem",[t._v("同步表")])],1),i("Content",{staticClass:"content",style:{padding:"10px",background:"#fff",margin:"50px 0 1px 185px",zIndex:"1"}},[i("Row",[i("Col",{attrs:{span:"16"}},[i("span",{staticStyle:{"margin-top":"10px",color:"#464c5b","font-weight":"600"}},[t._v(t._s(t.initInfo.srcMhaName)+"("+t._s(t.initInfo.srcDc)+")==>"+t._s(t.initInfo.dstMhaName)+"("+t._s(t.initInfo.dstDc)+")")])]),i("Col",{attrs:{span:"2"}},[i("Button",{staticStyle:{"margin-top":"10px","text-align":"right"},attrs:{type:"primary",ghost:""},on:{click:t.goTodbReplicationConfigV2}},[t._v("添加 ")])],1),i("Col",{attrs:{span:"2"}},[i("Button",{staticStyle:{"margin-top":"10px","text-align":"right"},attrs:{type:"primary",ghost:""},on:{click:function(e){return t.batchUpdate()}}},[t._v("批量修改 ")])],1),i("Col",{attrs:{span:"2"}},[i("Button",{staticStyle:{"margin-top":"10px","text-align":"right"},attrs:{type:"error",ghost:""},on:{click:function(e){return t.preBatchDelete()}}},[t._v("批量删除 ")])],1)],1),i("div",{style:{padding:"1px 1px",height:"100%"}},[[i("Table",{ref:"multipleTable",staticStyle:{"margin-top":"20px"},attrs:{stripe:"",columns:t.columns,data:t.tableData,border:""},on:{"on-selection-change":t.changeSelection},scopedSlots:t._u([{key:"action",fn:function(e){var a=e.row,n=e.index;return[i("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"success",size:"small"},on:{click:function(e){return t.goToShowConfig(a,n)}}},[t._v("查看 ")]),i("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"primary",size:"small"},on:{click:function(e){return t.goToUpdateConfig(a,n)}}},[t._v("修改 ")]),i("Button",{staticStyle:{"margin-right":"10px"},attrs:{type:"error",size:"small"},on:{click:function(e){return t.preDeleteDbReplication(a,n)}}},[t._v(" 删除 ")])]}}])})]],2),i("Modal",{attrs:{title:"确认删除以下同步表",width:"1200px"},on:{"on-ok":t.deleteDbReplication,"on-cancel":t.clearDeleteDbReplication},model:{value:t.batchDeleteModal,callback:function(e){t.batchDeleteModal=e},expression:"batchDeleteModal"}},[i("div",{style:{padding:"1px 1px",height:"100%"}},[i("p",[i("span",[t._v("一共 ")]),i("span",{staticStyle:{color:"red","font-size":"16px","word-break":"break-all","word-wrap":"break-word"}},[t._v(t._s(this.deleteData.length))]),i("span",[t._v(" 行")])]),[i("Table",{staticStyle:{"margin-top":"20px"},attrs:{stripe:"",columns:t.deleteColumns,data:t.deleteData,border:""}})]],2)])],1)],1)},n=[],o=(i("caad"),i("d3b7"),i("2532"),i("159b"),{name:"tables",data:function(){return{initInfo:{srcMhaName:"",srcMhaId:0,dstMhaName:"",dbReplicationId:0,multiData:[],srcDc:"",dstDc:"",order:!0},batchDeleteModal:!1,deleteData:[],filterMap:{0:"行过滤",1:"字段过滤"},columns:[{type:"selection",width:60,align:"center"},{title:"序号",width:75,align:"center",render:function(t,e){return t("span",e.index+1)}},{title:"库名",key:"dbName"},{title:"表名",key:"logicTableName"},{title:"创建时间",key:"createTime"},{title:"修改时间",key:"updateTime"},{title:"过滤规则",key:"filterTypes",width:300,render:function(t,e){var i=e.row,a=i.filterTypes,n=!1,o=!1;return null===a?t("Tag",{props:{color:"red"}},"无"):(n=a.includes(0),o=a.includes(1),t("div",[n&&t("Tag",{props:{color:"blue"}},"行过滤"),o&&t("Tag",{props:{color:"green"}},"字段过滤")]))}},{title:"操作",slot:"action",align:"center",width:200,fixed:"right"}],deleteColumns:[{title:"序号",width:75,align:"center",render:function(t,e){return t("span",e.index+1)}},{title:"库名",key:"dbName"},{title:"表名",key:"logicTableName"},{title:"过滤规则配置",key:"filterTypes",width:200,render:function(t,e){var i=e.row,a=i.filterTypes,n=!1,o=!1;return null===a?t("Tag",{props:{color:"red"}},"无"):(n=a.includes(0),o=a.includes(1),t("div",[n&&t("Tag",{props:{color:"blue"}},"行过滤"),o&&t("Tag",{props:{color:"green"}},"字段过滤")]))}}],propertiesJson:{},tableData:[],total:0,size:5,pageSizeOpts:[5,10,20,100]}},methods:{getFilterText:function(t){},changeSelection:function(t){this.initInfo.multiData=t,console.log(this.initInfo.multiData)},getDbReplications:function(){var t=this;this.axios.get("/api/drc/v2/config/dbReplication?srcMhaName="+this.initInfo.srcMhaName+"&dstMhaName="+this.initInfo.dstMhaName).then((function(e){1===e.data.status?t.$Message.error("查询同步表失败!"):t.tableData=e.data.data}))},goTodbReplicationConfigV2:function(){this.$router.push({path:"/dbReplicationConfigV2",query:{srcMhaName:this.initInfo.srcMhaName,dstMhaName:this.initInfo.dstMhaName,srcDc:this.initInfo.srcDc,dstDc:this.initInfo.dstDc,update:!1}})},goToShowConfig:function(t,e){var i=[];i.push(t.dbReplicationId),this.$router.push({path:"/dbReplicationConfigV2",query:{srcMhaName:this.initInfo.srcMhaName,dstMhaName:this.initInfo.dstMhaName,srcDc:this.initInfo.srcDc,dstDc:this.initInfo.dstDc,dbName:t.dbName,tableName:t.logicTableName,dbReplicationId:t.dbReplicationId,dbReplicationIds:JSON.stringify(i),update:!0,show:!0}})},preBatchDelete:function(){var t=this.initInfo.multiData;void 0!==t&&null!==t&&0!==t.length?(this.batchDeleteModal=!0,this.deleteData=this.initInfo.multiData):this.$Message.warning("请勾选！")},batchUpdate:function(){var t=this,e=this.initInfo.multiData;if(void 0!==e&&null!==e&&0!==e.length){var i=e[0],a=[];e.forEach((function(t){return a.push(t.dbReplicationId)}));var n="";if(e.length>1){n="("+i.dbName;for(var o=1;o<e.length;o++){if(e[o].logicTableName!==i.logicTableName)return void this.$Message.warning("表名不一样不能勾选");n+="|"+e[o].dbName}n+=")"}else n=i.dbName;this.axios.get("/api/drc/v2/config/dbReplications/check?dbReplicationIds="+a).then((function(e){1===e.data.status?t.$Message.warning("过滤规则不一致不能勾选"):t.$router.push({path:"/dbReplicationConfigV2",query:{srcMhaName:t.initInfo.srcMhaName,dstMhaName:t.initInfo.dstMhaName,srcDc:t.initInfo.srcDc,dstDc:t.initInfo.dstDc,dbName:n,tableName:i.logicTableName,dbReplicationId:i.dbReplicationId,dbReplicationIds:JSON.stringify(a),update:!0,batchUpdate:!0}})}))}else this.$Message.warning("请勾选！")},checkBatchUpdate:function(t){var e=this,i=!0;return this.axios.get("/api/drc/v2/config/dbReplications/check?dbReplicationIds="+t).then((function(t){1===t.data.status&&(i=!1,alert("re:"+i),e.$Message.warning("过滤规则不一致不能勾选"))})),i},goToUpdateConfig:function(t,e){var i=[];i.push(t.dbReplicationId),this.$router.push({path:"/dbReplicationConfigV2",query:{srcMhaName:this.initInfo.srcMhaName,dstMhaName:this.initInfo.dstMhaName,srcDc:this.initInfo.srcDc,dstDc:this.initInfo.dstDc,dbName:t.dbName,tableName:t.logicTableName,dbReplicationId:t.dbReplicationId,dbReplicationIds:JSON.stringify(i),update:!0}})},preDeleteDbReplication:function(t,e){this.deleteData=[],this.deleteData.push(t),this.batchDeleteModal=!0},clearDeleteDbReplication:function(t,e){this.deleteData=[],this.batchDeleteModal=!1},deleteDbReplication:function(){var t=this,e=[];this.deleteData.forEach((function(t){return e.push(t.dbReplicationId)})),this.axios.delete("/api/drc/v2/config/dbReplications?dbReplicationIds="+e).then((function(e){1===e.data.status?t.$Message.error("删除失败!"+e.data.message):(t.$Message.success("删除成功!"),t.getDbReplications(),t.initInfo.multiData=[])}))}},created:function(){var t=this;this.axios.get("/api/drc/v2/permission/meta/mhaReplication/modify").then((function(e){403!==e.data.status?(t.initInfo={srcMhaName:t.$route.query.srcMhaName,srcMhaId:t.$route.query.srcMhaId,dstMhaName:t.$route.query.dstMhaName,applierGroupId:t.$route.query.applierGroupId,srcDc:t.$route.query.srcDc,dstDc:t.$route.query.dstDc,order:t.$route.query.order},console.log("initInfo:"),console.log(t.initInfo),t.getDbReplications()):t.$router.push("/nopermission")}))}}),r=o,s=i("2877"),c=Object(s["a"])(r,a,n,!1,null,"2ebd2d4d",null);e["default"]=c.exports},a640:function(t,e,i){"use strict";var a=i("d039");t.exports=function(t,e){var i=[][t];return!!i&&a((function(){i.call(null,e||function(){throw 1},1)}))}},ab13:function(t,e,i){var a=i("b622"),n=a("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(i){try{return e[n]=!1,"/./"[t](e)}catch(a){}}return!1}}}]);
//# sourceMappingURL=chunk-65b5f204.c94b0be1.js.map