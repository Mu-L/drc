{"version":3,"sources":["webpack:///./src/views/monitor/incrementDataConsistencyCheck.vue","webpack:///src/views/monitor/incrementDataConsistencyCheck.vue","webpack:///./src/views/monitor/incrementDataConsistencyCheck.vue?849e","webpack:///./src/views/monitor/incrementDataConsistencyCheck.vue?79fc"],"names":["render","_vm","this","_c","_self","attrs","isFather","fatherMenu","style","margin","position","_v","staticClass","padding","background","zIndex","staticStyle","_s","$route","query","clusterA","clusterB","columns","dataWithPage","tables","length","current","on","$event","handleChangeSize","staticRenderFns","name","data","_this","confirmAddTableModal","resultConfirmAddTableModal","confirmAddTableResult","addTableStatus","addTableSMsg","commitItem","monitorTableName","monitorTableKey","monitorTableOnUpdate","confirmDeleteTableModal","resultConfirmDeleteTableModal","confirmDeleteTableResult","deleteTableStatus","deleteTableSMsg","commitDeleteItem","deleteIndex","size","title","width","align","h","params","index","key","row","props","value","monitorSwitch","scopedSlots","open","close","switchDataConsistencyMonitor","type","marginRight","click","showCheckResult","computed","start","end","_toConsumableArray","slice","methods","handleDataConsistencyAdd","push","status","handleDataConsistencyAddCommit","item","okHandleDataConsistencyAddCommit","that","axios","post","table","onUpdate","then","res","console","log","message","cancelHandleDataConsistencyAddCommit","okAddTableResult","$router","go","handleDataConsistencyDeleteCommit","id","okHandleDataConsistencyDeleteCommit","delete","cancelHandleDataConsistencyDeleteCommit","okDeleteTableResult","getConfiguredTables","get","response","val","switchStatus","srcMha","dstMha","schema","monitorSchemaName","created","component"],"mappings":"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","file":"js/chunk-2d0bfed7.77b5e375.js","sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('base-component',{attrs:{\"isFather\":_vm.isFather,\"subMenuName\":['1'],\"fatherMenu\":_vm.fatherMenu}},[_c('Breadcrumb',{style:({margin: '15px 0 15px 185px', position: 'fixed'})},[_c('BreadcrumbItem',{attrs:{\"to\":\"/home\"}},[_vm._v(\"首页\")]),_c('BreadcrumbItem',{attrs:{\"to\":\"/incrementDataConsistencyResult\"}},[_vm._v(\"校验结果\")]),_c('BreadcrumbItem',{attrs:{\"to\":\"/incrementDataConsistencyCluster\"}},[_vm._v(\"校验集群\")]),_c('BreadcrumbItem',[_vm._v(\"校验配置\")])],1),_c('Content',{staticClass:\"content\",style:({padding: '10px', background: '#fff', margin: '50px 0 1px 185px', zIndex: '1'})},[_c('div',{staticStyle:{\"padding\":\"1px 1px\"}},[_c('div',{staticClass:\"ivu-list-item-meta-title\"},[_c('p',[_vm._v(\"DRC集群：\"+_vm._s(_vm.$route.query.clusterA)+\"(集群A)---\"+_vm._s(_vm.$route.query.clusterB)+\"(集群B)\")])]),_c('Table',{attrs:{\"stripe\":\"\",\"columns\":_vm.columns,\"data\":_vm.dataWithPage}}),_c('div',{staticStyle:{\"text-align\":\"center\",\"margin\":\"16px 0\"}},[_c('Page',{attrs:{\"transfer\":true,\"total\":_vm.tables.length,\"current\":_vm.current,\"show-sizer\":\"\",\"show-elevator\":\"\"},on:{\"update:current\":function($event){_vm.current=$event},\"on-page-size-change\":_vm.handleChangeSize}})],1)],1)])],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <base-component :isFather=\"isFather\" :subMenuName=\"['1']\" :fatherMenu=\"fatherMenu\">\n    <Breadcrumb :style=\"{margin: '15px 0 15px 185px', position: 'fixed'}\">\n      <BreadcrumbItem to=\"/home\">首页</BreadcrumbItem>\n      <BreadcrumbItem to=\"/incrementDataConsistencyResult\">校验结果</BreadcrumbItem>\n      <BreadcrumbItem to=\"/incrementDataConsistencyCluster\">校验集群</BreadcrumbItem>\n      <BreadcrumbItem>校验配置</BreadcrumbItem>\n    </Breadcrumb>\n    <Content class=\"content\" :style=\"{padding: '10px', background: '#fff', margin: '50px 0 1px 185px', zIndex: '1'}\">\n      <div style=\"padding: 1px 1px\">\n        <div class=\"ivu-list-item-meta-title\">\n          <p>DRC集群：{{$route.query.clusterA}}(集群A)---{{$route.query.clusterB}}(集群B)</p>\n        </div>\n        <Table stripe :columns=\"columns\" :data=\"dataWithPage\">\n        </Table>\n        <div style=\"text-align: center;margin: 16px 0\">\n          <Page\n            :transfer=\"true\"\n            :total=\"tables.length\"\n            :current.sync=\"current\"\n            show-sizer\n            show-elevator\n            @on-page-size-change=\"handleChangeSize\"></Page>\n        </div>\n      </div>\n    </Content>\n  </base-component>\n</template>\n\n<script>\n\nexport default {\n  name: 'consistencyMonitorConfig',\n  data () {\n    return {\n      isFather: true,\n      fatherMenu: '/incrementDataConsistencyResult',\n      confirmAddTableModal: false,\n      resultConfirmAddTableModal: false,\n      confirmAddTableResult: '',\n      addTableStatus: '',\n      addTableSMsg: '',\n      commitItem: {\n        monitorTableName: '',\n        monitorTableKey: '',\n        monitorTableOnUpdate: ''\n      },\n      confirmDeleteTableModal: false,\n      resultConfirmDeleteTableModal: false,\n      confirmDeleteTableResult: '',\n      deleteTableStatus: '',\n      deleteTableSMsg: '',\n      commitDeleteItem: {\n        monitorTableName: '',\n        monitorTableKey: '',\n        monitorTableOnUpdate: ''\n      },\n      deleteIndex: 0,\n      tables: [],\n      current: 1,\n      size: 10,\n      columns: [\n        {\n          title: '序号',\n          width: 75,\n          align: 'center',\n          render: (h, params) => {\n            return h(\n              'span',\n              params.index + 1 + (this.current - 1) * this.size\n            )\n          }\n        },\n        {\n          title: '库名',\n          key: 'monitorSchemaName'\n        },\n        {\n          title: '表名',\n          key: 'monitorTableName'\n        },\n        {\n          title: 'key',\n          width: 100,\n          key: 'monitorTableKey',\n          align: 'center'\n        },\n        {\n          title: 'onUpdate',\n          key: 'monitorTableOnUpdate',\n          align: 'center'\n        },\n        // {\n        //   title: '操作',\n        //   key: 'monitorSwitch',\n        //   width: 200,\n        //   align: 'center',\n        //   render: (h, params) => {\n        //     const row = params.row\n        //     const type = row.monitorSwitch === 0 ? 'success' : 'error'\n        //     const text = row.monitorSwitch === 0 ? '开启监控' : '取消监控'\n        //\n        //     return h('Button', {\n        //       props: {\n        //         type: type,\n        //         size: 'small'\n        //       },\n        //       on: {\n        //         click: () => {\n        //           this.switchDataConsistencyMonitor(row)\n        //         }\n        //       }\n        //     }, text)\n        //   }\n        // },\n        {\n          title: '操作',\n          key: 'monitorSwitch',\n          width: 200,\n          align: 'center',\n          render: (h, params) => {\n            const row = params.row\n\n            return h('i-switch', {\n              props: {\n                size: 'large',\n                value: row.monitorSwitch === 1\n              },\n              scopedSlots: {\n                open: () => h('span', '开启'),\n                close: () => h('span', '关闭')\n              },\n              on: {\n                'on-change': () => {\n                  this.switchDataConsistencyMonitor(row)\n                }\n              }\n            })\n          }\n        },\n        {\n          title: '校验结果',\n          align: 'center',\n          render: (h, params) => {\n            return h('div', [\n              h('Button', {\n                props: {\n                  type: 'info',\n                  size: 'small'\n                },\n                style: {\n                  marginRight: '5px'\n                },\n                on: {\n                  click: () => {\n                    this.showCheckResult(params.row)\n                  }\n                }\n              }, '查看')\n            ])\n          }\n        }\n      ]\n    }\n  },\n  computed: {\n    dataWithPage () {\n      const data = this.tables\n      const start = this.current * this.size - this.size\n      const end = start + this.size\n      return [...data].slice(start, end)\n    }\n  },\n  methods: {\n    handleDataConsistencyAdd () {\n      this.tables.push({ monitorTableName: '', monitorTableKey: '', monitorTableOnUpdate: '', status: 0 })\n    },\n    handleDataConsistencyAddCommit (item) {\n      this.confirmAddTableModal = true\n      this.commitItem.monitorTableName = item.monitorTableName\n      this.commitItem.monitorTableKey = item.monitorTableKey\n      this.commitItem.monitorTableOnUpdate = item.monitorTableOnUpdate\n    },\n    okHandleDataConsistencyAddCommit () {\n      const that = this\n      this.axios.post('/api/drc/v1/monitor/consistency/data/' + this.$route.query.clusterA + '/' + this.$route.query.clusterB, {\n        table: that.commitItem.monitorTableName,\n        key: that.commitItem.monitorTableKey,\n        onUpdate: that.commitItem.monitorTableOnUpdate\n      }).then(res => {\n        console.log('add result')\n        console.log(res.data)\n        if (res.data.status === 0) {\n          that.addTableStatus = 'success'\n          that.addTableSMsg = res.data.message\n        } else {\n          that.addTableStatus = 'error'\n          that.addTableSMsg = res.data.data.message\n        }\n      })\n      this.resultConfirmAddTableModal = true\n    },\n    cancelHandleDataConsistencyAddCommit () {\n      this.confirmAddTableModal = false\n    },\n    okAddTableResult () {\n      this.$router.go(0)\n      this.confirmAddTableModal = false\n      this.resultConfirmAddTableModal = false\n    },\n\n    handleDataConsistencyDeleteCommit (item) {\n      this.confirmDeleteTableModal = true\n      this.commitDeleteItem.monitorTableName = item.monitorTableName\n      this.commitDeleteItem.monitorTableKey = item.monitorTableKey\n      this.commitDeleteItem.monitorTableOnUpdate = item.monitorTableOnUpdate\n      this.deleteIndex = item.id\n    },\n    okHandleDataConsistencyDeleteCommit () {\n      const that = this\n      this.axios.delete('/api/drc/v1/monitor/consistency/data/' + this.deleteIndex)\n        .then(res => {\n          console.log(res.data)\n          if (res.data.status === 0) {\n            that.deleteTableStatus = 'success'\n            that.deleteTableSMsg = res.data.message\n          } else {\n            that.deleteTableStatus = 'error'\n            that.deleteTableSMsg = res.data.data.message\n          }\n        })\n      this.resultConfirmDeleteTableModal = true\n    },\n    cancelHandleDataConsistencyDeleteCommit () {\n      this.confirmDeleteTableModal = false\n    },\n    okDeleteTableResult () {\n      this.$router.go(0)\n      this.confirmDeleteTableModal = false\n      this.resultConfirmDeleteTableModal = false\n    },\n    getConfiguredTables () {\n      const that = this\n      this.axios.get('/api/drc/v1/monitor/consistency/data/' + this.$route.query.clusterA + '/' + this.$route.query.clusterB)\n        .then(response => {\n          that.tables = response.data.data\n          console.log(response.data)\n        })\n    },\n    handleChangeSize (val) {\n      this.size = val\n    },\n    switchDataConsistencyMonitor (row) {\n      const that = this\n      const switchStatus = row.monitorSwitch === 0 ? 'on' : 'off'\n      this.axios.post('/api/drc/v1/monitor/consistency/switches/' + switchStatus, [\n        {\n          srcMha: that.$route.query.clusterA,\n          dstMha: that.$route.query.clusterB,\n          schema: row.monitorSchemaName,\n          table: row.monitorTableName,\n          key: row.monitorTableKey,\n          onUpdate: row.monitorTableOnUpdate\n        }\n      ]).then(res => {\n        console.log('show result')\n        console.log(res.data)\n        if (res.data.status === 0) {\n          row.monitorSwitch = 1 - row.monitorSwitch\n        }\n      })\n    },\n    showCheckResult (row) {\n      this.$router.push({\n        name: 'incrementDataConsistencyResult'\n      })\n    }\n  },\n  created () {\n    this.getConfiguredTables()\n  }\n}\n</script>\n\n<style scoped>\n\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./incrementDataConsistencyCheck.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./incrementDataConsistencyCheck.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./incrementDataConsistencyCheck.vue?vue&type=template&id=e8b2e880&scoped=true\"\nimport script from \"./incrementDataConsistencyCheck.vue?vue&type=script&lang=js\"\nexport * from \"./incrementDataConsistencyCheck.vue?vue&type=script&lang=js\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"e8b2e880\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}