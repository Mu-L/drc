(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c916d22c"],{"06c5":function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));a("a630"),a("fb6a"),a("b0c0"),a("d3b7"),a("ac1f"),a("25f0"),a("3ca3");var n=a("6b75");function i(t,e){if(t){if("string"==typeof t)return Object(n["a"])(t,e);var a={}.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?Object(n["a"])(t,e):void 0}}},2532:function(t,e,a){"use strict";var n=a("23e7"),i=a("5a34"),r=a("1d80"),o=a("ab13");n({target:"String",proto:!0,forced:!o("includes")},{includes:function(t){return!!~String(r(this)).indexOf(i(t),arguments.length>1?arguments[1]:void 0)}})},"25f0":function(t,e,a){"use strict";var n=a("6eeb"),i=a("825a"),r=a("d039"),o=a("ad6d"),s="toString",c=RegExp.prototype,l=c[s],d=r((function(){return"/a/b"!=l.call({source:"a",flags:"b"})})),p=l.name!=s;(d||p)&&n(RegExp.prototype,s,(function(){var t=i(this),e=String(t.source),a=t.flags,n=String(void 0===a&&t instanceof RegExp&&!("flags"in c)?o.call(t):a);return"/"+e+"/"+n}),{unsafe:!0})},3835:function(t,e,a){"use strict";function n(t){if(Array.isArray(t))return t}a.d(e,"a",(function(){return s}));a("a4d3"),a("e01a"),a("d28b"),a("e260"),a("d3b7"),a("3ca3"),a("ddb0");function i(t,e){var a=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=a){var n,i,r,o,s=[],c=!0,l=!1;try{if(r=(a=a.call(t)).next,0===e){if(Object(a)!==a)return;c=!1}else for(;!(c=(n=r.call(a)).done)&&(s.push(n.value),s.length!==e);c=!0);}catch(t){l=!0,i=t}finally{try{if(!c&&null!=a["return"]&&(o=a["return"](),Object(o)!==o))return}finally{if(l)throw i}}return s}}var r=a("06c5");function o(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(t,e){return n(t)||i(t,e)||Object(r["a"])(t,e)||o()}},"44e7":function(t,e,a){var n=a("861d"),i=a("c6b6"),r=a("b622"),o=r("match");t.exports=function(t){var e;return n(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==i(t))}},"4df4":function(t,e,a){"use strict";var n=a("0366"),i=a("7b0b"),r=a("9bdd"),o=a("e95a"),s=a("50c4"),c=a("8418"),l=a("35a1");t.exports=function(t){var e,a,d,p,u,h,f=i(t),g="function"==typeof this?this:Array,m=arguments.length,b=m>1?arguments[1]:void 0,v=void 0!==b,y=l(f),x=0;if(v&&(b=n(b,m>2?arguments[2]:void 0,2)),void 0==y||g==Array&&o(y))for(e=s(f.length),a=new g(e);e>x;x++)h=v?b(f[x],x):f[x],c(a,x,h);else for(p=y.call(f),u=p.next,a=new g;!(d=u.call(p)).done;x++)h=v?r(p,b,[d.value,x],!0):d.value,c(a,x,h);return a.length=x,a}},"4fad":function(t,e,a){var n=a("23e7"),i=a("6f53").entries;n({target:"Object",stat:!0},{entries:function(t){return i(t)}})},"5a34":function(t,e,a){var n=a("44e7");t.exports=function(t){if(n(t))throw TypeError("The method doesn't accept regular expressions");return t}},"6b75":function(t,e,a){"use strict";function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=Array(e);a<e;a++)n[a]=t[a];return n}a.d(e,"a",(function(){return n}))},"6f53":function(t,e,a){var n=a("83ab"),i=a("df75"),r=a("fc6a"),o=a("d1e7").f,s=function(t){return function(e){var a,s=r(e),c=i(s),l=c.length,d=0,p=[];while(l>d)a=c[d++],n&&!o.call(s,a)||p.push(t?[a,s[a]]:s[a]);return p}};t.exports={entries:s(!0),values:s(!1)}},9263:function(t,e,a){"use strict";var n=a("ad6d"),i=a("9f7f"),r=RegExp.prototype.exec,o=String.prototype.replace,s=r,c=function(){var t=/a/,e=/b*/g;return r.call(t,"a"),r.call(e,"a"),0!==t.lastIndex||0!==e.lastIndex}(),l=i.UNSUPPORTED_Y||i.BROKEN_CARET,d=void 0!==/()??/.exec("")[1],p=c||d||l;p&&(s=function(t){var e,a,i,s,p=this,u=l&&p.sticky,h=n.call(p),f=p.source,g=0,m=t;return u&&(h=h.replace("y",""),-1===h.indexOf("g")&&(h+="g"),m=String(t).slice(p.lastIndex),p.lastIndex>0&&(!p.multiline||p.multiline&&"\n"!==t[p.lastIndex-1])&&(f="(?: "+f+")",m=" "+m,g++),a=new RegExp("^(?:"+f+")",h)),d&&(a=new RegExp("^"+f+"$(?!\\s)",h)),c&&(e=p.lastIndex),i=r.call(u?a:p,m),u?i?(i.input=i.input.slice(g),i[0]=i[0].slice(g),i.index=p.lastIndex,p.lastIndex+=i[0].length):p.lastIndex=0:c&&i&&(p.lastIndex=p.global?i.index+i[0].length:e),d&&i&&i.length>1&&o.call(i[0],a,(function(){for(s=1;s<arguments.length-2;s++)void 0===arguments[s]&&(i[s]=void 0)})),i}),t.exports=s},"9bf1":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("base-component",[a("Breadcrumb",{style:{margin:"15px 0 15px 185px",position:"fixed"}},[a("BreadcrumbItem",{attrs:{to:{path:"/v2/mhaReplications",query:{srcMhaName:this.initInfo.srcMhaName,dstMhaName:this.initInfo.dstMhaName,preciseSearchMode:!0}}}},[t._v("首页 ")]),a("BreadcrumbItem",{attrs:{to:{path:"/drcV2",query:{step:3,srcMhaName:this.initInfo.srcMhaName,dstMhaName:this.initInfo.dstMhaName,srcDc:this.initInfo.srcDc,dstDc:this.initInfo.dstDc,order:this.initInfo.order}}}},[t._v("DRC配置V2 ")]),a("BreadcrumbItem",[t._v("同步表")])],1),a("Content",{staticClass:"content",style:{padding:"10px",background:"#fff",margin:"50px 0 1px 185px",zIndex:"1"}},[a("Row",[a("Col",{attrs:{span:"8"}},[a("span",{staticStyle:{"margin-top":"10px",color:"#464c5b","font-weight":"600"}},[t._v(t._s(t.initInfo.srcMhaName)+"("+t._s(t.initInfo.srcDc)+")==>"+t._s(t.initInfo.dstMhaName)+"("+t._s(t.initInfo.dstDc)+")")])])],1),a("Row",{staticStyle:{"margin-top":"20px",background:"#fdfdff",border:"1px solid #e8eaec"}},[a("Col",{staticStyle:{display:"flex",float:"left",margin:"5px"},attrs:{span:"2"}},[t.submitted?t._e():a("Button",{staticStyle:{"text-align":"right"},attrs:{loading:t.dataLoading,type:"default"},on:{click:function(e){return t.preBatchUpdate()}}},[t._v(" 批量修改 ")])],1),a("Col",{staticStyle:{display:"flex",float:"left",margin:"5px"},attrs:{span:"2"}},[t.submitted?t._e():a("Button",{staticStyle:{"text-align":"right"},attrs:{icon:"md-arrow-up",loading:t.dataLoading,type:"primary"},on:{click:function(e){return t.preSubmit()}}},[t._v("提交 ")]),t.submitted?t._e():a("Button",{staticStyle:{"margin-left":"20px","text-align":"right"},attrs:{icon:"md-swap",loading:t.dataLoading,type:"primary"},on:{click:function(e){return t.preSwitchAppliers()}}},[t._v(" 一键自动切换 ")])],1),a("Col",{staticStyle:{display:"flex",float:"right",margin:"5px"},attrs:{span:"2"}},[a("Dropdown",{attrs:{placement:"bottom-start"},scopedSlots:t._u([{key:"list",fn:function(){return[a("DropdownMenu",[t.dbApplierEmpty?a("DropdownItem",{nativeOn:{click:function(e){return function(){return t.fillMhaApplier()}.apply(null,arguments)}}},[t._v("一键录入 mha applier")]):t._e(),t.dbApplierEmpty?t._e():a("DropdownItem",{nativeOn:{click:function(e){return function(){return t.preClearAndUpdateMhaGtid()}.apply(null,arguments)}}},[t._v("切换至 mha 同步模式")])],1)]},proxy:!0}])},[a("Button",{attrs:{type:"default",icon:"ios-hammer"}},[t._v(" 其他操作 "),a("Icon",{attrs:{type:"ios-arrow-down"}})],1)],1)],1)],1),a("Table",{ref:"multipleTable",staticStyle:{"margin-top":"0px"},attrs:{stripe:"",columns:t.columns,data:t.tableData,loading:t.dataLoading,border:""},on:{"on-selection-change":t.changeSelection},scopedSlots:t._u([{key:"applier",fn:function(e){var n=e.row,i=e.index;return[t.showSelectOptionComponent?a("Select",{staticStyle:{width:"250px"},attrs:{transfer:!0,multiple:"",placeholder:"选择源集群Applier"},model:{value:t.tableData[i].ips,callback:function(e){t.$set(t.tableData[i],"ips",e)},expression:"tableData[index].ips"}},t._l(t.applierResourceList,(function(e){return a("Option",{key:e.ip,attrs:{value:e.ip}},[t._v(t._s(e.ip)+" —— "+t._s(e.az)+" ")])})),1):t._e(),t.showSelectOptionComponent?a("Button",{staticStyle:{"margin-left":"10px"},attrs:{loading:t.applierDataLoading[i],type:"success",size:"small"},on:{click:function(e){return t.autoConfigApplier(n,i)}}},[t._v("自动录入 ")]):t._e(),t.showSelectOptionComponent?t._e():a("span",[t._v(" "+t._s(t.tableData[i].ips.join(", ")))])]}},{key:"gtidInit",fn:function(e){e.row;var n=e.index;return[a("Input",{staticStyle:{width:"80%"},attrs:{border:!1,placeholder:"请输入binlog拉取位点"},model:{value:t.tableData[n].gtidInit,callback:function(e){t.$set(t.tableData[n],"gtidInit",e)},expression:"tableData[index].gtidInit"}})]}},{key:"concurrency",fn:function(e){e.row;var n=e.index;return[a("InputNumber",{staticStyle:{width:"90%"},attrs:{max:150,min:1,placeholder:""},model:{value:t.tableData[n].concurrency,callback:function(e){t.$set(t.tableData[n],"concurrency",e)},expression:"tableData[index].concurrency"}})]}}])}),a("Modal",{attrs:{title:"请设置 Applier",width:"1200px"},on:{"on-ok":t.batchUpdateAppliers},model:{value:t.batchUpdateModal,callback:function(e){t.batchUpdateModal=e},expression:"batchUpdateModal"}},[a("div",{style:{padding:"1px 1px",height:"100%"}},[a("Form",{attrs:{"label-position":"left","label-width":100}},[a("FormItem",{attrs:{label:"Applier"}},[a("Select",{staticStyle:{width:"250px"},attrs:{transfer:!0,multiple:"",placeholder:"选择源集群Applier"},model:{value:t.target.ips,callback:function(e){t.$set(t.target,"ips",e)},expression:"target.ips"}},t._l(t.applierResourceList,(function(e){return a("Option",{key:e.ip,attrs:{value:e.ip}},[t._v(t._s(e.ip)+" —— "+t._s(e.az)+" ")])})),1)],1),a("FormItem",{attrs:{label:"初始同步位点"}},[a("Input",{staticStyle:{width:"80%"},attrs:{border:!1,placeholder:"请输入binlog拉取位点"},model:{value:t.target.gtid,callback:function(e){t.$set(t.target,"gtid",e)},expression:"target.gtid"}})],1)],1),a("p",[a("span",[t._v("共 ")]),a("span",{staticStyle:{color:"red","font-size":"16px","word-break":"break-all","word-wrap":"break-word"}},[t._v(t._s(this.updateData.length))]),a("span",[t._v(" 行数据")])]),[a("Table",{staticStyle:{"margin-top":"20px"},attrs:{stripe:"",columns:t.updateColumns,data:t.updateData,border:""}})]],2)]),a("Modal",{attrs:{title:"回滚至 MHA 同步",width:"1200px"},on:{"on-ok":t.clearAndUpdateMhaGtid},model:{value:t.rollbackModal,callback:function(e){t.rollbackModal=e},expression:"rollbackModal"}},[a("div",{style:{padding:"1px 1px",height:"100%"}},[a("p",[a("span",{staticStyle:{color:"red","font-size":"16px","word-break":"break-all","word-wrap":"break-word"}},[t._v("你正在进行回滚操作，将更新mha位点，并清空所有 db applier！")])]),a("Divider"),a("Form",{staticStyle:{width:"80%"}},[a("FormItem",{attrs:{label:"当前 DB 同步位点"}},[[a("Table",{staticStyle:{"margin-top":"20px"},attrs:{stripe:"",columns:t.dbGtidColumns,data:t.gtidCheck.dbApplied,border:""}})]],2),a("FormItem",{attrs:{label:"当前 Mha 同步位点"}},[a("Input",{attrs:{autosize:{minRows:1,maxRows:30},readonly:""},model:{value:t.gtidCheck.mhaApplied,callback:function(e){t.$set(t.gtidCheck,"mhaApplied",e)},expression:"gtidCheck.mhaApplied"}})],1),a("FormItem",{attrs:{label:"回滚后，Mha 初始同步位点将被设置为："}},[a("Input",{attrs:{type:"textarea",autosize:{minRows:1,maxRows:30},readonly:""},model:{value:t.gtidCheck.mhaTarget,callback:function(e){t.$set(t.gtidCheck,"mhaTarget",e)},expression:"gtidCheck.mhaTarget"}})],1)],1)],1)])],1)],1)},i=[],r=a("b85c"),o=a("3835"),s=a("c7eb"),c=a("1da1"),l=a("53ca"),d=(a("caad"),a("a15b"),a("d81d"),a("4fad"),a("d3b7"),a("2532"),a("3ca3"),a("159b"),a("ddb0"),a("2b0e")),p={name:"tables",data:function(){var t=this;return{initInfo:{srcMhaName:"",srcMhaId:0,dstMhaName:"",dbReplicationId:0,multiData:[],srcDc:"",dstDc:"",order:!0},dataLoading:!1,applierDataLoading:[],submitted:!1,applierResourceList:[],batchUpdateModal:!1,rollbackModal:!1,gtidCheck:{mhaApplied:"",dbApplied:[],mhaTarget:""},mhaApplierInitGtid:null,deleteData:[],filters:[],filterMap:{0:"行过滤",1:"字段过滤"},target:{gtid:"",ips:[]},columns:[{type:"selection",width:60,align:"center"},{title:"库名",key:"dbName",width:200},{title:"Applier",slot:"applier",width:400,renderHeader:function(e,a){return e("span",[e("span","Applier 配置 -- "),e("Button",{props:{type:"success",size:"small"},on:{click:function(){t.batchAutoConfigure()}}},"自动录入")])},filters:[{label:"空",value:null},{label:"非空",value:"not null"}],filterMultiple:!1,filterMethod:function(t,e){return t?e.ips&&e.ips.length>0:!e.ips||0===e.ips.length}},{title:"初始同步位点",slot:"gtidInit"},{title:"并发数",width:200,slot:"concurrency"}],updateColumns:[{title:"库名",key:"dbName",width:200},{title:"applier 配置",key:"applier",width:300,render:function(t,e){var a=e.row,n=a.ips;return null===n||0===n.length?t("Tag",{props:{color:"blue"}},"无"):t("span",a.ips.join(", "))}},{title:"初始同步位点",key:"gtidInit",render:function(t,e){var a=e.row,n=a.gtidInit;return null===n||0===n.length?t("Tag",{props:{color:"blue"}},"无"):t("span",n)}}],dbGtidColumns:[{title:"库名",key:"dbName",width:200},{title:"当前同步位点",key:"gtidInit",render:function(t,e){var a=e.row,n=a.gtidInit;return null===n||0===n.length?t("Tag",{props:{color:"blue"}},"无"):t("span",n)}}],updateData:[],propertiesJson:{},tableData:[],dbApplierDtos:[],total:0,size:5,pageSizeOpts:[5,10,20,100]}},methods:{getSwitchParams:function(){return[{srcMhaName:this.initInfo.srcMhaName,dstMhaName:this.initInfo.dstMhaName,dbNames:this.dbApplierDtos.map((function(t){return t.dbName}))}]},switchAppliers:function(){var t=this,e=this.getSwitchParams();console.log(e),this.dataLoading=!0,this.axios.post("/api/drc/v2/autoconfig/switchAppliers",e).then((function(e){var a=e.data,n=0===a.status;n?(t.submitted=!0,t.$Message.success("提交成功")):t.$Message.warning("提交失败: "+a.message)})).catch((function(e){t.$Message.error("提交异常: "+e)})).finally((function(){t.$Modal.remove(),t.dataLoading=!1,t.getDbAppliers()}))},getFilterText:function(t){},changeSelection:function(t){this.initInfo.multiData=t,console.log(this.initInfo.multiData)},flattenObj:function(t){var e={};for(var a in t)if("object"!==Object(l["a"])(t[a])||Array.isArray(t[a]))e[a]=t[a];else{var n=this.flattenObj(t[a]);for(var i in n)e[a+"."+i]=n[i]}return e},getFilteredData:function(){return this.$refs.multipleTable.makeDataWithSortAndFilter()},autoConfigApplier:function(t,e){var a=this;d["default"].set(this.applierDataLoading,e,!0),this.axios.get("/api/drc/v2/resource/db/auto",{params:{dstMhaName:this.initInfo.dstMhaName,type:1,selectedIps:t.ips?t.ips.join(","):null}}).then((function(n){t.ips=[],n.data.data.forEach((function(e){return t.ips.push(e.ip)})),d["default"].set(a.tableData,e,t)})).catch((function(t){a.$Message.error("提交异常: "+t)})).finally((function(){a.applierDataLoading[e]=!1}))},preSubmit:function(){var t=this;this.$Modal.confirm({title:"提交确认",content:"您确定要提交么？",onOk:function(){t.submitDbAppliers()}})},preSwitchAppliers:function(){var t=this;this.$Modal.confirm({title:"自动切换Applier",content:"<p>请确认</p>",loading:!0,onOk:function(){t.switchAppliers()}})},submitDbAppliers:function(){var t=this,e={srcBuildParam:{mhaName:this.initInfo.srcMhaName,dbApplierDtos:[]},dstBuildParam:{mhaName:this.initInfo.dstMhaName,dbApplierDtos:this.getFilteredData(),applierInitGtid:this.gtidCheck.mhaTarget}};console.log(e),this.dataLoading=!0,this.axios.post("/api/drc/v2/config/db/applier",e).then(function(){var e=Object(c["a"])(Object(s["a"])().mark((function e(a){var n,i;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=a.data,i=1!==n.status,!i){e.next=9;break}return t.submitted=!0,t.$Message.success("提交成功"),e.next=7,t.getDbAppliers();case 7:e.next=10;break;case 9:t.$Message.warning("提交失败: "+n.message);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){t.$Message.error("提交异常: "+e)})).finally((function(){t.gtidCheck.mhaTarget=null,t.dataLoading=!1}))},batchAutoConfigure:function(){var t=this;return Object(c["a"])(Object(s["a"])().mark((function e(){return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.tableData.map((function(e,a){return t.autoConfigApplier(e,a)}));case 1:case"end":return e.stop()}}),e)})))()},getResources:function(){var t=this;this.axios.get("/api/drc/v2/resource/db/all",{params:{srcMhaName:this.initInfo.srcMhaName,dstMhaName:this.initInfo.dstMhaName,type:1}}).then((function(e){console.log(e.data),t.applierResourceList=e.data.data}))},getDbAppliers:function(){var t=this;return Object(c["a"])(Object(s["a"])().mark((function e(){return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.dataLoading=!0,t.axios.get("/api/drc/v2/config/mha/dbApplier",{params:{srcMhaName:t.initInfo.srcMhaName,dstMhaName:t.initInfo.dstMhaName}}).then((function(e){1===e.data.status?t.$Message.error("查询 db applier 失败!"):(t.tableData=e.data.data,t.dbApplierDtos=e.data.data)})).finally((function(){t.dataLoading=!1}));case 2:case"end":return e.stop()}}),e)})))()},preBatchUpdate:function(){var t=this.$refs.multipleTable.getSelection();void 0!==t&&null!==t&&0!==t.length?(this.batchUpdateModal=!0,this.updateData=t,this.target.ips=[],this.target.gtid=""):this.$Message.warning("请勾选！")},fillMhaApplier:function(){var t=this;this.dataLoading=!0,Promise.all([this.axios.get("/api/drc/v2/config/mha/applier?srcMhaName="+this.initInfo.srcMhaName+"&dstMhaName="+this.initInfo.dstMhaName),this.axios.get("/api/drc/v2/config/mha/dbApplier/gtidTruncated?srcMhaName="+this.initInfo.srcMhaName+"&dstMhaName="+this.initInfo.dstMhaName)]).then(function(){var e=Object(c["a"])(Object(s["a"])().mark((function e(a){var n,i,r,c,l;return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=Object(o["a"])(a,2),i=n[0],r=n[1],console.log("res1",i),console.log("res2",r),0===i.data.status&&0===r.data.status){e.next=6;break}return t.$Message.error("查询 mha applier 信息失败"),e.abrupt("return");case 6:c=i.data.data,l=r.data.data,t.tableData.forEach((function(t){t.ips=c,t.gtidInit=l}));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).finally((function(){t.dataLoading=!1}))},preClearAndUpdateMhaGtid:function(){var t=this;function e(t){for(var e=[],a=0,n=Object.entries(t);a<n.length;a++){var i=Object(o["a"])(n[a],2),r=i[0],s=i[1];s&&s.length>0&&e.push({dbName:r,gtidInit:s})}return e}this.dataLoading=!0,Promise.all([this.axios.get("/api/drc/v2/config/mha/dbApplier/gtid?srcMhaName="+this.initInfo.srcMhaName+"&dstMhaName="+this.initInfo.dstMhaName),this.axios.get("/api/drc/v2/config/mha/dbApplier/dbGtid?srcMhaName="+this.initInfo.srcMhaName+"&dstMhaName="+this.initInfo.dstMhaName),this.axios.get("/api/drc/v2/config/mha/dbApplier/dbGtidTruncated?srcMhaName="+this.initInfo.srcMhaName+"&dstMhaName="+this.initInfo.dstMhaName)]).then(function(){var a=Object(c["a"])(Object(s["a"])().mark((function a(n){var i,r,c,l;return Object(s["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(i=Object(o["a"])(n,3),r=i[0],c=i[1],l=i[2],console.log("res1",r),console.log("res2",c),console.log("res3",l),0===r.data.status&&0===c.data.status&&0===l.data.status){a.next=7;break}return t.$Message.error("查询 gtid 信息失败"),a.abrupt("return");case 7:t.gtidCheck.mhaApplied=r.data.data,t.gtidCheck.dbApplied=e(c.data.data),t.gtidCheck.mhaTarget=l.data.data,t.rollbackModal=!0;case 11:case"end":return a.stop()}}),a)})));return function(t){return a.apply(this,arguments)}}()).finally((function(){t.dataLoading=!1}))},clearAndUpdateMhaGtid:function(){var t=this;this.tableData.forEach((function(e){e.ips=t.target.ips,e.gtidInit=t.target.gtid})),this.mhaApplierInitGtid=this.gtidCheck.mhaTarget,this.gtidCheck.mhaTarget&&0!==this.gtidCheck.mhaTarget.length?this.submitDbAppliers():this.$Message.warning("回滚失败，target mha gtid 不存在")},batchUpdateAppliers:function(){var t=this,e=this.$refs.multipleTable.getSelection().map((function(t){return t.dbName}));this.tableData.forEach((function(a){e.includes(a.dbName)&&(a.ips=t.target.ips,t.target.gtid&&(a.gtidInit=t.target.gtid))})),this.$Message.warning("修改成功！共修改"+e.length+"行")},clearDeleteDbReplication:function(t,e){this.deleteData=[],this.batchDeleteModal=!1},deleteDbReplication:function(){var t=this,e=[];this.deleteData.forEach((function(t){return e.push(t.dbReplicationId)})),this.axios.delete("/api/drc/v2/config/dbReplications?dbReplicationIds="+e).then((function(e){1===e.data.status?t.$Message.error("删除失败!"+e.data.message):(t.$Message.success("删除成功!"),t.getDbAppliers(),t.initInfo.multiData=[])}))}},created:function(){var t=this;this.axios.get("/api/drc/v2/permission/meta/mhaReplication/modify").then((function(e){403!==e.data.status?(t.initInfo={srcMhaName:t.$route.query.srcMhaName,srcMhaId:t.$route.query.srcMhaId,dstMhaName:t.$route.query.dstMhaName,applierGroupId:t.$route.query.applierGroupId,srcDc:t.$route.query.srcDc,dstDc:t.$route.query.dstDc,order:t.$route.query.order},console.log("initInfo:"),console.log(t.initInfo),t.getResources(),t.getDbAppliers()):t.$router.push("/nopermission")}))},computed:{dbApplierEmpty:function(){var t,e=this.dbApplierDtos,a=Object(r["a"])(e);try{for(a.s();!(t=a.n()).done;){var n=t.value;if(n.ips&&n.ips.length>0)return!1}}catch(i){a.e(i)}finally{a.f()}return!0},showSelectOptionComponent:function(){return this.tableData.length<=50}}},u=p,h=a("2877"),f=Object(h["a"])(u,n,i,!1,null,"7b72fa93",null);e["default"]=f.exports},"9f7f":function(t,e,a){"use strict";var n=a("d039");function i(t,e){return RegExp(t,e)}e.UNSUPPORTED_Y=n((function(){var t=i("a","y");return t.lastIndex=2,null!=t.exec("abcd")})),e.BROKEN_CARET=n((function(){var t=i("^r","gy");return t.lastIndex=2,null!=t.exec("str")}))},a15b:function(t,e,a){"use strict";var n=a("23e7"),i=a("44ad"),r=a("fc6a"),o=a("a640"),s=[].join,c=i!=Object,l=o("join",",");n({target:"Array",proto:!0,forced:c||!l},{join:function(t){return s.call(r(this),void 0===t?",":t)}})},a630:function(t,e,a){var n=a("23e7"),i=a("4df4"),r=a("1c7e"),o=!r((function(t){Array.from(t)}));n({target:"Array",stat:!0,forced:o},{from:i})},ab13:function(t,e,a){var n=a("b622"),i=n("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(a){try{return e[i]=!1,"/./"[t](e)}catch(n){}}return!1}},ac1f:function(t,e,a){"use strict";var n=a("23e7"),i=a("9263");n({target:"RegExp",proto:!0,forced:/./.exec!==i},{exec:i})},ad6d:function(t,e,a){"use strict";var n=a("825a");t.exports=function(){var t=n(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},b85c:function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));a("a4d3"),a("e01a"),a("d28b"),a("e260"),a("d3b7"),a("3ca3"),a("ddb0");var n=a("06c5");function i(t,e){var a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=Object(n["a"])(t))||e&&t&&"number"==typeof t.length){a&&(t=a);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,c=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return s=t.done,t},e:function(t){c=!0,o=t},f:function(){try{s||null==a["return"]||a["return"]()}finally{if(c)throw o}}}}},d81d:function(t,e,a){"use strict";var n=a("23e7"),i=a("b727").map,r=a("1dde"),o=a("ae40"),s=r("map"),c=o("map");n({target:"Array",proto:!0,forced:!s||!c},{map:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}})}}]);
//# sourceMappingURL=chunk-c916d22c.3e703953.js.map