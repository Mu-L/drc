(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-86be0028"],{4895:function(e,t,a){(function(e){e(a("56b3"))})((function(e){"use strict";function t(t,r,o,i){if(o&&o.call){var s=o;o=null}else s=n(t,o,"rangeFinder");"number"==typeof r&&(r=e.Pos(r,0));var l=n(t,o,"minFoldSize");function c(e){var a=s(t,r);if(!a||a.to.line-a.from.line<l)return null;if("fold"===i)return a;for(var n=t.findMarksAt(a.from),o=0;o<n.length;++o)if(n[o].__isFold){if(!e)return null;a.cleared=!0,n[o].clear()}return a}var p=c(!0);if(n(t,o,"scanUp"))while(!p&&r.line>t.firstLine())r=e.Pos(r.line-1,0),p=c(!1);if(p&&!p.cleared&&"unfold"!==i){var u=a(t,o,p);e.on(u,"mousedown",(function(t){d.clear(),e.e_preventDefault(t)}));var d=t.markText(p.from,p.to,{replacedWith:u,clearOnEnter:n(t,o,"clearOnEnter"),__isFold:!0});d.on("clear",(function(a,r){e.signal(t,"unfold",t,a,r)})),e.signal(t,"fold",t,p.from,p.to)}}function a(e,t,a){var r=n(e,t,"widget");if("function"==typeof r&&(r=r(a.from,a.to)),"string"==typeof r){var o=document.createTextNode(r);r=document.createElement("span"),r.appendChild(o),r.className="CodeMirror-foldmarker"}else r&&(r=r.cloneNode(!0));return r}e.newFoldFunction=function(e,a){return function(r,n){t(r,n,{rangeFinder:e,widget:a})}},e.defineExtension("foldCode",(function(e,a,r){t(this,e,a,r)})),e.defineExtension("isFolded",(function(e){for(var t=this.findMarksAt(e),a=0;a<t.length;++a)if(t[a].__isFold)return!0})),e.commands.toggleFold=function(e){e.foldCode(e.getCursor())},e.commands.fold=function(e){e.foldCode(e.getCursor(),null,"fold")},e.commands.unfold=function(e){e.foldCode(e.getCursor(),{scanUp:!1},"unfold")},e.commands.foldAll=function(t){t.operation((function(){for(var a=t.firstLine(),r=t.lastLine();a<=r;a++)t.foldCode(e.Pos(a,0),{scanUp:!1},"fold")}))},e.commands.unfoldAll=function(t){t.operation((function(){for(var a=t.firstLine(),r=t.lastLine();a<=r;a++)t.foldCode(e.Pos(a,0),{scanUp:!1},"unfold")}))},e.registerHelper("fold","combine",(function(){var e=Array.prototype.slice.call(arguments,0);return function(t,a){for(var r=0;r<e.length;++r){var n=e[r](t,a);if(n)return n}}})),e.registerHelper("fold","auto",(function(e,t){for(var a=e.getHelpers(t,"fold"),r=0;r<a.length;r++){var n=a[r](e,t);if(n)return n}}));var r={rangeFinder:e.fold.auto,widget:"↔",minFoldSize:0,scanUp:!1,clearOnEnter:!0};function n(e,t,a){if(t&&void 0!==t[a])return t[a];var n=e.options.foldOptions;return n&&void 0!==n[a]?n[a]:r[a]}e.defineOption("foldOptions",null),e.defineExtension("foldOption",(function(e,t){return n(this,e,t)}))}))},"53ca":function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));a("a4d3"),a("e01a"),a("d28b"),a("d3b7"),a("3ca3"),a("ddb0");function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}},"697e":function(e,t,a){},"7a7a":function(e,t,a){},"7c8d":function(e,t,a){},"99af":function(e,t,a){"use strict";var r=a("23e7"),n=a("d039"),o=a("e8b5"),i=a("861d"),s=a("7b0b"),l=a("07fa"),c=a("3511"),p=a("8418"),u=a("65f0"),d=a("1dde"),f=a("b622"),g=a("1212"),m=f("isConcatSpreadable"),h=g>=51||!n((function(){var e=[];return e[m]=!1,e.concat()[0]!==e})),v=function(e){if(!i(e))return!1;var t=e[m];return void 0!==t?!!t:o(e)},I=!h||!d("concat");r({target:"Array",proto:!0,arity:1,forced:I},{concat:function(e){var t,a,r,n,o,i=s(this),d=u(i,0),f=0;for(t=-1,r=arguments.length;t<r;t++)if(o=-1===t?i:arguments[t],v(o))for(n=l(o),c(f+n),a=0;a<n;a++,f++)a in o&&p(d,f,o[a]);else c(f+1),p(d,f++,o);return d.length=f,d}})},"9a28":function(e,t,a){"use strict";a.r(t);a("14d9"),a("b0c0");var r=function(){var e=this,t=e._self._c;return t("base-component",[t("Breadcrumb",{style:{margin:"15px 0 15px 185px",position:"fixed"}},[t("BreadcrumbItem",{attrs:{to:"/home"}},[e._v("首页")])],1),t("Content",{staticClass:"content",style:{padding:"10px",background:"#fff",margin:"50px 0 1px 185px",zIndex:"1"}},[t("div",{staticStyle:{padding:"1px 1px"}},[t("Row",{attrs:{gutter:10,align:"middle"}},[t("Col",{attrs:{span:"16"}},[t("Card",{attrs:{padding:5},scopedSlots:e._u([{key:"title",fn:function(){return[e._v("查询条件")]},proxy:!0}])},[t("Row",{attrs:{gutter:10}},[t("Col",{attrs:{span:"8"}},[t("Input",{attrs:{prefix:"ios-search",placeholder:"ip"},on:{"on-enter":e.getResources},model:{value:e.queryParam.ip,callback:function(t){e.$set(e.queryParam,"ip",t)},expression:"queryParam.ip"}})],1),t("Col",{attrs:{span:"4"}},[t("Select",{attrs:{filterable:"",clearable:"",placeholder:"类型"},on:{"on-change":e.getResources},model:{value:e.queryParam.type,callback:function(t){e.$set(e.queryParam,"type",t)},expression:"queryParam.type"}},e._l(e.typeList,(function(a){return t("Option",{key:a.val,attrs:{value:a.val}},[e._v(e._s(a.name))])})),1)],1),t("Col",{attrs:{span:"4"}},[t("Select",{attrs:{filterable:"",clearable:"",placeholder:"地域"},on:{"on-change":e.getResources},model:{value:e.queryParam.region,callback:function(t){e.$set(e.queryParam,"region",t)},expression:"queryParam.region"}},e._l(e.regions,(function(a){return t("Option",{key:a.regionName,attrs:{value:a.regionName}},[e._v(" "+e._s(a.regionName)+" ")])})),1)],1),t("Col",{attrs:{span:"4"}},[t("Select",{attrs:{filterable:"",clearable:"","allow-create":"",placeholder:"tag"},on:{"on-change":e.getResources,"on-create":e.handleAddTag},model:{value:e.queryParam.tag,callback:function(t){e.$set(e.queryParam,"tag",t)},expression:"queryParam.tag"}},e._l(e.tagList,(function(a){return t("Option",{key:a,attrs:{value:a}},[e._v(e._s(a))])})),1)],1),t("Col",{attrs:{span:"4"}},[t("Select",{attrs:{filterable:"",clearable:"",placeholder:"启用状态"},on:{"on-change":e.getResources},model:{value:e.queryParam.active,callback:function(t){e.$set(e.queryParam,"active",t)},expression:"queryParam.active"}},e._l(e.activeList,(function(a){return t("Option",{key:a.val,attrs:{value:a.val}},[e._v(e._s(a.name))])})),1)],1)],1)],1)],1),t("Col",{attrs:{span:"1"}},[t("Button",{attrs:{type:"primary",icon:"ios-search",loading:e.dataLoading},on:{click:e.getResources}},[e._v("查询")]),t("Button",{staticStyle:{"margin-top":"20px"},attrs:{icon:"md-refresh",loading:e.dataLoading},on:{click:e.resetParam}},[e._v("重置")])],1)],1),t("br"),t("Row",{staticStyle:{background:"#fdfdff",border:"1px solid #e8eaec"}},[t("Col",{staticStyle:{display:"flex",float:"left",margin:"5px"},attrs:{span:"2"}},[t("Dropdown",{attrs:{placement:"bottom-start"},scopedSlots:e._u([{key:"list",fn:function(){return[t("DropdownMenu",[t("DropdownItem",{nativeOn:{click:function(t){return function(){e.$router.push({path:"/drcResource"})}.apply(null,arguments)}}},[e._v("资源录入")])],1)]},proxy:!0}])},[t("Button",{attrs:{type:"default",icon:"ios-hammer"}},[e._v(" 操作 "),t("Icon",{attrs:{type:"ios-arrow-down"}})],1)],1)],1)],1),t("Table",{attrs:{stripe:"",border:"",columns:e.columns,data:e.resources},scopedSlots:e._u([{key:"action",fn:function(a){var r=a.row,n=a.index;return[t("Dropdown",{attrs:{transfer:!0,placement:"bottom-start"},scopedSlots:e._u([{key:"list",fn:function(){return[t("DropdownMenu",[t("DropdownItem",[t("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"success",size:"small"},on:{click:function(t){return e.showMigrateInfo(r,n)}}},[e._v(" 实例迁移 ")])],1),t("DropdownItem",[t("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"error",size:"small"},on:{click:function(t){return e.preDeleteResource(r,n)}}},[e._v(" 下线 ")])],1)],1)]},proxy:!0}],null,!0)},[t("Button",{attrs:{type:"default",icon:"ios-hammer"}},[e._v(" 操作 "),t("Icon",{attrs:{type:"ios-arrow-down"}})],1)],1)]}}])}),t("div",{staticStyle:{"text-align":"center",margin:"16px 0"}},[t("Page",{attrs:{transfer:!0,total:e.total,current:e.current,"page-size-opts":[10,20,50,100],"page-size":10,"show-total":"","show-sizer":"","show-elevator":""},on:{"update:current":function(t){e.current=t},"on-change":e.getResources,"on-page-size-change":e.handleChangeSize}})],1),t("Modal",{attrs:{title:"确认删除以下机器资源"},on:{"on-ok":e.deleteResource,"on-cancel":e.clearDeleteResource},model:{value:e.deleteResourceModal,callback:function(t){e.deleteResourceModal=t},expression:"deleteResourceModal"}},[t("p",[e._v('ip: "'+e._s(e.deleteResourceInfo.ip)+'" ,tag: "'+e._s(e.deleteResourceInfo.tag)+'" az: "'+e._s(e.deleteResourceInfo.az)+'"')]),t("p",[t("span",[e._v("部署实例数量: ")]),t("span",{staticStyle:{color:"red","font-size":"20px"}},[e._v(e._s(e.deleteResourceInfo.instanceNum))])])]),t("Modal",{attrs:{title:1===e.migrateApplierInfo.oldIpInfo.type?"applier实例迁移":"messenger实例迁移","footer-hide":!0,width:"900px",scrollable:!0,draggable:!0},model:{value:e.migrateApplierInfo.modal,callback:function(t){e.$set(e.migrateApplierInfo,"modal",t)},expression:"migrateApplierInfo.modal"}},[t("Row",{attrs:{gutter:10}},[t("Col",{attrs:{span:"4"}},[t("span",[e._v("当前ip: ")]),t("span",{staticStyle:{color:"red","font-size":"15px"}},[e._v(e._s(e.migrateApplierInfo.oldIpInfo.ip))])]),t("Col",{attrs:{span:"4"}},[t("span",[e._v("  tag: ")]),t("span",{staticStyle:{color:"red","font-size":"15px"}},[e._v(e._s(e.migrateApplierInfo.oldIpInfo.tag))])]),t("Col",{attrs:{span:"4"}},[t("span",[e._v("  AZ: ")]),t("span",{staticStyle:{color:"red","font-size":"15px"}},[e._v(e._s(e.migrateApplierInfo.oldIpInfo.az))])])],1),t("Form",[t("FormItem",{attrs:{label:"选择目标ip"}},[t("Select",{staticStyle:{width:"400px"},attrs:{filterable:"",clearable:"",placeholder:"目标ip"},model:{value:e.migrateApplierInfo.newIp,callback:function(t){e.$set(e.migrateApplierInfo,"newIp",t)},expression:"migrateApplierInfo.newIp"}},e._l(e.migrateApplierInfo.ipChooseList,(function(a){return t("Option",{key:a,attrs:{value:a}},[e._v(" "+e._s(a)+" ")])})),1),t("Button",{staticStyle:{"margin-left":"100px"},attrs:{type:"primary",loading:e.migrateApplierInfo.loading2},on:{click:e.migrateAllApplierOrMessenger}},[e._v("全部实例迁移")])],1),t("FormItem",[t("Table",{ref:"multipleTable",attrs:{stripe:"",border:"",columns:e.migrateApplierInfo.columns,data:e.aDataWithPage},on:{"on-selection-change":e.changeSelectionA}}),t("div",[t("Page",{attrs:{transfer:!0,total:e.migrateApplierInfo.tableData.length,current:e.migrateApplierInfo.current,"page-size-opts":e.migrateApplierInfo.pageSizeOpts,"page-size":this.migrateApplierInfo.size,"show-total":"","show-sizer":"","show-elevator":""},on:{"update:current":function(t){return e.$set(e.migrateApplierInfo,"current",t)},"on-page-size-change":e.aHandleChangeSize}})],1)],1),t("FormItem",[t("Button",{attrs:{type:"primary",loading:e.migrateApplierInfo.loading},on:{click:e.migrateApplierOrMessenger}},[e._v("迁移")]),t("Button",{staticStyle:{"margin-left":"100px"},attrs:{type:"success"},on:{click:e.refreshMigrateApplier}},[e._v("刷新")])],1)],1)],1),t("Modal",{attrs:{title:"replicator实例迁移","footer-hide":!0,width:"900px",scrollable:!0,draggable:!0},model:{value:e.migrateReplicatorInfo.modal,callback:function(t){e.$set(e.migrateReplicatorInfo,"modal",t)},expression:"migrateReplicatorInfo.modal"}},[t("Row",{attrs:{gutter:10}},[t("Col",{attrs:{span:"4"}},[t("span",[e._v("当前ip: ")]),t("span",{staticStyle:{color:"red","font-size":"15px"}},[e._v(e._s(e.migrateReplicatorInfo.oldIpInfo.ip))])]),t("Col",{attrs:{span:"4"}},[t("span",[e._v("  tag: ")]),t("span",{staticStyle:{color:"red","font-size":"15px"}},[e._v(e._s(e.migrateReplicatorInfo.oldIpInfo.tag))])]),t("Col",{attrs:{span:"4"}},[t("span",[e._v("  AZ: ")]),t("span",{staticStyle:{color:"red","font-size":"15px"}},[e._v(e._s(e.migrateReplicatorInfo.oldIpInfo.az))])])],1),t("Form",[t("FormItem",{attrs:{label:"选择目标ip"}},[t("Select",{staticStyle:{width:"400px"},attrs:{filterable:"",clearable:"",placeholder:"目标ip"},model:{value:e.migrateReplicatorInfo.newIp,callback:function(t){e.$set(e.migrateReplicatorInfo,"newIp",t)},expression:"migrateReplicatorInfo.newIp"}},e._l(e.migrateReplicatorInfo.ipChooseList,(function(a){return t("Option",{key:a,attrs:{value:a}},[e._v(" "+e._s(a)+" ")])})),1)],1),t("FormItem",[t("Table",{ref:"multipleTable",attrs:{stripe:"",border:"",columns:e.migrateReplicatorInfo.columns,data:e.rDataWithPage},on:{"on-selection-change":e.changeSelectionR}}),t("div",[t("Page",{attrs:{transfer:!0,total:e.migrateReplicatorInfo.tableData.length,current:e.migrateReplicatorInfo.current,"page-size-opts":e.migrateReplicatorInfo.pageSizeOpts,"page-size":this.migrateReplicatorInfo.size,"show-total":"","show-sizer":"","show-elevator":""},on:{"update:current":function(t){return e.$set(e.migrateReplicatorInfo,"current",t)},"on-page-size-change":e.rHandleChangeSize}})],1)],1),t("FormItem",[t("Button",{attrs:{type:"primary",loading:e.migrateReplicatorInfo.loading},on:{click:e.migrateReplicator}},[e._v("迁移")]),t("Button",{staticStyle:{"margin-left":"100px"},attrs:{type:"success"},on:{click:e.refreshMigrateReplicator}},[e._v("刷新")])],1)],1)],1),t("Modal",{attrs:{title:"关联mha",width:"900px",scrollable:!0,draggable:!0},model:{value:e.relatedMhaData.modal,callback:function(t){e.$set(e.relatedMhaData,"modal",t)},expression:"relatedMhaData.modal"}},[t("Table",{attrs:{stripe:"",border:"",columns:e.relatedMhaData.columns,data:e.relatedMhaData.tableData}})],1),t("Modal",{attrs:{title:"关联复制链路",width:"900px",scrollable:!0,draggable:!0},model:{value:e.relatedReplicationData.modal,callback:function(t){e.$set(e.relatedReplicationData,"modal",t)},expression:"relatedReplicationData.modal"}},[t("Table",{attrs:{stripe:"",border:"",columns:e.relatedReplicationData.columns,data:e.relatedReplicationData.tableData}})],1)],1)])],1)},n=[],o=a("53ca"),i=a("2909"),s=(a("99af"),a("fb6a"),a("d3b7"),a("159b"),a("fcc1"),a("7a7a"),a("d5e0"),a("697e"),a("cbc8"),{name:"resourceV2",data:function(){var e=this;return{columns:[{title:"类型",key:"type",width:80,render:function(t,a){var r=a.row,n="none",o="error",i=!1;switch(r.type){case 0:n="R",o="info";break;case 1:n="A",o="success";break;case 7:n="M",o="warning";break;default:n="无",i=!0;break}return t("Button",{props:{type:o,size:"small",disabled:i},on:{click:function(){e.showModal(r)}}},n)}},{title:"ip",key:"ip"},{title:"tag",key:"tag"},{title:"AZ",key:"az",sortable:!0},{title:"部署实例数量",key:"instanceNum",sortable:!0},{title:"启用状态",key:"active",sortable:!0,align:"center",render:function(t,a){var r=a.row;return t("i-switch",{props:{size:"large",value:1===r.active,beforeChange:e.handleBeforeChange},scopedSlots:{open:function(){return t("span","开启")},close:function(){return t("span","关闭")}},on:{"on-change":function(){e.switchActiveStatus(r.resourceId,r.active)}}})}},{title:"操作",slot:"action",align:"center"}],total:0,current:1,size:10,resources:[],typeList:[{name:"Replicator",val:0},{name:"Applier",val:1},{name:"Messenger",val:7}],activeList:[{name:"启用",val:1},{name:"停用",val:0}],regions:[],tagList:this.constant.tagList,deleteResourceModal:!1,relatedReplicationData:{tableData:[],modal:!1,columns:[{title:"序号",width:75,align:"center",render:function(e,t){return e("span",t.index+1)}},{title:"类型",key:"type",width:200,render:function(t,a){var r=a.row,n="none",o="error",i=!1;switch(r.type){case 1:n="Applier",o="info";break;case 2:n="DbApplier",o="success";break;case 3:n="Messenger",o="warning";break;case 4:n="DbMessenger",o="primary";break;default:n="无",i=!0;break}return n="".concat(n," (").concat(r.mqType,")"),t("Button",{props:{type:o,size:"small",disabled:i},on:{click:function(){e.showModal(r)}}},n)}},{title:"同步链路",key:"relatedId",render:function(t,a){var r=a.row,n=r.type,o="";return 1===n?o=r.srcMhaName+"("+r.srcDcName+") => "+r.dstMhaName+"("+r.dstDcName+")":2===n?o=r.srcMhaName+"("+r.srcDcName+") => "+r.dstMhaName+"("+r.dstDcName+") db: "+r.dbName:3===n?o=r.srcMhaName+"("+r.srcDcName+")":4===n&&(o=r.srcMhaName+"("+r.srcDcName+") db: "+r.dbName),t("a",{props:{type:"info",size:"small",disabled:!1},on:{click:function(){1===n?e.toMhaReplication(r):2===n?e.toMhaDbReplication(r):3===n&&e.toMessenger(r)}}},o)}}]},relatedMhaData:{tableData:[],modal:!1,columns:[{title:"序号",width:75,align:"center",render:function(e,t){return e("span",t.index+1)}},{title:"mha",key:"mhaName",render:function(t,a){var r=a.row,n=r.mhaName;return t("a",{props:{type:"info",size:"small",disabled:!1},on:{click:function(){e.toMhaReplicationByR(r)}}},n)}}]},migrateApplierInfo:{loading:!1,loading2:!1,modal:!1,newIp:"",ipChooseList:[],oldIpInfo:{ip:"",tag:"",az:"",resourceId:null,type:null},migrateDataList:[],tableData:[],columns:[{type:"selection",width:60,align:"center"},{title:"序号",width:75,align:"center",render:function(e,t){return e("span",t.index+1)}},{title:"类型",key:"type",width:200,render:function(t,a){var r=a.row,n="none",o="error",i=!1;switch(r.type){case 1:n="Applier",o="info";break;case 2:n="DbApplier",o="success";break;case 3:n="Messenger (".concat(r.mqType,")"),o="warning";break;case 4:n="DbMessenger",o="primary";break;default:n="无",i=!0;break}return t("Button",{props:{type:o,size:"small",disabled:i},on:{click:function(){e.showModal(r)}}},n)}},{title:"同步链路",key:"relatedId",render:function(t,a){var r=a.row,n=r.type,o="";return 1===n?o=r.srcMhaName+"("+r.srcDcName+") => "+r.dstMhaName+"("+r.dstDcName+")":2===n?o=r.srcMhaName+"("+r.srcDcName+") => "+r.dstMhaName+"("+r.dstDcName+") db: "+r.dbName:3===n?o=r.srcMhaName+"("+r.srcDcName+")":4===n&&(o=r.srcMhaName+"("+r.srcDcName+") db: "+r.dbName),t("a",{props:{type:"info",size:"small",disabled:!1},on:{click:function(){1===n?e.toMhaReplication(r):2===n?e.toMhaDbReplication(r):3===n&&e.toMessenger(r)}}},o)}}],total:0,current:1,size:10,pageSizeOpts:[10,20,50,100]},migrateReplicatorInfo:{loading:!1,modal:!1,newIp:"",ipChooseList:[],oldIpInfo:{ip:"",tag:"",az:"",resourceId:null},migrateMhaList:[],tableData:[],columns:[{type:"selection",width:60,align:"center"},{title:"序号",width:75,align:"center",render:function(e,t){return e("span",t.index+1)}},{title:"mha",key:"mhaName",render:function(t,a){var r=a.row,n=r.mhaName;return t("a",{props:{type:"info",size:"small",disabled:!1},on:{click:function(){e.toMhaReplicationByR(r)}}},n)}}],total:0,current:1,size:10,pageSizeOpts:[10,20,50,100]},deleteResourceInfo:{resourceId:null,ip:"",tag:"",az:"",instanceNum:0},queryParam:{ip:"",type:null,tag:"",active:null,region:"",pageReq:{pageSize:10,pageIndex:1}},replicationDetail:{show:!1,data:null,darkMode:!0,lineWrap:!1,row:{}},dataLoading:!0}},computed:{rDataWithPage:function(){var e=this.migrateReplicatorInfo.tableData,t=this.migrateReplicatorInfo.current*this.migrateReplicatorInfo.size-this.migrateReplicatorInfo.size,a=t+this.migrateReplicatorInfo.size;return Object(i["a"])(e).slice(t,a)},aDataWithPage:function(){var e=this.migrateApplierInfo.tableData,t=this.migrateApplierInfo.current*this.migrateApplierInfo.size-this.migrateApplierInfo.size,a=t+this.migrateApplierInfo.size;return Object(i["a"])(e).slice(t,a)}},methods:{aHandleChangeSize:function(e){this.migrateApplierInfo.size=e},changeSelectionA:function(e){this.migrateApplierInfo.migrateDataList=e,console.log(this.migrateApplierInfo.migrateDataList)},rHandleChangeSize:function(e){this.migrateReplicatorInfo.size=e},changeSelectionR:function(e){this.migrateReplicatorInfo.migrateMhaList=e,console.log(this.migrateReplicatorInfo.migrateMhaList)},migrateAllApplierOrMessenger:function(){var e=this,t=this.migrateApplierInfo.newIp;if(null!==t&&""!==t){var a=this.migrateApplierInfo.tableData;if(0!==a.length){var r=this.migrateApplierInfo.oldIpInfo.ip;this.migrateApplierInfo.loading2=!0;var n=this.migrateApplierInfo.oldIpInfo.type;1===n?this.axios.post("/api/drc/v2/resource/migrate/applier?newIp="+t+"&oldIp="+r).then((function(t){0===t.data.status?(e.migrateApplierInfo.tableData=t.data.data,e.$Message.success("共迁移"+t.data.data+"个实例")):e.$Message.error("迁移失败"+t.data.message)})):7===n&&this.axios.post("/api/drc/v2/resource/migrate/messenger?newIp="+t+"&oldIp="+r).then((function(t){0===t.data.status?(e.migrateApplierInfo.tableData=t.data.data,e.$Message.success("共迁移"+t.data.data+"个实例")):e.$Message.error("迁移失败"+t.data.message)})),this.migrateApplierInfo.loading2=!1}else this.$Message.warning("没有相关实例")}else this.$Message.warning("请选择目标ip")},migrateApplierOrMessenger:function(){var e=this,t=this.migrateApplierInfo.migrateDataList;if(void 0!==t&&null!==t&&0!==t.length){var a=this.migrateApplierInfo.newIp;if(null!==a&&""!==a){var r=[];t.forEach((function(e){var t={relatedId:e.relatedId,type:e.type};r.push(t)}));var n={oldIp:this.migrateApplierInfo.oldIpInfo.ip,newIp:this.migrateApplierInfo.newIp,applierResourceDtos:r};this.migrateApplierInfo.loading=!0,1===this.migrateApplierInfo.oldIpInfo.type?this.axios.post("/api/drc/v2/resource/partialMigrate/applier",n).then((function(t){0===t.data.status?(e.migrateApplierInfo.tableData=t.data.data,e.$Message.success("共迁移"+t.data.data+"个实例")):e.$Message.error("迁移失败"+t.data.message)})):this.axios.post("/api/drc/v2/resource/partialMigrate/messenger",n).then((function(t){0===t.data.status?(e.migrateApplierInfo.tableData=t.data.data,e.$Message.success("共迁移"+t.data.data+"个实例")):e.$Message.error("迁移失败"+t.data.message)})),this.migrateApplierInfo.loading=!1}else this.$Message.warning("请选择目标ip")}else this.$Message.warning("请勾选！")},migrateReplicator:function(){var e=this,t=this.migrateReplicatorInfo.migrateMhaList;if(void 0!==t&&null!==t&&0!==t.length){var a=this.migrateReplicatorInfo.newIp;if(null!==a&&""!==a){var r=[];t.forEach((function(e){return r.push(e.mhaName)}));var n={oldIp:this.migrateReplicatorInfo.oldIpInfo.ip,newIp:this.migrateReplicatorInfo.newIp,mhaList:r};this.migrateReplicatorInfo.loading=!0,this.axios.post("/api/drc/v2/resource/partialMigrate/replicator",n).then((function(t){0===t.data.status?e.$Message.success("共迁移"+t.data.data+"个实例"):e.$Message.error("迁移失败"+t.data.message)})),this.migrateReplicatorInfo.loading=!1}else this.$Message.warning("请选择目标ip")}else this.$Message.warning("请勾选！")},refreshMigrateApplier:function(){var e=this;this.migrateApplierInfo.current=1;var t=this.migrateApplierInfo.oldIpInfo.resourceId;this.axios.get("/api/drc/v2/resource/mhaReplication?resourceId="+t).then((function(t){0===t.data.status?(e.migrateApplierInfo.tableData=t.data.data,console.log(e.migrateApplierInfo.tableData),e.$forceUpdate()):e.$Message.warning("查询异常")}))},refreshMigrateReplicator:function(){var e=this;this.migrateReplicatorInfo.current=1;var t=this.migrateReplicatorInfo.oldIpInfo.resourceId;this.axios.get("/api/drc/v2/resource/mha?resourceId="+t).then((function(t){0===t.data.status?(e.migrateReplicatorInfo.tableData=t.data.data,console.log(e.migrateReplicatorInfo.tableData),e.$forceUpdate()):e.$Message.warning("查询异常")}))},showMigrateInfo:function(e){0===e.type?this.showMigrateReplicator(e):(1===e.type||7===e.type)&&this.showMigrateApplier(e)},showMigrateApplier:function(e){var t=this;this.migrateApplierInfo.oldIpInfo={ip:e.ip,tag:e.tag,az:e.az,resourceId:e.resourceId,type:e.type},this.axios.get("/api/drc/v2/resource/mhaReplication?resourceId="+e.resourceId).then((function(e){0===e.data.status?t.migrateApplierInfo.tableData=e.data.data:t.$Message.warning("查询异常")})),this.axios.get("/api/drc/v2/resource/list?ip="+e.ip).then((function(e){t.migrateApplierInfo.ipChooseList=[],e.data.data.forEach((function(e){return t.migrateApplierInfo.ipChooseList.push(e.ip)})),console.log(t.migrateApplierInfo.ipChooseList)})),this.migrateApplierInfo.modal=!0},showMigrateReplicator:function(e){var t=this;this.migrateReplicatorInfo.oldIpInfo={ip:e.ip,tag:e.tag,az:e.az,resourceId:e.resourceId},this.axios.get("/api/drc/v2/resource/mha?resourceId="+e.resourceId).then((function(e){0===e.data.status?t.migrateReplicatorInfo.tableData=e.data.data:t.$Message.warning("查询异常")})),this.axios.get("/api/drc/v2/resource/list?ip="+e.ip).then((function(e){t.migrateReplicatorInfo.ipChooseList=[],e.data.data.forEach((function(e){return t.migrateReplicatorInfo.ipChooseList.push(e.ip)})),console.log(t.migrateReplicatorInfo.ipChooseList)})),this.migrateReplicatorInfo.modal=!0},toMessenger:function(e){var t=this.$router.resolve({path:"/v2/messengersV2",query:{mhaName:e.srcMhaName,mqType:e.mqType}});window.open(t.href,"_blank")},toDbMessenger:function(e){},toMhaReplication:function(e){var t=this.$router.resolve({path:"/v2/mhaReplications",query:{srcMhaName:e.srcMhaName,dstMhaName:e.dstMhaName,preciseSearchMode:!0}});window.open(t.href,"_blank")},toMhaDbReplication:function(e){var t=this.$router.resolve({path:"/v2/mhaDbReplications",query:{srcMhaName:e.srcMhaName,dstMhaName:e.dstMhaName,preciseSearchMode:!0,relatedDbName:e.dbName}});window.open(t.href,"_blank")},toMhaReplicationByR:function(e){var t=this.$router.resolve({path:"/v2/mhaReplications",query:{mhaName:e.mhaName,preciseSearchMode:!1}});window.open(t.href,"_blank")},showModal:function(e){0===e.type?this.getRelatedMha(e):(1===e.type||7===e.type)&&this.getRelatedMhaReplication(e)},getRegions:function(){var e=this;this.axios.get("/api/drc/v2/meta/regions/all").then((function(t){e.regions=t.data.data}))},resetParam:function(){this.queryParam={ip:"",type:null,tag:"",active:null,region:"",pageReq:{pageSize:10,pageIndex:1}},this.getResources()},getRelatedMha:function(e){var t=this;this.axios.get("/api/drc/v2/resource/mha?resourceId="+e.resourceId).then((function(e){0===e.data.status?t.relatedMhaData.tableData=e.data.data:(t.$Message.warning("查询异常"),t.relatedMhaData.tableData=[])})),this.relatedMhaData.modal=!0},getRelatedMhaReplication:function(e){var t=this;this.relatedReplicationData.tableData=[],this.axios.get("/api/drc/v2/resource/mhaReplication?resourceId="+e.resourceId).then((function(e){0===e.data.status?t.relatedReplicationData.tableData=e.data.data:(t.$Message.warning("查询异常"),t.relatedReplicationData.tableData=[])})),this.relatedReplicationData.modal=!0},getResources:function(){var e=this,t={ip:this.queryParam.ip,type:this.queryParam.type,tag:this.queryParam.tag,active:this.queryParam.active,region:this.queryParam.region,pageReq:{pageSize:this.size,pageIndex:this.current}},a=this.flattenObj(t);e.dataLoading=!0,e.axios.get("/api/drc/v2/resource/all",{params:a}).then((function(t){console.log("/api/drc/v2/resource/all response:"+t);var a=t.data,r=t.data.pageReq;1===a.status?e.$Message.error("查询异常: "+a.message):0===a.data.length||0===r.totalCount?(e.total=0,e.current=1,e.resources=[],e.$Message.warning("查询结果为空")):(e.total=r.totalCount,e.current=r.pageIndex,e.resources=a.data,e.$Message.success("查询成功"))})).catch((function(t){e.$Message.error("查询异常: "+t)})).finally((function(){e.dataLoading=!1}))},handleAddTag:function(e){this.constant.tagList.push(e)},handleChangeSize:function(e){var t=this;this.size=e,this.$nextTick((function(){t.getResources()}))},handleBeforeChange:function(){var e=this;return console.log("handleBeforeChange:",this.switchOneInfo),new Promise((function(t){e.$Modal.confirm({title:"切换确认",content:"您确认要切换开关状态吗？",onOk:function(){t()}})}))},preDeleteResource:function(e,t){this.deleteResourceInfo={resourceId:e.resourceId,ip:e.ip,tag:e.tag,az:e.az,instanceNum:e.instanceNum},this.deleteResourceModal=!0},clearDeleteResource:function(){this.deleteResourceInfo={resourceId:null,ip:"",tag:"",az:"",instanceNum:0}},deleteResource:function(e,t){var a=this;this.axios.delete("/api/drc/v2/resource/?resourceId="+this.deleteResourceInfo.resourceId).then((function(e){0===e.data.status?(a.$Message.success("删除成功"),a.getResources()):a.$Message.warning("下线失败 "+e.data.message)}))},switchActiveStatus:function(e,t){0===t?this.activeResource(e):this.deactivateResource(e)},deactivateResource:function(e){var t=this;this.axios.post("/api/drc/v2/resource/deactivate?resourceId="+e).then((function(e){0===e.data.status?t.$Message.success("已停用"):t.$Message.warning("停用失败"),t.getResources()}))},activeResource:function(e){var t=this;this.axios.post("/api/drc/v2/resource/active?resourceId="+e).then((function(e){0===e.data.status?t.$Message.success("已启用"):t.$Message.warning("启用失败"),t.getResources()}))},flattenObj:function(e){var t={};for(var a in e)if("object"!==Object(o["a"])(e[a])||Array.isArray(e[a]))t[a]=e[a];else{var r=this.flattenObj(e[a]);for(var n in r)t[a+"."+n]=r[n]}return t}},created:function(){var e=this;this.axios.get("/api/drc/v2/permission/resource/machine").then((function(t){403!==t.data.status?(console.log("still execute"),e.getResources(),e.getRegions()):e.$router.push("/nopermission")}))}}),l=s,c=(a("bef3"),a("2877")),p=Object(c["a"])(l,r,n,!1,null,"f1237e22",null);t["default"]=p.exports},bef3:function(e,t,a){"use strict";a("7c8d")},cbc8:function(e,t,a){(function(e){e(a("56b3"),a("4895"))})((function(e){"use strict";e.defineOption("foldGutter",!1,(function(t,n,o){o&&o!=e.Init&&(t.clearGutter(t.state.foldGutter.options.gutter),t.state.foldGutter=null,t.off("gutterClick",c),t.off("changes",u),t.off("viewportChange",d),t.off("fold",f),t.off("unfold",f),t.off("swapDoc",u),t.off("optionChange",p)),n&&(t.state.foldGutter=new a(r(n)),l(t),t.on("gutterClick",c),t.on("changes",u),t.on("viewportChange",d),t.on("fold",f),t.on("unfold",f),t.on("swapDoc",u),t.on("optionChange",p))}));var t=e.Pos;function a(e){this.options=e,this.from=this.to=0}function r(e){return!0===e&&(e={}),null==e.gutter&&(e.gutter="CodeMirror-foldgutter"),null==e.indicatorOpen&&(e.indicatorOpen="CodeMirror-foldgutter-open"),null==e.indicatorFolded&&(e.indicatorFolded="CodeMirror-foldgutter-folded"),e}function n(e,a){for(var r=e.findMarks(t(a,0),t(a+1,0)),n=0;n<r.length;++n)if(r[n].__isFold){var o=r[n].find(-1);if(o&&o.line===a)return r[n]}}function o(e){if("string"==typeof e){var t=document.createElement("div");return t.className=e+" CodeMirror-guttermarker-subtle",t}return e.cloneNode(!0)}function i(e,a,r){var i=e.state.foldGutter.options,l=a-1,c=e.foldOption(i,"minFoldSize"),p=e.foldOption(i,"rangeFinder"),u="string"==typeof i.indicatorFolded&&s(i.indicatorFolded),d="string"==typeof i.indicatorOpen&&s(i.indicatorOpen);e.eachLine(a,r,(function(a){++l;var r=null,s=a.gutterMarkers;if(s&&(s=s[i.gutter]),n(e,l)){if(u&&s&&u.test(s.className))return;r=o(i.indicatorFolded)}else{var f=t(l,0),g=p&&p(e,f);if(g&&g.to.line-g.from.line>=c){if(d&&s&&d.test(s.className))return;r=o(i.indicatorOpen)}}(r||s)&&e.setGutterMarker(a,i.gutter,r)}))}function s(e){return new RegExp("(^|\\s)"+e+"(?:$|\\s)\\s*")}function l(e){var t=e.getViewport(),a=e.state.foldGutter;a&&(e.operation((function(){i(e,t.from,t.to)})),a.from=t.from,a.to=t.to)}function c(e,a,r){var o=e.state.foldGutter;if(o){var i=o.options;if(r==i.gutter){var s=n(e,a);s?s.clear():e.foldCode(t(a,0),i)}}}function p(e,t){"mode"==t&&u(e)}function u(e){var t=e.state.foldGutter;if(t){var a=t.options;t.from=t.to=0,clearTimeout(t.changeUpdate),t.changeUpdate=setTimeout((function(){l(e)}),a.foldOnChangeTimeSpan||600)}}function d(e){var t=e.state.foldGutter;if(t){var a=t.options;clearTimeout(t.changeUpdate),t.changeUpdate=setTimeout((function(){var a=e.getViewport();t.from==t.to||a.from-t.to>20||t.from-a.to>20?l(e):e.operation((function(){a.from<t.from&&(i(e,a.from,t.from),t.from=a.from),a.to>t.to&&(i(e,t.to,a.to),t.to=a.to)}))}),a.updateViewportTimeSpan||400)}}function f(e,t){var a=e.state.foldGutter;if(a){var r=t.line;r>=a.from&&r<a.to&&i(e,r,r+1)}}}))},d5e0:function(e,t,a){(function(e){e(a("56b3"))})((function(e){"use strict";var t={autoSelfClosers:{area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0,menuitem:!0},implicitlyClosed:{dd:!0,li:!0,optgroup:!0,option:!0,p:!0,rp:!0,rt:!0,tbody:!0,td:!0,tfoot:!0,th:!0,tr:!0},contextGrabbers:{dd:{dd:!0,dt:!0},dt:{dd:!0,dt:!0},li:{li:!0},option:{option:!0,optgroup:!0},optgroup:{optgroup:!0},p:{address:!0,article:!0,aside:!0,blockquote:!0,dir:!0,div:!0,dl:!0,fieldset:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,menu:!0,nav:!0,ol:!0,p:!0,pre:!0,section:!0,table:!0,ul:!0},rp:{rp:!0,rt:!0},rt:{rp:!0,rt:!0},tbody:{tbody:!0,tfoot:!0},td:{td:!0,th:!0},tfoot:{tbody:!0},th:{td:!0,th:!0},thead:{tbody:!0,tfoot:!0},tr:{tr:!0}},doNotIndent:{pre:!0},allowUnquoted:!0,allowMissing:!0,caseFold:!0},a={autoSelfClosers:{},implicitlyClosed:{},contextGrabbers:{},doNotIndent:{},allowUnquoted:!1,allowMissing:!1,allowMissingTagName:!1,caseFold:!1};e.defineMode("xml",(function(r,n){var o,i,s=r.indentUnit,l={},c=n.htmlMode?t:a;for(var p in c)l[p]=c[p];for(var p in n)l[p]=n[p];function u(e,t){function a(a){return t.tokenize=a,a(e,t)}var r,n=e.next();return"<"==n?e.eat("!")?e.eat("[")?e.match("CDATA[")?a(g("atom","]]>")):null:e.match("--")?a(g("comment","--\x3e")):e.match("DOCTYPE",!0,!0)?(e.eatWhile(/[\w\._\-]/),a(m(1))):null:e.eat("?")?(e.eatWhile(/[\w\._\-]/),t.tokenize=g("meta","?>"),"meta"):(o=e.eat("/")?"closeTag":"openTag",t.tokenize=d,"tag bracket"):"&"==n?(r=e.eat("#")?e.eat("x")?e.eatWhile(/[a-fA-F\d]/)&&e.eat(";"):e.eatWhile(/[\d]/)&&e.eat(";"):e.eatWhile(/[\w\.\-:]/)&&e.eat(";"),r?"atom":"error"):(e.eatWhile(/[^&<]/),null)}function d(e,t){var a=e.next();if(">"==a||"/"==a&&e.eat(">"))return t.tokenize=u,o=">"==a?"endTag":"selfcloseTag","tag bracket";if("="==a)return o="equals",null;if("<"==a){t.tokenize=u,t.state=y,t.tagName=t.tagStart=null;var r=t.tokenize(e,t);return r?r+" tag error":"tag error"}return/[\'\"]/.test(a)?(t.tokenize=f(a),t.stringStartCol=e.column(),t.tokenize(e,t)):(e.match(/^[^\s\u00a0=<>\"\']*[^\s\u00a0=<>\"\'\/]/),"word")}function f(e){var t=function(t,a){while(!t.eol())if(t.next()==e){a.tokenize=d;break}return"string"};return t.isInAttribute=!0,t}function g(e,t){return function(a,r){while(!a.eol()){if(a.match(t)){r.tokenize=u;break}a.next()}return e}}function m(e){return function(t,a){var r;while(null!=(r=t.next())){if("<"==r)return a.tokenize=m(e+1),a.tokenize(t,a);if(">"==r){if(1==e){a.tokenize=u;break}return a.tokenize=m(e-1),a.tokenize(t,a)}}return"meta"}}function h(e){return e&&e.toLowerCase()}function v(e,t,a){this.prev=e.context,this.tagName=t||"",this.indent=e.indented,this.startOfLine=a,(l.doNotIndent.hasOwnProperty(t)||e.context&&e.context.noIndent)&&(this.noIndent=!0)}function I(e){e.context&&(e.context=e.context.prev)}function b(e,t){var a;while(1){if(!e.context)return;if(a=e.context.tagName,!l.contextGrabbers.hasOwnProperty(h(a))||!l.contextGrabbers[h(a)].hasOwnProperty(h(t)))return;I(e)}}function y(e,t,a){return"openTag"==e?(a.tagStart=t.column(),w):"closeTag"==e?M:y}function w(e,t,a){return"word"==e?(a.tagName=t.current(),i="tag",k):l.allowMissingTagName&&"endTag"==e?(i="tag bracket",k(e,t,a)):(i="error",w)}function M(e,t,a){if("word"==e){var r=t.current();return a.context&&a.context.tagName!=r&&l.implicitlyClosed.hasOwnProperty(h(a.context.tagName))&&I(a),a.context&&a.context.tagName==r||!1===l.matchClosing?(i="tag",R):(i="tag error",x)}return l.allowMissingTagName&&"endTag"==e?(i="tag bracket",R(e,t,a)):(i="error",x)}function R(e,t,a){return"endTag"!=e?(i="error",R):(I(a),y)}function x(e,t,a){return i="error",R(e,t,a)}function k(e,t,a){if("word"==e)return i="attribute",A;if("endTag"==e||"selfcloseTag"==e){var r=a.tagName,n=a.tagStart;return a.tagName=a.tagStart=null,"selfcloseTag"==e||l.autoSelfClosers.hasOwnProperty(h(r))?b(a,r):(b(a,r),a.context=new v(a,r,n==a.indented)),y}return i="error",k}function A(e,t,a){return"equals"==e?z:(l.allowMissing||(i="error"),k(e,t,a))}function z(e,t,a){return"string"==e?D:"word"==e&&l.allowUnquoted?(i="string",k):(i="error",k(e,t,a))}function D(e,t,a){return"string"==e?D:k(e,t,a)}return u.isInText=!0,{startState:function(e){var t={tokenize:u,state:y,indented:e||0,tagName:null,tagStart:null,context:null};return null!=e&&(t.baseIndent=e),t},token:function(e,t){if(!t.tagName&&e.sol()&&(t.indented=e.indentation()),e.eatSpace())return null;o=null;var a=t.tokenize(e,t);return(a||o)&&"comment"!=a&&(i=null,t.state=t.state(o||a,e,t),i&&(a="error"==i?a+" error":i)),a},indent:function(t,a,r){var n=t.context;if(t.tokenize.isInAttribute)return t.tagStart==t.indented?t.stringStartCol+1:t.indented+s;if(n&&n.noIndent)return e.Pass;if(t.tokenize!=d&&t.tokenize!=u)return r?r.match(/^(\s*)/)[0].length:0;if(t.tagName)return!1!==l.multilineTagIndentPastTag?t.tagStart+t.tagName.length+2:t.tagStart+s*(l.multilineTagIndentFactor||1);if(l.alignCDATA&&/<!\[CDATA\[/.test(a))return 0;var o=a&&/^<(\/)?([\w_:\.-]*)/.exec(a);if(o&&o[1])while(n){if(n.tagName==o[2]){n=n.prev;break}if(!l.implicitlyClosed.hasOwnProperty(h(n.tagName)))break;n=n.prev}else if(o)while(n){var i=l.contextGrabbers[h(n.tagName)];if(!i||!i.hasOwnProperty(h(o[2])))break;n=n.prev}while(n&&n.prev&&!n.startOfLine)n=n.prev;return n?n.indent+s:t.baseIndent||0},electricInput:/<\/[\s\w:]+>$/,blockCommentStart:"\x3c!--",blockCommentEnd:"--\x3e",configuration:l.htmlMode?"html":"xml",helperType:l.htmlMode?"html":"xml",skipAttribute:function(e){e.state==z&&(e.state=k)},xmlCurrentTag:function(e){return e.tagName?{name:e.tagName,close:"closeTag"==e.type}:null},xmlCurrentContext:function(e){for(var t=[],a=e.context;a;a=a.prev)t.push(a.tagName);return t.reverse()}}})),e.defineMIME("text/xml","xml"),e.defineMIME("application/xml","xml"),e.mimeModes.hasOwnProperty("text/html")||e.defineMIME("text/html",{name:"xml",htmlMode:!0})}))}}]);
//# sourceMappingURL=chunk-86be0028.b2bc0fe0.js.map