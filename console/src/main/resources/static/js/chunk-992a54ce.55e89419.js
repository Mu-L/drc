(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-992a54ce","chunk-6304b0b8"],{"057f":function(t,e,r){var n=r("fc6a"),a=r("241c").f,i={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],s=function(t){try{return a(t)}catch(e){return o.slice()}};t.exports.f=function(t){return o&&"[object Window]"==i.call(t)?s(t):a(n(t))}},"159b":function(t,e,r){var n=r("da84"),a=r("fdbc"),i=r("17c2"),o=r("9112");for(var s in a){var c=n[s],l=c&&c.prototype;if(l&&l.forEach!==i)try{o(l,"forEach",i)}catch(u){l.forEach=i}}},"17c2":function(t,e,r){"use strict";var n=r("b727").forEach,a=r("a640"),i=r("ae40"),o=a("forEach"),s=i("forEach");t.exports=o&&s?[].forEach:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}},"1da1":function(t,e,r){"use strict";r.d(e,"a",(function(){return a}));r("d3b7"),r("e6cf");function n(t,e,r,n,a,i,o){try{var s=t[i](o),c=s.value}catch(l){return void r(l)}s.done?e(c):Promise.resolve(c).then(n,a)}function a(t){return function(){var e=this,r=arguments;return new Promise((function(a,i){var o=t.apply(e,r);function s(t){n(o,a,i,s,c,"next",t)}function c(t){n(o,a,i,s,c,"throw",t)}s(void 0)}))}}},2532:function(t,e,r){"use strict";var n=r("23e7"),a=r("5a34"),i=r("1d80"),o=r("ab13");n({target:"String",proto:!0,forced:!o("includes")},{includes:function(t){return!!~String(i(this)).indexOf(a(t),arguments.length>1?arguments[1]:void 0)}})},"25f0":function(t,e,r){"use strict";var n=r("6eeb"),a=r("825a"),i=r("d039"),o=r("ad6d"),s="toString",c=RegExp.prototype,l=c[s],u=i((function(){return"/a/b"!=l.call({source:"a",flags:"b"})})),d=l.name!=s;(u||d)&&n(RegExp.prototype,s,(function(){var t=a(this),e=String(t.source),r=t.flags,n=String(void 0===r&&t instanceof RegExp&&!("flags"in c)?o.call(t):r);return"/"+e+"/"+n}),{unsafe:!0})},"3ca3":function(t,e,r){"use strict";var n=r("6547").charAt,a=r("69f3"),i=r("7dd0"),o="String Iterator",s=a.set,c=a.getterFor(o);i(String,"String",(function(t){s(this,{type:o,string:String(t),index:0})}),(function(){var t,e=c(this),r=e.string,a=e.index;return a>=r.length?{value:void 0,done:!0}:(t=n(r,a),e.index+=t.length,{value:t,done:!1})}))},4160:function(t,e,r){"use strict";var n=r("23e7"),a=r("17c2");n({target:"Array",proto:!0,forced:[].forEach!=a},{forEach:a})},"44e7":function(t,e,r){var n=r("861d"),a=r("c6b6"),i=r("b622"),o=i("match");t.exports=function(t){var e;return n(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==a(t))}},"4fad":function(t,e,r){var n=r("23e7"),a=r("6f53").entries;n({target:"Object",stat:!0},{entries:function(t){return a(t)}})},"53ca":function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));r("a4d3"),r("e01a"),r("d28b"),r("e260"),r("d3b7"),r("3ca3"),r("ddb0");function n(t){return n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}},"5a34":function(t,e,r){var n=r("44e7");t.exports=function(t){if(n(t))throw TypeError("The method doesn't accept regular expressions");return t}},6547:function(t,e,r){var n=r("a691"),a=r("1d80"),i=function(t){return function(e,r){var i,o,s=String(a(e)),c=n(r),l=s.length;return c<0||c>=l?t?"":void 0:(i=s.charCodeAt(c),i<55296||i>56319||c+1===l||(o=s.charCodeAt(c+1))<56320||o>57343?t?s.charAt(c):i:t?s.slice(c,c+2):o-56320+(i-55296<<10)+65536)}};t.exports={codeAt:i(!1),charAt:i(!0)}},"6f53":function(t,e,r){var n=r("83ab"),a=r("df75"),i=r("fc6a"),o=r("d1e7").f,s=function(t){return function(e){var r,s=i(e),c=a(s),l=c.length,u=0,d=[];while(l>u)r=c[u++],n&&!o.call(s,r)||d.push(t?[r,s[r]]:s[r]);return d}};t.exports={entries:s(!0),values:s(!1)}},"746f":function(t,e,r){var n=r("428f"),a=r("5135"),i=r("e538"),o=r("9bf2").f;t.exports=function(t){var e=n.Symbol||(n.Symbol={});a(e,t)||o(e,t,{value:i.f(t)})}},"96cf":function(t,e,r){var n=function(t){"use strict";var e,r=Object.prototype,n=r.hasOwnProperty,a="function"===typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",o=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function c(t,e,r,n){var a=e&&e.prototype instanceof g?e:g,i=Object.create(a.prototype),o=new N(n||[]);return i._invoke=k(t,r,o),i}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(n){return{type:"throw",arg:n}}}t.wrap=c;var u="suspendedStart",d="suspendedYield",p="executing",f="completed",h={};function g(){}function m(){}function b(){}var v={};v[i]=function(){return this};var y=Object.getPrototypeOf,w=y&&y(y(A([])));w&&w!==r&&n.call(w,i)&&(v=w);var x=b.prototype=g.prototype=Object.create(v);function S(t){["next","throw","return"].forEach((function(e){t[e]=function(t){return this._invoke(e,t)}}))}function M(t){function e(r,a,i,o){var s=l(t[r],t,a);if("throw"!==s.type){var c=s.arg,u=c.value;return u&&"object"===typeof u&&n.call(u,"__await")?Promise.resolve(u.__await).then((function(t){e("next",t,i,o)}),(function(t){e("throw",t,i,o)})):Promise.resolve(u).then((function(t){c.value=t,i(c)}),(function(t){return e("throw",t,i,o)}))}o(s.arg)}var r;function a(t,n){function a(){return new Promise((function(r,a){e(t,n,r,a)}))}return r=r?r.then(a,a):a()}this._invoke=a}function k(t,e,r){var n=u;return function(a,i){if(n===p)throw new Error("Generator is already running");if(n===f){if("throw"===a)throw i;return O()}r.method=a,r.arg=i;while(1){var o=r.delegate;if(o){var s=I(o,r);if(s){if(s===h)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===u)throw n=f,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=p;var c=l(t,e,r);if("normal"===c.type){if(n=r.done?f:d,c.arg===h)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n=f,r.method="throw",r.arg=c.arg)}}}function I(t,r){var n=t.iterator[r.method];if(n===e){if(r.delegate=null,"throw"===r.method){if(t.iterator["return"]&&(r.method="return",r.arg=e,I(t,r),"throw"===r.method))return h;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var a=l(n,t.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,h;var i=a.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,h):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function D(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function N(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function A(t){if(t){var r=t[i];if(r)return r.call(t);if("function"===typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function r(){while(++a<t.length)if(n.call(t,a))return r.value=t[a],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}return{next:O}}function O(){return{value:e,done:!0}}return m.prototype=x.constructor=b,b.constructor=m,b[s]=m.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var e="function"===typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,s in t||(t[s]="GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},S(M.prototype),M.prototype[o]=function(){return this},t.AsyncIterator=M,t.async=function(e,r,n,a){var i=new M(c(e,r,n,a));return t.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},S(x),x[s]="Generator",x[i]=function(){return this},x.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){while(e.length){var n=e.pop();if(n in t)return r.value=n,r.done=!1,r}return r.done=!0,r}},t.values=A,N.prototype={constructor:N,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(D),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0],e=t.completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function a(n,a){return s.type="throw",s.arg=t,r.next=n,a&&(r.method="next",r.arg=e),!!a}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return a("end");if(o.tryLoc<=this.prev){var c=n.call(o,"catchLoc"),l=n.call(o,"finallyLoc");if(c&&l){if(this.prev<o.catchLoc)return a(o.catchLoc,!0);if(this.prev<o.finallyLoc)return a(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return a(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return a(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=e,i?(this.method="next",this.next=i.finallyLoc,h):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),D(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var a=n.arg;D(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:A(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),h}},t}(t.exports);try{regeneratorRuntime=n}catch(a){Function("r","regeneratorRuntime = r")(n)}},"9bf1":function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("base-component",[r("Breadcrumb",{style:{margin:"15px 0 15px 185px",position:"fixed"}},[r("BreadcrumbItem",{attrs:{to:{path:"/v2/mhaReplications",query:{srcMhaName:this.initInfo.srcMhaName,dstMhaName:this.initInfo.dstMhaName,preciseSearchMode:!0}}}},[t._v("首页 ")]),r("BreadcrumbItem",{attrs:{to:{path:"/drcV2",query:{step:3,srcMhaName:this.initInfo.srcMhaName,dstMhaName:this.initInfo.dstMhaName,srcDc:this.initInfo.srcDc,dstDc:this.initInfo.dstDc,order:this.initInfo.order}}}},[t._v("DRC配置V2 ")]),r("BreadcrumbItem",[t._v("同步表")])],1),r("Content",{staticClass:"content",style:{padding:"10px",background:"#fff",margin:"50px 0 1px 185px",zIndex:"1"}},[r("Row",[r("Col",{attrs:{span:"8"}},[r("span",{staticStyle:{"margin-top":"10px",color:"#464c5b","font-weight":"600"}},[t._v(t._s(t.initInfo.srcMhaName)+"("+t._s(t.initInfo.srcDc)+")==>"+t._s(t.initInfo.dstMhaName)+"("+t._s(t.initInfo.dstDc)+")")])]),r("Col",{attrs:{span:"2"}},[t.submitted?t._e():r("Button",{staticStyle:{"margin-top":"10px","text-align":"right"},attrs:{loading:t.dataLoading,type:"primary",ghost:""},on:{click:function(e){return t.preBatchUpdate()}}},[t._v("批量修改 ")])],1),r("Col",{attrs:{span:"4"}},[t.submitted?t._e():r("Button",{staticStyle:{"margin-top":"10px","text-align":"right"},attrs:{loading:t.dataLoading,type:"primary",ghost:""},on:{click:function(e){return t.fillMhaApplier()}}},[t._v("一键录入 mha applier ")])],1),r("Col",{attrs:{span:"4"}},[t.submitted?t._e():r("Button",{staticStyle:{"margin-top":"10px","text-align":"right"},attrs:{loading:t.dataLoading,type:"primary",ghost:""},on:{click:function(e){return t.preClearAndUpdateMhaGtid()}}},[t._v("一键回滚 ")])],1)],1),r("div",{style:{padding:"1px 1px",height:"100%"}},[[r("Table",{ref:"multipleTable",staticStyle:{"margin-top":"20px"},attrs:{stripe:"",columns:t.columns,data:t.tableData,loading:t.dataLoading,border:""},on:{"on-selection-change":t.changeSelection},scopedSlots:t._u([{key:"applier",fn:function(e){var n=e.row,a=e.index;return[r("Select",{staticStyle:{width:"250px"},attrs:{transfer:!0,multiple:"",placeholder:"选择源集群Applier"},model:{value:t.tableData[a].ips,callback:function(e){t.$set(t.tableData[a],"ips",e)},expression:"tableData[index].ips"}},t._l(t.applierResourceList,(function(e){return r("Option",{key:e.ip,attrs:{value:e.ip}},[t._v(t._s(e.ip)+" —— "+t._s(e.az)+" ")])})),1),r("Button",{staticStyle:{"margin-left":"10px"},attrs:{loading:t.applierDataLoading[a],type:"success",size:"small"},on:{click:function(e){return t.autoConfigApplier(n,a)}}},[t._v("自动录入 ")])]}},{key:"gtidInit",fn:function(e){e.row;var n=e.index;return[r("Input",{staticStyle:{width:"80%"},attrs:{border:!1,placeholder:"请输入binlog拉取位点"},model:{value:t.tableData[n].gtidInit,callback:function(e){t.$set(t.tableData[n],"gtidInit",e)},expression:"tableData[index].gtidInit"}})]}},{key:"concurrency",fn:function(e){e.row;var n=e.index;return[r("InputNumber",{staticStyle:{width:"90%"},attrs:{max:150,min:1,placeholder:""},model:{value:t.tableData[n].concurrency,callback:function(e){t.$set(t.tableData[n],"concurrency",e)},expression:"tableData[index].concurrency"}})]}}])}),t.submitted?t._e():r("Button",{staticStyle:{"margin-top":"10px","text-align":"right"},attrs:{loading:t.dataLoading,type:"primary"},on:{click:function(e){return t.preSubmit()}}},[t._v("提交 ")]),r("Modal",{attrs:{title:"请设置 Applier",width:"1200px"},on:{"on-ok":t.batchUpdateAppliers},model:{value:t.batchUpdateModal,callback:function(e){t.batchUpdateModal=e},expression:"batchUpdateModal"}},[r("div",{style:{padding:"1px 1px",height:"100%"}},[r("Form",{attrs:{"label-position":"left","label-width":100}},[r("FormItem",{attrs:{label:"Applier"}},[r("Select",{staticStyle:{width:"250px"},attrs:{transfer:!0,multiple:"",placeholder:"选择源集群Applier"},model:{value:t.target.ips,callback:function(e){t.$set(t.target,"ips",e)},expression:"target.ips"}},t._l(t.applierResourceList,(function(e){return r("Option",{key:e.ip,attrs:{value:e.ip}},[t._v(t._s(e.ip)+" —— "+t._s(e.az)+" ")])})),1)],1),r("FormItem",{attrs:{label:"初始同步位点"}},[r("Input",{staticStyle:{width:"80%"},attrs:{border:!1,placeholder:"请输入binlog拉取位点"},model:{value:t.target.gtid,callback:function(e){t.$set(t.target,"gtid",e)},expression:"target.gtid"}})],1)],1),r("p",[r("span",[t._v("共 ")]),r("span",{staticStyle:{color:"red","font-size":"16px","word-break":"break-all","word-wrap":"break-word"}},[t._v(t._s(this.updateData.length))]),r("span",[t._v(" 行数据")])]),[r("Table",{staticStyle:{"margin-top":"20px"},attrs:{stripe:"",columns:t.updateColumns,data:t.updateData,border:""}})]],2)]),r("Modal",{attrs:{title:"回滚至 MHA 同步",width:"1200px"},on:{"on-ok":t.clearAndUpdateMhaGtid},model:{value:t.rollbackModal,callback:function(e){t.rollbackModal=e},expression:"rollbackModal"}},[r("div",{style:{padding:"1px 1px",height:"100%"}},[r("p",[r("span",{staticStyle:{color:"red","font-size":"16px","word-break":"break-all","word-wrap":"break-word"}},[t._v("你正在进行回滚操作，将更新mha位点，并清空所有 db applier！")])]),r("Divider"),r("Form",{staticStyle:{width:"80%"}},[r("FormItem",{attrs:{label:"当前 DB 同步位点"}},[[r("Table",{staticStyle:{"margin-top":"20px"},attrs:{stripe:"",columns:t.dbGtidColumns,data:t.gtidCheck.dbApplied,border:""}})]],2),r("FormItem",{attrs:{label:"当前 Mha 同步位点"}},[r("Input",{attrs:{autosize:{minRows:1,maxRows:30},readonly:""},model:{value:t.gtidCheck.mhaApplied,callback:function(e){t.$set(t.gtidCheck,"mhaApplied",e)},expression:"gtidCheck.mhaApplied"}})],1),r("FormItem",{attrs:{label:"回滚后，Mha 初始同步位点将被设置为："}},[r("Input",{attrs:{type:"textarea",autosize:{minRows:1,maxRows:30},readonly:""},model:{value:t.gtidCheck.mhaTarget,callback:function(e){t.$set(t.gtidCheck,"mhaTarget",e)},expression:"gtidCheck.mhaTarget"}})],1)],1)],1)])]],2)],1)],1)},a=[];r("4160"),r("caad"),r("a15b"),r("d81d"),r("4fad"),r("d3b7"),r("2532"),r("3ca3"),r("159b"),r("ddb0");function i(t){if(Array.isArray(t))return t}r("a4d3"),r("e01a"),r("d28b"),r("e260"),r("25f0");function o(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var r=[],n=!0,a=!1,i=void 0;try{for(var o,s=t[Symbol.iterator]();!(n=(o=s.next()).done);n=!0)if(r.push(o.value),e&&r.length===e)break}catch(c){a=!0,i=c}finally{try{n||null==s["return"]||s["return"]()}finally{if(a)throw i}}return r}}function s(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function c(t,e){return i(t)||o(t,e)||s()}r("96cf");var l=r("1da1"),u=r("53ca"),d=r("2b0e"),p={name:"tables",data:function(){var t=this;return{initInfo:{srcMhaName:"",srcMhaId:0,dstMhaName:"",dbReplicationId:0,multiData:[],srcDc:"",dstDc:"",order:!0},dataLoading:!1,applierDataLoading:[],submitted:!1,applierResourceList:[],batchUpdateModal:!1,rollbackModal:!1,gtidCheck:{mhaApplied:"",dbApplied:[],mhaTarget:""},mhaApplierInitGtid:null,deleteData:[],filters:[],filterMap:{0:"行过滤",1:"字段过滤"},target:{gtid:"",ips:[]},columns:[{type:"selection",width:60,align:"center"},{title:"库名",key:"dbName",width:200},{title:"Applier",slot:"applier",width:400,renderHeader:function(e,r){return e("span",[e("span","Applier 配置 -- "),e("Button",{props:{type:"success",size:"small"},on:{click:function(){t.batchAutoConfigure()}}},"自动录入")])},filters:[{label:"空",value:null},{label:"非空",value:"not null"}],filterMultiple:!1,filterMethod:function(t,e){return t?e.ips&&e.ips.length>0:!e.ips||0===e.ips.length}},{title:"初始同步位点",slot:"gtidInit"},{title:"并发数",width:200,slot:"concurrency"}],updateColumns:[{title:"库名",key:"dbName",width:200},{title:"applier 配置",key:"applier",width:300,render:function(t,e){var r=e.row,n=r.ips;return null===n||0===n.length?t("Tag",{props:{color:"blue"}},"无"):t("span",r.ips.join(", "))}},{title:"初始同步位点",key:"gtidInit",render:function(t,e){var r=e.row,n=r.gtidInit;return null===n||0===n.length?t("Tag",{props:{color:"blue"}},"无"):t("span",n)}}],dbGtidColumns:[{title:"库名",key:"dbName",width:200},{title:"当前同步位点",key:"gtidInit",render:function(t,e){var r=e.row,n=r.gtidInit;return null===n||0===n.length?t("Tag",{props:{color:"blue"}},"无"):t("span",n)}}],updateData:[],propertiesJson:{},tableData:[],total:0,size:5,pageSizeOpts:[5,10,20,100]}},methods:{getFilterText:function(t){},changeSelection:function(t){this.initInfo.multiData=t,console.log(this.initInfo.multiData)},flattenObj:function(t){var e={};for(var r in t)if("object"!==Object(u["a"])(t[r])||Array.isArray(t[r]))e[r]=t[r];else{var n=this.flattenObj(t[r]);for(var a in n)e[r+"."+a]=n[a]}return e},getFilteredData:function(){return this.$refs.multipleTable.makeDataWithSortAndFilter()},autoConfigApplier:function(t,e){var r=this;d["default"].set(this.applierDataLoading,e,!0),this.axios.get("/api/drc/v2/resource/db/auto",{params:{dstMhaName:this.initInfo.dstMhaName,type:1,selectedIps:t.ips?t.ips.join(","):null}}).then((function(n){t.ips=[],n.data.data.forEach((function(e){return t.ips.push(e.ip)})),d["default"].set(r.tableData,e,t)})).catch((function(t){r.$Message.error("提交异常: "+t)})).finally((function(){r.applierDataLoading[e]=!1}))},preSubmit:function(){var t=this;this.$Modal.confirm({title:"提交确认",content:"您确定要提交么？",onOk:function(){t.submitDbAppliers()}})},submitDbAppliers:function(){var t=this,e={srcBuildParam:{mhaName:this.initInfo.srcMhaName,dbApplierDtos:[]},dstBuildParam:{mhaName:this.initInfo.dstMhaName,dbApplierDtos:this.getFilteredData(),applierInitGtid:this.gtidCheck.mhaTarget}};console.log(e),this.dataLoading=!0,this.axios.post("/api/drc/v2/config/db/applier",e).then(function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(r){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=r.data,a=1!==n.status,!a){e.next=9;break}return t.submitted=!0,t.$Message.success("提交成功"),e.next=7,t.getDbAppliers();case 7:e.next=10;break;case 9:t.$Message.warning("提交失败: "+n.message);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){t.$Message.error("提交异常: "+e)})).finally((function(){t.gtidCheck.mhaTarget=null,t.dataLoading=!1}))},batchAutoConfigure:function(){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.tableData.map((function(e,r){return t.autoConfigApplier(e,r)}));case 1:case"end":return e.stop()}}),e)})))()},getResources:function(){var t=this;this.axios.get("/api/drc/v2/resource/db/all",{params:{srcMhaName:this.initInfo.srcMhaName,dstMhaName:this.initInfo.dstMhaName,type:1}}).then((function(e){console.log(e.data),t.applierResourceList=e.data.data}))},getDbAppliers:function(){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.dataLoading=!0,t.axios.get("/api/drc/v2/config/mha/dbApplier",{params:{srcMhaName:t.initInfo.srcMhaName,dstMhaName:t.initInfo.dstMhaName}}).then((function(e){1===e.data.status?t.$Message.error("查询 db applier 失败!"):t.tableData=e.data.data})).finally((function(){t.dataLoading=!1}));case 2:case"end":return e.stop()}}),e)})))()},preBatchUpdate:function(){var t=this.$refs.multipleTable.getSelection();void 0!==t&&null!==t&&0!==t.length?(this.batchUpdateModal=!0,this.updateData=t,this.target.ips=[],this.target.gtid=""):this.$Message.warning("请勾选！")},fillMhaApplier:function(){var t=this;this.dataLoading=!0,Promise.all([this.axios.get("/api/drc/v2/config/mha/applier?srcMhaName="+this.initInfo.srcMhaName+"&dstMhaName="+this.initInfo.dstMhaName),this.axios.get("/api/drc/v2/config/mha/dbApplier/gtid?srcMhaName="+this.initInfo.srcMhaName+"&dstMhaName="+this.initInfo.dstMhaName)]).then(function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(r){var n,a,i,o,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=c(r,2),a=n[0],i=n[1],console.log("res1",a),console.log("res2",i),0===a.data.status&&0===i.data.status){e.next=6;break}return t.$Message.error("查询 mha applier 信息失败"),e.abrupt("return");case 6:o=a.data.data,s=i.data.data,t.tableData.forEach((function(t){t.ips=o,t.gtidInit=s}));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).finally((function(){t.dataLoading=!1}))},preClearAndUpdateMhaGtid:function(){var t=this;function e(t){for(var e=[],r=0,n=Object.entries(t);r<n.length;r++){var a=c(n[r],2),i=a[0],o=a[1];o&&o.length>0&&e.push({dbName:i,gtidInit:o})}return e}this.dataLoading=!0,Promise.all([this.axios.get("/api/drc/v2/mha/gtid/applied?mha="+this.initInfo.dstMhaName),this.axios.get("/api/drc/v2/mha/db/gtid/applied?mha="+this.initInfo.dstMhaName),this.axios.get("/api/drc/v2/config/mha/applier/dbGtid?srcMhaName="+this.initInfo.srcMhaName+"&dstMhaName="+this.initInfo.dstMhaName)]).then(function(){var r=Object(l["a"])(regeneratorRuntime.mark((function r(n){var a,i,o,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(a=c(n,3),i=a[0],o=a[1],s=a[2],console.log("res1",i),console.log("res2",o),console.log("res3",s),0===i.data.status&&0===o.data.status&&0===s.data.status){r.next=7;break}return t.$Message.error("查询 gtid 信息失败"),r.abrupt("return");case 7:t.gtidCheck.mhaApplied=i.data.data,t.gtidCheck.dbApplied=e(o.data.data),t.gtidCheck.mhaTarget=s.data.data,t.rollbackModal=!0;case 11:case"end":return r.stop()}}),r)})));return function(t){return r.apply(this,arguments)}}()).finally((function(){t.dataLoading=!1}))},clearAndUpdateMhaGtid:function(){var t=this;this.tableData.forEach((function(e){e.ips=t.target.ips,e.gtidInit=t.target.gtid})),this.mhaApplierInitGtid=this.gtidCheck.mhaTarget,this.gtidCheck.mhaTarget&&0!==this.gtidCheck.mhaTarget.length?this.submitDbAppliers():this.$Message.warning("回滚失败，target mha gtid 不存在")},batchUpdateAppliers:function(){var t=this,e=this.$refs.multipleTable.getSelection().map((function(t){return t.dbName}));this.tableData.forEach((function(r){e.includes(r.dbName)&&(r.ips=t.target.ips,r.gtidInit=t.target.gtid)})),this.$Message.warning("修改成功！共修改"+e.length+"行")},clearDeleteDbReplication:function(t,e){this.deleteData=[],this.batchDeleteModal=!1},deleteDbReplication:function(){var t=this,e=[];this.deleteData.forEach((function(t){return e.push(t.dbReplicationId)})),this.axios.delete("/api/drc/v2/config/dbReplications?dbReplicationIds="+e).then((function(e){1===e.data.status?t.$Message.error("删除失败!"+e.data.message):(t.$Message.success("删除成功!"),t.getDbAppliers(),t.initInfo.multiData=[])}))}},created:function(){var t=this;this.axios.get("/api/drc/v2/permission/meta/mhaReplication/modify").then((function(e){403!==e.data.status?(t.initInfo={srcMhaName:t.$route.query.srcMhaName,srcMhaId:t.$route.query.srcMhaId,dstMhaName:t.$route.query.dstMhaName,applierGroupId:t.$route.query.applierGroupId,srcDc:t.$route.query.srcDc,dstDc:t.$route.query.dstDc,order:t.$route.query.order},console.log("initInfo:"),console.log(t.initInfo),t.getResources(),t.getDbAppliers()):t.$router.push("/nopermission")}))}},f=p,h=r("2877"),g=Object(h["a"])(f,n,a,!1,null,"a3341b5a",null);e["default"]=g.exports},a15b:function(t,e,r){"use strict";var n=r("23e7"),a=r("44ad"),i=r("fc6a"),o=r("a640"),s=[].join,c=a!=Object,l=o("join",",");n({target:"Array",proto:!0,forced:c||!l},{join:function(t){return s.call(i(this),void 0===t?",":t)}})},a4d3:function(t,e,r){"use strict";var n=r("23e7"),a=r("da84"),i=r("d066"),o=r("c430"),s=r("83ab"),c=r("4930"),l=r("fdbf"),u=r("d039"),d=r("5135"),p=r("e8b5"),f=r("861d"),h=r("825a"),g=r("7b0b"),m=r("fc6a"),b=r("c04e"),v=r("5c6c"),y=r("7c73"),w=r("df75"),x=r("241c"),S=r("057f"),M=r("7418"),k=r("06cf"),I=r("9bf2"),L=r("d1e7"),D=r("9112"),N=r("6eeb"),A=r("5692"),O=r("f772"),E=r("d012"),_=r("90e3"),C=r("b622"),T=r("e538"),j=r("746f"),R=r("d44e"),$=r("69f3"),P=r("b727").forEach,G=O("hidden"),F="Symbol",B="prototype",U=C("toPrimitive"),z=$.set,q=$.getterFor(F),V=Object[B],H=a.Symbol,J=i("JSON","stringify"),W=k.f,Y=I.f,Q=S.f,K=L.f,X=A("symbols"),Z=A("op-symbols"),tt=A("string-to-symbol-registry"),et=A("symbol-to-string-registry"),rt=A("wks"),nt=a.QObject,at=!nt||!nt[B]||!nt[B].findChild,it=s&&u((function(){return 7!=y(Y({},"a",{get:function(){return Y(this,"a",{value:7}).a}})).a}))?function(t,e,r){var n=W(V,e);n&&delete V[e],Y(t,e,r),n&&t!==V&&Y(V,e,n)}:Y,ot=function(t,e){var r=X[t]=y(H[B]);return z(r,{type:F,tag:t,description:e}),s||(r.description=e),r},st=l?function(t){return"symbol"==typeof t}:function(t){return Object(t)instanceof H},ct=function(t,e,r){t===V&&ct(Z,e,r),h(t);var n=b(e,!0);return h(r),d(X,n)?(r.enumerable?(d(t,G)&&t[G][n]&&(t[G][n]=!1),r=y(r,{enumerable:v(0,!1)})):(d(t,G)||Y(t,G,v(1,{})),t[G][n]=!0),it(t,n,r)):Y(t,n,r)},lt=function(t,e){h(t);var r=m(e),n=w(r).concat(ht(r));return P(n,(function(e){s&&!dt.call(r,e)||ct(t,e,r[e])})),t},ut=function(t,e){return void 0===e?y(t):lt(y(t),e)},dt=function(t){var e=b(t,!0),r=K.call(this,e);return!(this===V&&d(X,e)&&!d(Z,e))&&(!(r||!d(this,e)||!d(X,e)||d(this,G)&&this[G][e])||r)},pt=function(t,e){var r=m(t),n=b(e,!0);if(r!==V||!d(X,n)||d(Z,n)){var a=W(r,n);return!a||!d(X,n)||d(r,G)&&r[G][n]||(a.enumerable=!0),a}},ft=function(t){var e=Q(m(t)),r=[];return P(e,(function(t){d(X,t)||d(E,t)||r.push(t)})),r},ht=function(t){var e=t===V,r=Q(e?Z:m(t)),n=[];return P(r,(function(t){!d(X,t)||e&&!d(V,t)||n.push(X[t])})),n};if(c||(H=function(){if(this instanceof H)throw TypeError("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,e=_(t),r=function(t){this===V&&r.call(Z,t),d(this,G)&&d(this[G],e)&&(this[G][e]=!1),it(this,e,v(1,t))};return s&&at&&it(V,e,{configurable:!0,set:r}),ot(e,t)},N(H[B],"toString",(function(){return q(this).tag})),N(H,"withoutSetter",(function(t){return ot(_(t),t)})),L.f=dt,I.f=ct,k.f=pt,x.f=S.f=ft,M.f=ht,T.f=function(t){return ot(C(t),t)},s&&(Y(H[B],"description",{configurable:!0,get:function(){return q(this).description}}),o||N(V,"propertyIsEnumerable",dt,{unsafe:!0}))),n({global:!0,wrap:!0,forced:!c,sham:!c},{Symbol:H}),P(w(rt),(function(t){j(t)})),n({target:F,stat:!0,forced:!c},{for:function(t){var e=String(t);if(d(tt,e))return tt[e];var r=H(e);return tt[e]=r,et[r]=e,r},keyFor:function(t){if(!st(t))throw TypeError(t+" is not a symbol");if(d(et,t))return et[t]},useSetter:function(){at=!0},useSimple:function(){at=!1}}),n({target:"Object",stat:!0,forced:!c,sham:!s},{create:ut,defineProperty:ct,defineProperties:lt,getOwnPropertyDescriptor:pt}),n({target:"Object",stat:!0,forced:!c},{getOwnPropertyNames:ft,getOwnPropertySymbols:ht}),n({target:"Object",stat:!0,forced:u((function(){M.f(1)}))},{getOwnPropertySymbols:function(t){return M.f(g(t))}}),J){var gt=!c||u((function(){var t=H();return"[null]"!=J([t])||"{}"!=J({a:t})||"{}"!=J(Object(t))}));n({target:"JSON",stat:!0,forced:gt},{stringify:function(t,e,r){var n,a=[t],i=1;while(arguments.length>i)a.push(arguments[i++]);if(n=e,(f(e)||void 0!==t)&&!st(t))return p(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!st(e))return e}),a[1]=e,J.apply(null,a)}})}H[B][U]||D(H[B],U,H[B].valueOf),R(H,F),E[G]=!0},a640:function(t,e,r){"use strict";var n=r("d039");t.exports=function(t,e){var r=[][t];return!!r&&n((function(){r.call(null,e||function(){throw 1},1)}))}},ab13:function(t,e,r){var n=r("b622"),a=n("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(r){try{return e[a]=!1,"/./"[t](e)}catch(n){}}return!1}},ad6d:function(t,e,r){"use strict";var n=r("825a");t.exports=function(){var t=n(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},d28b:function(t,e,r){var n=r("746f");n("iterator")},d81d:function(t,e,r){"use strict";var n=r("23e7"),a=r("b727").map,i=r("1dde"),o=r("ae40"),s=i("map"),c=o("map");n({target:"Array",proto:!0,forced:!s||!c},{map:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}})},ddb0:function(t,e,r){var n=r("da84"),a=r("fdbc"),i=r("e260"),o=r("9112"),s=r("b622"),c=s("iterator"),l=s("toStringTag"),u=i.values;for(var d in a){var p=n[d],f=p&&p.prototype;if(f){if(f[c]!==u)try{o(f,c,u)}catch(g){f[c]=u}if(f[l]||o(f,l,d),a[d])for(var h in i)if(f[h]!==i[h])try{o(f,h,i[h])}catch(g){f[h]=i[h]}}}},e01a:function(t,e,r){"use strict";var n=r("23e7"),a=r("83ab"),i=r("da84"),o=r("5135"),s=r("861d"),c=r("9bf2").f,l=r("e893"),u=i.Symbol;if(a&&"function"==typeof u&&(!("description"in u.prototype)||void 0!==u().description)){var d={},p=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),e=this instanceof p?new u(t):void 0===t?u():u(t);return""===t&&(d[e]=!0),e};l(p,u);var f=p.prototype=u.prototype;f.constructor=p;var h=f.toString,g="Symbol(test)"==String(u("test")),m=/^Symbol\((.*)\)[^)]+$/;c(f,"description",{configurable:!0,get:function(){var t=s(this)?this.valueOf():this,e=h.call(t);if(o(d,t))return"";var r=g?e.slice(7,-1):e.replace(m,"$1");return""===r?void 0:r}}),n({global:!0,forced:!0},{Symbol:p})}},e538:function(t,e,r){var n=r("b622");e.f=n},fdbc:function(t,e){t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}}}]);
//# sourceMappingURL=chunk-992a54ce.55e89419.js.map