package com.ctrip.framework.drc.monitor.function.cases.manager.suit;

import com.ctrip.framework.drc.core.monitor.cases.PairCase;
import com.ctrip.framework.drc.core.monitor.operator.ReadResource;
import com.ctrip.framework.drc.core.monitor.operator.ReadSqlOperator;
import com.ctrip.framework.drc.monitor.function.operator.ReadWriteSqlOperator;
import com.google.common.collect.Lists;

import java.util.List;

/**
 * Created by jixinwang on 2022/12/5
 */
public class CombinedPrimaryKeyPairCase extends AbstractMultiWriteInTransactionPairCase implements PairCase<ReadWriteSqlOperator, ReadSqlOperator<ReadResource>> {

    public static final String INSERT1 = "INSERT INTO `drc1`.`combined_primary_key` (`id`,`train_uid`,`train_no`,`carrier`,`reservation`,`calling_point_list`,`date`,`datachange_lasttime`,`cancel_flag`) VALUES (" +
            "17037603,'W44013','2A85','GW','N'," +
            "x'5B7B22637273436F6465223A2246524F222C2273746174696F6E4E616D65223A2246524F4D45222C226C6F636174696F6E223A2246524F4D45222C2273746174696F6E54797065223A224C4F222C226163746976697479223A225442222C2273746F7070696E675061747465726E223A224F524947494E222C22706C6174666F726D223A22222C227363686564756C656444657061727475726554696D65223A2232303A31363A3030222C227075626C696344657061727475726554696D65223A2232303A31363A3030222C226C696E65223A22222C2270617468223A22227D2C7B22637273436F6465223A22575342222C2273746174696F6E4E616D65223A225745535442555259222C226C6F636174696F6E223A22465257444A4E222C2273746174696F6E54797065223A224C49222C226163746976697479223A22222C2273746F7070696E675061747465726E223A2250415353494E47222C22706C6174666F726D223A22222C227363686564756C65645061737354696D65223A2232303A32323A3330222C226C696E65223A22222C2270617468223A22227D2C7B22637273436F6465223A22575342222C2273746174696F6E4E616D65223A225745535442555259222C226C6F636174696F6E223A2257535442525957222C2273746174696F6E54797065223A224C54222C226163746976697479223A225446222C2273746F7070696E675061747465726E223A2244455354494E4154494F4E222C22706C6174666F726D223A2233222C227363686564756C65644172726976616C54696D65223A2232303A32363A3030222C227075626C69634172726976616C54696D65223A2232303A32363A3030222C226C696E65223A22222C2270617468223A22227D5D'," +
            "'2022-12-01 00:00:00','2022-12-01 08:21:48.982',0);";

    public static final String INSERT2 = "INSERT INTO `drc1`.`combined_primary_key` (`id`,`train_uid`,`train_no`,`carrier`,`reservation`,`calling_point_list`,`date`,`datachange_lasttime`,`cancel_flag`) VALUES (" +
            "17037604,'W44014','2A85','GW','N'," +
            "x'5B7B22637273436F6465223A2246524F222C2273746174696F6E4E616D65223A2246524F4D45222C226C6F636174696F6E223A2246524F4D45222C2273746174696F6E54797065223A224C4F222C226163746976697479223A225442222C2273746F7070696E675061747465726E223A224F524947494E222C22706C6174666F726D223A22222C227363686564756C656444657061727475726554696D65223A2232303A31363A3030222C227075626C696344657061727475726554696D65223A2232303A31363A3030222C226C696E65223A22222C2270617468223A22227D2C7B22637273436F6465223A22575342222C2273746174696F6E4E616D65223A225745535442555259222C226C6F636174696F6E223A22465257444A4E222C2273746174696F6E54797065223A224C49222C226163746976697479223A22222C2273746F7070696E675061747465726E223A2250415353494E47222C22706C6174666F726D223A22222C227363686564756C65645061737354696D65223A2232303A32323A3330222C226C696E65223A22222C2270617468223A22227D2C7B22637273436F6465223A22575342222C2273746174696F6E4E616D65223A225745535442555259222C226C6F636174696F6E223A2257535442525957222C2273746174696F6E54797065223A224C54222C226163746976697479223A225446222C2273746F7070696E675061747465726E223A2244455354494E4154494F4E222C22706C6174666F726D223A2233222C227363686564756C65644172726976616C54696D65223A2232303A32363A3030222C227075626C69634172726976616C54696D65223A2232303A32363A3030222C226C696E65223A22222C2270617468223A22227D5D'," +
            "'2022-12-02 00:00:00','2022-12-01 08:21:48.982',0);";

    private static final List<String> INSERT_STATEMENTS = Lists.newArrayList(
            INSERT1,
            INSERT2
    );

    private static final List<String> UPDATE_STATEMENTS= Lists.newArrayList(
            "update `drc1`.`combined_primary_key` set `train_no`='2D482' where `id` = 17037603;",
            "update `drc1`.`combined_primary_key` set `train_no`='2D483' where `id` = 17037604;"
    );

    private static final List<String> DELETE_STATEMENTS = Lists.newArrayList(
            "delete from `drc1`.`combined_primary_key` where `id` = 17037603;",
            "delete from `drc1`.`combined_primary_key` where `id` = 17037604;"
    );

    private static final String SELECT_COMBINED_PRIMARY_KEY = "select * from `drc1`.`combined_primary_key` where `id` in(17037603, 17037604);";

    public CombinedPrimaryKeyPairCase() {
        initResource(INSERT_STATEMENTS, UPDATE_STATEMENTS, DELETE_STATEMENTS, SELECT_COMBINED_PRIMARY_KEY);
    }
}
